/*!
 * BootstrapWizard (http://bootstrapwizard.com)
 * Responsive wizard with expanding sub steps for Bootstrap 3
 *
 * @version     v0.1
 * @copyright   (c) 2014 Greg Wrey
 * @license     MIT
 */
(function(t){var i=function(i,s){this.$element=t(i),this.options=t.extend({},t.fn.bootstrapWizard.DEFAULTS,s),this.$prev=t([]),this.$current=t([]),this.$next=t([]),this.$nav=t('<nav class="navbar-default" role="navigation"><div class="wizard-nav-header visible-xs-block"><button type="button" class="navbar-toggle pull-left margin left" data-toggle="collapse" data-target=".wizard-nav"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><h3 class="wizard-nav-title"></h3></div><div class="wizard-nav collapse in"></div><div class="progress hidden-xs"><div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%"></div></div></nav>'),this.$body=t('<div class="wizard-body"><div class="wizard-content"></div><div class="wizard-footer"><div class="btn-toolbar"><div class="btn-group"><button class="btn btn-danger wizard-cancel" type="button">'+this.options.buttonText.cancel+"</button>"+"</div>"+'<button class="btn btn-success wizard-submit pull-right" type="button">'+this.options.buttonText.submit+"</button>"+'<button class="btn btn-primary wizard-next pull-right" type="button">'+this.options.buttonText.next+"</button>"+'<button class="btn btn-default wizard-back pull-right" type="button">'+this.options.buttonText.back+"</button>"+"</div>"+"</div>"+"</div>"),this._init()};i.prototype={constructor:i,_init:function(){var i=this.$element.children("ul.nav-wizard"),s=0;this.$element.append(this.$nav,this.$body).css({width:this.options.width?this.options.width+"px":"auto",height:this.options.height+"px"}),this.$nav.children(".wizard-nav").prepend(i);var e=this.$body.find(".wizard-footer"),n=e.find(".wizard-cancel");this.$backButton=e.find(".wizard-back").on("click",this.back),this.$nextButton=e.find(".wizard-next").on("click",this.next),this.$submitButton=e.find(".wizard-submit").on("click",this.submit),this.options.cancelButton&&n.show(),this.options.footerButtons||e.find(".btn-toolbar").hide(),this.options.progressBar?s=this.$nav.find(".progress").outerHeight():this.$nav.find(".progress").hide();var a=this.options.height-e.outerHeight()-30;this.$body.height(this.options.height-30+"px"),this.$body.find(".wizard-content").css({height:a+"px","overflow-y":"auto"}).append(this.$element.children(".wizard-pane").css("visibility","visible").hide()),i.find("li.active").has("ul").children("ul").addClass("collapse in"),i.find("li").not(".active").has("ul").children("ul").addClass("collapse"),i.find("li").has("ul").children("a").append('<span class="caret"></span>'),i.on("click.bw","li",function(i){i.preventDefault(),i.stopPropagation(),$li=t(this),$li.is(".visited")&&!$li.is(".disabled")&&$li.parents(".wizard").data("bootstrapWizard").show($li)}),t(window).on("resize.bw",function(){t(".wizard").data("bootstrapWizard")._resize()}),this.$element.css("visibility","visible").show(),this.show(i.find("li:first"))},back:function(){var i=t(this).parents(".wizard").data("bootstrapWizard");i.show(i.$prev)},next:function(){var i=t(this).parents(".wizard").data("bootstrapWizard");i.show(i.$next)},show:function(i){var s=this.$current,e=this.$body.find(this.$current.find("a").attr("href")),n=t.Event("show.bw",{relatedTarget:s,relatedPane:e});if(i.trigger(n),!n.isDefaultPrevented()&&(this.$current=i.addClass("visited active"),href=this.$current.find("a").attr("href"),this.$current.siblings().removeClass("active").children("ul.in").collapse("hide"),($parentNav=this.$current.parent("ul.collapse")).length&&$parentNav.collapse("show").parent("li").addClass("active").siblings().removeClass("active").children("ul.in").collapse("hide"),this.$prev=this.$current.prevAll(":not(.disabled):first"),this.$prev.length?($childNav=this.$prev.children("ul")).length&&($childNav.find("li.active").removeClass("active"),this.$prev=$childNav.children("li:not(.disabled):last")):(this.$prev=this.$current.parents("li.active"),""==this.$prev.find("a").attr("href")&&(this.$prev=this.$prev.prevAll(":not(.disabled):first"))),($childNav=this.$current.children("ul")).length?($childNav.collapse("show").find("li.active").removeClass("active"),this.$next=$childNav.children("li:not(.disabled):first"),""==href&&(this.$current=this.$next.addClass("visited active"),this.$next=this.$current.nextAll(":not(.disabled):first"),href=this.$current.find("a").attr("href"))):this.$next=this.$current.nextAll(":not(.disabled):first"),this.$next.length||(this.$next=this.$current.parents("li.active").nextAll(":not(.disabled):first")),this.$prev.length?this.$backButton.show():this.$backButton.hide(),this.$next.length?(this.$nextButton.show(),this.$submitButton.hide()):(this.$nextButton.hide(),this.$submitButton.show()),this.$body.find(".wizard-pane:visible").hide(),this.$body.find(href).show(),this.$nav.find(".wizard-nav-header").is(":visible"))){var a=this.$current.children("a").text();($parentNav=this.$current.parent("ul.collapse")).length&&(a=$parentNav.parent("li").children("a").text()+" > "+a),this.$nav.find("h3.wizard-nav-title").text(a),this.$nav.find(".wizard-nav").collapse("hide")}},_resize:function(){console.log(this),this.$nav.find(".wizard-nav-header").is(":visible")?(this.$element.css({width:"auto",height:"560px"}),this.$body.height(560-this.$nav.find(".wizard-nav-header").outerHeight()+"px"),this.$body.find(".wizard-content").height(this.$body.innerHeight()-this.$body.find(".wizard-footer").outerHeight()-30+"px"),this.$nav.find(".wizard-nav").collapse("hide")):this.$nav.find(".wizard-nav").collapse("show")},submit:function(){var i=t(this).parents(".wizard").data("bootstrapWizard"),s=i.$current,e=i.$body.find(i.$current.find("a").attr("href")),n=t.Event("show.bw",{relatedTarget:s,relatedPane:e});i.$current.trigger(n),n.isDefaultPrevented()||(n=t.Event("submit.bw",{}),t(this).trigger(n),n.isDefaultPrevented())},markAllVisited:function(){this.$nav.find("li").addClass("visited")},serialize:function(){return this.$body.find(".wizard-pane form").serialize()},progress:function(t){this.$nav.find(".progress-bar").attr("aria-valuenow",t).css("width",value+"%"),children("span").text(t+"%")}},t.fn.bootstrapWizard=function(s){return this.each(function(){var e=t(this),n=e.data("bootstrapWizard"),a="object"==typeof s&&s;n||(n=new i(this,a),e.data("bootstrapWizard",n)),"string"==typeof s&&n[s]()})},t.fn.bootstrapWizard.DEFAULTS={width:null,height:300,cancelButton:!1,footerButtons:!0,progressBar:!0,buttonText:{cancel:"Cancel",next:"Next",back:"Back",submit:"Submit"}},t.fn.bootstrapWizard.Constructor=i})(jQuery);