"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[342],{8342:(gt,A,d)=>{d.r(A),d.d(A,{RuleEngineModule:()=>ct});var u=d(6814),l=d(6223),g=d(9919),e=d(6689);let J=(()=>{class a{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-rule-engine"]],decls:11,vars:0,consts:function(){let n,o;return n="Stream",o="Rules",[[1,"card"],[1,"card-header"],[1,"nav","nav-tabs","card-header-tabs","font-weight-bold"],[1,"nav-item"],["routerLink","./stream-center","routerLinkActive","active",1,"nav-link"],n,["routerLink","./rules-center","routerLinkActive","active",1,"nav-link"],o,[1,"card-body"]]},template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ul",2)(3,"li",3)(4,"a",4),e.SDv(5,5),e.qZA()(),e.TgZ(6,"li",3)(7,"a",6),e.SDv(8,7),e.qZA()()()(),e.TgZ(9,"div",8),e._UZ(10,"router-outlet"),e.qZA()())},dependencies:[g.lC,g.rH,g.Od]})}return a})();var h=d(2303),C=d(3685),G=d(1421),w=d(165),X=d(7394);class Q extends X.w0{constructor(r,n){super()}schedule(r,n=0){return this}}const v={setInterval(a,r,...n){const{delegate:o}=v;return o?.setInterval?o.setInterval(a,r,...n):setInterval(a,r,...n)},clearInterval(a){const{delegate:r}=v;return(r?.clearInterval||clearInterval)(a)},delegate:void 0};var K=d(9039);const R={now:()=>(R.delegate||Date).now(),delegate:void 0};class M{constructor(r,n=M.now){this.schedulerActionCtor=r,this.now=n}schedule(r,n=0,o){return new this.schedulerActionCtor(this,r).schedule(o,n)}}M.now=R.now;const B=new class V extends M{constructor(r,n=M.now){super(r,n),this.actions=[],this._active=!1}flush(r){const{actions:n}=this;if(this._active)return void n.push(r);let o;this._active=!0;do{if(o=r.execute(r.state,r.delay))break}while(r=n.shift());if(this._active=!1,o){for(;r=n.shift();)r.unsubscribe();throw o}}}(class F extends Q{constructor(r,n){super(r,n),this.scheduler=r,this.work=n,this.pending=!1}schedule(r,n=0){var o;if(this.closed)return this;this.state=r;const t=this.id,i=this.scheduler;return null!=t&&(this.id=this.recycleAsyncId(i,t,n)),this.pending=!0,this.delay=n,this.id=null!==(o=this.id)&&void 0!==o?o:this.requestAsyncId(i,this.id,n),this}requestAsyncId(r,n,o=0){return v.setInterval(r.flush.bind(r,this),o)}recycleAsyncId(r,n,o=0){if(null!=o&&this.delay===o&&!1===this.pending)return n;null!=n&&v.clearInterval(n)}execute(r,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const o=this._execute(r,n);if(o)return o;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(r,n){let t,o=!1;try{this.work(r)}catch(i){o=!0,t=i||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),t}unsubscribe(){if(!this.closed){const{id:r,scheduler:n}=this,{actions:o}=n;this.work=this.state=this.scheduler=null,this.pending=!1,(0,K.P)(o,this),null!=r&&(this.id=this.recycleAsyncId(n,r,null)),this.delay=null,super.unsubscribe()}}});var Y=d(9360),z=d(8251);function b(a,r=B){return(0,Y.e)((n,o)=>{let t=null,i=null,s=null;const _=()=>{if(t){t.unsubscribe(),t=null;const p=i;i=null,o.next(p)}};function f(){const p=s+a,c=r.now();if(c<p)return t=this.schedule(void 0,p-c),void o.add(t);_()}n.subscribe((0,z.x)(o,p=>{i=p,s=r.now(),t||(t=r.schedule(f,a),o.add(t))},()=>{_(),o.complete()},void 0,()=>{i=t=null}))})}var Z=d(3997);function H(a,r){1&a&&e._UZ(0,"i",32)}function j(a,r){1&a&&e._UZ(0,"i",33)}let N=(()=>{class a{constructor(){this.collapseToggleStatus=!1,this.sinkBasePropertiesForm=new l.nJ({concurrency:new l.p4(1),bufferLength:new l.p4(1024),runAsync:new l.p4(!1),retryInterval:new l.p4(1e3),retryCount:new l.p4(0),cacheLength:new l.p4(1024),cacheSaveInterval:new l.p4(1e3),omitIfEmpty:new l.p4(!1)}),this.sinkBasePropertiesChange=new e.vpe,this.sinkBaseProperties={}}ngOnChanges(){delete this.sinkBaseProperties.sendSingle,delete this.sinkBaseProperties.dataTemplate;let n={};for(const[o,t]of Object.entries(this.sinkBaseProperties))this.sinkBasePropertiesForm.value.hasOwnProperty(o)&&t&&(n[o]=t);this.sinkBasePropertiesForm.patchValue(n)}ngAfterViewInit(){this.sinkBasePropertiesForm.valueChanges.pipe(b(400),(0,Z.x)()).subscribe(()=>{Object.assign(this.sinkBaseProperties,this.sinkBasePropertiesForm.value),this.sinkBasePropertiesChange.emit(this.sinkBaseProperties)})}collapseToggle(){this.collapseToggleStatus=!this.collapseToggleStatus}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-sink-base-properties"]],inputs:{sinkBaseProperties:"sinkBaseProperties"},outputs:{sinkBasePropertiesChange:"sinkBasePropertiesChange"},features:[e.TTD],decls:74,vars:7,consts:function(){let n;return n="Sink Advanced Options",[[1,"card"],["role","button","data-toggle","collapse","data-target","#collapse-sink-base","aria-expanded","false","aria-controls","collapse-sink-base",1,"card-header",3,"click"],[1,"fa","fa-tags","text-primary","mr-2"],[1,"text-primary"],n,[1,"text-primary","ml-2"],["role","button","aria-disabled","true","class","fa fa-angle-double-down fa-lg","data-toggle","collapse","data-target","#collapse-sink-base","aria-expanded","false","aria-controls","collapse-sink-base",4,"ngIf"],["role","button","aria-disabled","true","class","fa fa-angle-double-up fa-lg","data-toggle","collapse","data-target","#collapse-sink-base","aria-expanded","false","aria-controls","collapse-sink-base",4,"ngIf"],["id","collapse-sink-base",1,"card-body","collapse"],[3,"formGroup"],[1,"form-group","row"],[1,"col","col-sm-3","col-form-label","text-nowrap","text-truncate"],[1,"mr-2"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify how many instances of the sink will be run. If the value is bigger than 1, the order of the messages may not be retained.",1,"fa","fa-question-circle-o","fa-lg"],[1,"col-sm-9"],["type","number","name","concurrency","formControlName","concurrency",1,"form-control"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify how many messages can be buffered in memory. If the buffered messages exceed the limit, the sink will block message receiving until the buffered messages have been sent out so that the buffered size is less than the limit.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","bufferLength","formControlName","bufferLength",1,"form-control"],[1,"col-sm-3","col-form-label","text-nowrap","text-truncate"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify how many milliseconds will the sink retry to send data out if the previous send failed. If the specified value <= 0, then it will not retry.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","retryInterval","formControlName","retryInterval",1,"form-control"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify how many will the sink retry to send data out if the previous send failed. If the specified value <= 0, then it will not retry.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","retryCount","formControlName","retryCount",1,"form-control"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify how many messages can be cached. The cached messages will be resent to external system until the data sent out successfully. The cached message will be sent in order except in runAsync or concurrent mode. The cached message will be saved to disk in fixed intervals.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","cacheLength","formControlName","cacheLength",1,"form-control"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify the interval to save cached message to the disk. Notice that, if the rule is closed in plan, all the cached messages will be saved at close. A larger value can reduce the saving overhead but may lose more cache messages when the system is interrupted in error.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","cacheSaveInterval","formControlName","cacheSaveInterval",1,"form-control"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Whether the sink will run asynchronously for better performance. If it is true, the sink result order is not promised.",1,"fa","fa-question-circle-o","fa-lg"],["name","runAsync","formControlName","runAsync",1,"custom-select"],[3,"ngValue"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","If the configuration item is set to true, when SELECT result is empty, then the result will not feed to sink operator.",1,"fa","fa-question-circle-o","fa-lg"],["name","omitIfEmpty","formControlName","omitIfEmpty",1,"custom-select"],["role","button","aria-disabled","true","data-toggle","collapse","data-target","#collapse-sink-base","aria-expanded","false","aria-controls","collapse-sink-base",1,"fa","fa-angle-double-down","fa-lg"],["role","button","aria-disabled","true","data-toggle","collapse","data-target","#collapse-sink-base","aria-expanded","false","aria-controls","collapse-sink-base",1,"fa","fa-angle-double-up","fa-lg"]]},template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return t.collapseToggle()}),e._UZ(2,"i",2),e.TgZ(3,"span",3),e.SDv(4,4),e.qZA(),e.TgZ(5,"span",5),e.YNc(6,H,1,0,"i",6),e.YNc(7,j,1,0,"i",7),e.qZA()(),e.TgZ(8,"div",8)(9,"form",9)(10,"div",10)(11,"label",11)(12,"span",12),e._uU(13,"concurrency"),e.qZA(),e._UZ(14,"span",13),e.qZA(),e.TgZ(15,"div",14),e._UZ(16,"input",15),e.qZA()(),e.TgZ(17,"div",10)(18,"label",11)(19,"span",12),e._uU(20,"bufferLength"),e.qZA(),e._UZ(21,"span",16),e.qZA(),e.TgZ(22,"div",14),e._UZ(23,"input",17),e.qZA()(),e.TgZ(24,"div",10)(25,"label",18)(26,"span",12),e._uU(27,"retryInterval"),e.qZA(),e._UZ(28,"span",19),e.qZA(),e.TgZ(29,"div",14),e._UZ(30,"input",20),e.qZA()(),e.TgZ(31,"div",10)(32,"label",18)(33,"span",12),e._uU(34,"retryCount"),e.qZA(),e._UZ(35,"span",21),e.qZA(),e.TgZ(36,"div",14),e._UZ(37,"input",22),e.qZA()(),e.TgZ(38,"div",10)(39,"label",18)(40,"span",12),e._uU(41,"cacheLength"),e.qZA(),e._UZ(42,"span",23),e.qZA(),e.TgZ(43,"div",14),e._UZ(44,"input",24),e.qZA()(),e.TgZ(45,"div",10)(46,"label",18)(47,"span",12),e._uU(48,"cacheSaveInterval"),e.qZA(),e._UZ(49,"span",25),e.qZA(),e.TgZ(50,"div",14),e._UZ(51,"input",26),e.qZA()(),e.TgZ(52,"div",10)(53,"label",18)(54,"span",12),e._uU(55,"runAsync"),e.qZA(),e._UZ(56,"span",27),e.qZA(),e.TgZ(57,"div",14)(58,"select",28)(59,"option",29),e._uU(60,"false"),e.qZA(),e.TgZ(61,"option",29),e._uU(62,"true"),e.qZA()()()(),e.TgZ(63,"div",10)(64,"label",18)(65,"span",12),e._uU(66,"omitIfEmpty"),e.qZA(),e._UZ(67,"span",30),e.qZA(),e.TgZ(68,"div",14)(69,"select",31)(70,"option",29),e._uU(71,"false"),e.qZA(),e.TgZ(72,"option",29),e._uU(73,"true"),e.qZA()()()()()()()),2&o&&(e.xp6(6),e.Q6J("ngIf",!t.collapseToggleStatus),e.xp6(1),e.Q6J("ngIf",t.collapseToggleStatus),e.xp6(2),e.Q6J("formGroup",t.sinkBasePropertiesForm),e.xp6(50),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0),e.xp6(9),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0))},dependencies:[u.O5,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.sg,l.u]})}return a})();function W(a,r){1&a&&e._UZ(0,"i",26)}function ee(a,r){1&a&&e._UZ(0,"i",27)}let te=(()=>{class a{get optional(){return this._optional}set optional(n){Object.assign(this._optional,n)}constructor(){this.collapseToggleStatus=!1,this.optionalChange=new e.vpe,this._optional={Qos:"0",Retained:"false",SkipCertVerify:"true",AutoReconnect:"true",CleanSession:"true"}}ngOnInit(){}ngOnChanges(){this.optionalChange.emit(this.optional)}collapseToggle(){this.collapseToggleStatus=!this.collapseToggleStatus}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-edgex-sink-optional"]],inputs:{optional:"optional"},outputs:{optionalChange:"optionalChange"},features:[e.TTD],decls:102,vars:27,consts:[[1,"card"],["role","button","data-toggle","collapse","data-target","#collapse-edgex-sink-opts","aria-expanded","false","aria-controls","collapse-edgex-sink-opts",1,"card-header",3,"click"],[1,"fa","fa-tags","text-primary","mr-2"],[1,"text-primary"],[1,"text-primary","ml-2"],["role","button","aria-disabled","true","class","fa fa-angle-double-down fa-lg","data-toggle","collapse","data-target","#collapse-edgex-sink-opts","aria-expanded","false","aria-controls","collapse-edgex-sink-opts",4,"ngIf"],["role","button","aria-disabled","true","class","fa fa-angle-double-up fa-lg","data-toggle","collapse","data-target","#collapse-edgex-sink-opts","aria-expanded","false","aria-controls","collapse-edgex-sink-opts",4,"ngIf"],["id","collapse-edgex-sink-opts",1,"card-body","collapse"],[1,"form-group","row"],[1,"col-sm-3","col-form-label","text-nowrap","text-truncate"],[1,"col-sm-9"],["type","text","name","ClientId",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","Username",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","Password",1,"form-control",3,"ngModel","ngModelChange"],["name","Qos",1,"custom-select",3,"ngModel","ngModelChange"],[3,"value"],["type","number","name","KeepAlive",1,"form-control",3,"ngModel","ngModelChange"],["name","Retained",1,"custom-select",3,"ngModel","ngModelChange"],["name","AutoReconnect",1,"custom-select",3,"ngModel","ngModelChange"],["type","text","name","ConnectTimeout",1,"form-control",3,"ngModel","ngModelChange"],["name","CleanSession",1,"custom-select",3,"ngModel","ngModelChange"],["name","SkipCertVerify",1,"custom-select",3,"ngModel","ngModelChange"],["type","text","name","CertFile",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","KeyFile",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","CertPEMBlock",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","KeyPEMBlock",1,"form-control",3,"ngModel","ngModelChange"],["role","button","aria-disabled","true","data-toggle","collapse","data-target","#collapse-edgex-sink-opts","aria-expanded","false","aria-controls","collapse-edgex-sink-opts",1,"fa","fa-angle-double-down","fa-lg"],["role","button","aria-disabled","true","data-toggle","collapse","data-target","#collapse-edgex-sink-opts","aria-expanded","false","aria-controls","collapse-edgex-sink-opts",1,"fa","fa-angle-double-up","fa-lg"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return t.collapseToggle()}),e._UZ(2,"i",2),e.TgZ(3,"span",3),e._uU(4,"EdgeX Sink Options Setting"),e.qZA(),e.TgZ(5,"span",4),e.YNc(6,W,1,0,"i",5),e.YNc(7,ee,1,0,"i",6),e.qZA()(),e.TgZ(8,"div",7)(9,"form")(10,"div",8)(11,"label",9),e._uU(12,"ClientId"),e.qZA(),e.TgZ(13,"div",10)(14,"input",11),e.NdJ("ngModelChange",function(s){return t.optional.ClientId=s}),e.qZA()()(),e.TgZ(15,"div",8)(16,"label",9),e._uU(17,"Username"),e.qZA(),e.TgZ(18,"div",10)(19,"input",12),e.NdJ("ngModelChange",function(s){return t.optional.Username=s}),e.qZA()()(),e.TgZ(20,"div",8)(21,"label",9),e._uU(22,"Password"),e.qZA(),e.TgZ(23,"div",10)(24,"input",13),e.NdJ("ngModelChange",function(s){return t.optional.Password=s}),e.qZA()()(),e.TgZ(25,"div",8)(26,"label",9),e._uU(27,"Qos"),e.qZA(),e.TgZ(28,"div",10)(29,"select",14),e.NdJ("ngModelChange",function(s){return t.optional.Qos=s}),e.TgZ(30,"option",15),e._uU(31,"0"),e.qZA(),e.TgZ(32,"option",15),e._uU(33,"1"),e.qZA(),e.TgZ(34,"option",15),e._uU(35,"2"),e.qZA()()()(),e.TgZ(36,"div",8)(37,"label",9),e._uU(38,"KeepAlive"),e.qZA(),e.TgZ(39,"div",10)(40,"input",16),e.NdJ("ngModelChange",function(s){return t.optional.KeepAlive=s}),e.qZA()()(),e.TgZ(41,"div",8)(42,"label",9),e._uU(43,"Retained"),e.qZA(),e.TgZ(44,"div",10)(45,"select",17),e.NdJ("ngModelChange",function(s){return t.optional.Retained=s}),e.TgZ(46,"option",15),e._uU(47,"false"),e.qZA(),e.TgZ(48,"option",15),e._uU(49,"true"),e.qZA()()()(),e.TgZ(50,"div",8)(51,"label",9),e._uU(52,"AutoReconnect"),e.qZA(),e.TgZ(53,"div",10)(54,"select",18),e.NdJ("ngModelChange",function(s){return t.optional.AutoReconnect=s}),e.TgZ(55,"option",15),e._uU(56,"false"),e.qZA(),e.TgZ(57,"option",15),e._uU(58,"true"),e.qZA()()()(),e.TgZ(59,"div",8)(60,"label",9),e._uU(61,"ConnectTimeout"),e.qZA(),e.TgZ(62,"div",10)(63,"input",19),e.NdJ("ngModelChange",function(s){return t.optional.ConnectTimeout=s}),e.qZA()()(),e.TgZ(64,"div",8)(65,"label",9),e._uU(66,"CleanSession"),e.qZA(),e.TgZ(67,"div",10)(68,"select",20),e.NdJ("ngModelChange",function(s){return t.optional.CleanSession=s}),e.TgZ(69,"option",15),e._uU(70,"false"),e.qZA(),e.TgZ(71,"option",15),e._uU(72,"true"),e.qZA()()()(),e.TgZ(73,"div",8)(74,"label",9),e._uU(75,"SkipCertVerify"),e.qZA(),e.TgZ(76,"div",10)(77,"select",21),e.NdJ("ngModelChange",function(s){return t.optional.SkipCertVerify=s}),e.TgZ(78,"option",15),e._uU(79,"true"),e.qZA(),e.TgZ(80,"option",15),e._uU(81,"false"),e.qZA()()()(),e.TgZ(82,"div",8)(83,"label",9),e._uU(84,"CertFile"),e.qZA(),e.TgZ(85,"div",10)(86,"input",22),e.NdJ("ngModelChange",function(s){return t.optional.CertFile=s}),e.qZA()()(),e.TgZ(87,"div",8)(88,"label",9),e._uU(89,"KeyFile"),e.qZA(),e.TgZ(90,"div",10)(91,"input",23),e.NdJ("ngModelChange",function(s){return t.optional.KeyFile=s}),e.qZA()()(),e.TgZ(92,"div",8)(93,"label",9),e._uU(94,"CertPEMBlock"),e.qZA(),e.TgZ(95,"div",10)(96,"input",24),e.NdJ("ngModelChange",function(s){return t.optional.CertPEMBlock=s}),e.qZA()()(),e.TgZ(97,"div",8)(98,"label",9),e._uU(99,"KeyPEMBlock"),e.qZA(),e.TgZ(100,"div",10)(101,"input",25),e.NdJ("ngModelChange",function(s){return t.optional.KeyPEMBlock=s}),e.qZA()()()()()()),2&o&&(e.xp6(6),e.Q6J("ngIf",!t.collapseToggleStatus),e.xp6(1),e.Q6J("ngIf",t.collapseToggleStatus),e.xp6(7),e.Q6J("ngModel",t.optional.ClientId),e.xp6(5),e.Q6J("ngModel",t.optional.Username),e.xp6(5),e.Q6J("ngModel",t.optional.Password),e.xp6(5),e.Q6J("ngModel",t.optional.Qos),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Q6J("value",1),e.xp6(2),e.Q6J("value",2),e.xp6(6),e.Q6J("ngModel",t.optional.KeepAlive),e.xp6(5),e.Q6J("ngModel",t.optional.Retained),e.xp6(1),e.Q6J("value",!1),e.xp6(2),e.Q6J("value",!0),e.xp6(6),e.Q6J("ngModel",t.optional.AutoReconnect),e.xp6(1),e.Q6J("value",!1),e.xp6(2),e.Q6J("value",!0),e.xp6(6),e.Q6J("ngModel",t.optional.ConnectTimeout),e.xp6(5),e.Q6J("ngModel",t.optional.CleanSession),e.xp6(1),e.Q6J("value",!1),e.xp6(2),e.Q6J("value",!0),e.xp6(6),e.Q6J("ngModel",t.optional.SkipCertVerify),e.xp6(1),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1),e.xp6(6),e.Q6J("ngModel",t.optional.CertFile),e.xp6(5),e.Q6J("ngModel",t.optional.KeyFile),e.xp6(5),e.Q6J("ngModel",t.optional.CertPEMBlock),e.xp6(5),e.Q6J("ngModel",t.optional.KeyPEMBlock))},dependencies:[u.O5,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.On,l.F]})}return a})(),ne=(()=>{class a{get edgeXSink(){return this._edgeXSink}set edgeXSink(n){Object.assign(this._edgeXSink,n)}constructor(){this.sinkBaseProperties={},this.edgeXSinkChange=new e.vpe,this._edgeXSink={type:"redis",protocol:"redis",host:"edgex-redis",port:6379,contentType:"application/json",messageType:"event",sendSingle:!1}}ngOnInit(){this.renderPopoverComponent(),Object.assign(this.sinkBaseProperties,this.edgeXSink)}ngOnChanges(){this.edgeXSinkChange.emit(this.edgeXSink)}renderPopoverComponent(){$('[data-toggle="popover"]').popover({trigger:"hover"})}onSinkBasePropertiesChange(n){Object.assign(this.edgeXSink,n)}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-edgex-sink"]],inputs:{edgeXSink:"edgeXSink"},outputs:{edgeXSinkChange:"edgeXSinkChange"},features:[e.TTD],decls:117,vars:20,consts:[[1,"card"],[1,"card-header"],[1,"fa","fa-tags","text-danger","mr-2"],[1,"font-weight-bold"],[1,"card-body"],[1,"form-group","row"],[1,"col-sm-3","col-form-label","text-nowrap","text-truncate"],[1,"mr-2"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","the type of EdgeX message bus",1,"fa","fa-question-circle-o","fa-lg"],[1,"col-sm-9"],["name","type",1,"custom-select",3,"ngModel","ngModelChange"],["value","redis"],["value","zero"],["value","mqtt"],["type","text","name","protocol",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","host",1,"form-control",3,"ngModel","ngModelChange"],["type","number","name","port",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","The topic to be published. The topic is static across all messages. To use dynamic topic, leave this empty and specify the topicPrefix property. Only one of the topic and topicPrefix properties can be specified. If both are not specified, then use default topic value application.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","topic",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","The prefix of a dynamic topic to be published. The topic will become a concatenation of $topicPrefix/$profileName/$deviceName/$sourceName.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","topicPrefix",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","contentType",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","The EdgeX message model type. To publish the message as an event like EdgeX application service, use event. Otherwise, to publish the message as an event request like EdgeX device service or core data service, use request. If not specified, then use the default value event.",1,"fa","fa-question-circle-o","fa-lg"],["name","messageType",1,"custom-select",3,"ngModel","ngModelChange"],["value","event"],["value","request"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","The property is a field name that allows user to specify a field name of SQL select clause, the field name should use meta(*) AS xxx to select all of EdgeX metadata from message.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","metadata",1,"form-control",3,"ngModel","ngModelChange"],[3,"singleSelectionMode","singleProfileSelected","singleProfileSelectedChange"],[3,"singleSelectionMode","singleDeviceSelected","singleDeviceSelectedChange"],["type","text","name","deviceName",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content",'The output messages are received as an array. This is indicate whether to send the results one by one. If false, the output message will be {"result":"${the string of received message}"}. For example, {"result":"[{\\"count\\":30},"\\"count\\":20}]"}. Otherwise, the result message will be sent one by one with the actual field name. For the same example as above, it will send {"count":30}, then send {"count":20} to the RESTful endpoint.Default to false.',1,"fa","fa-question-circle-o","fa-lg"],["name","sendSingle",1,"custom-select",3,"ngModel","ngModelChange"],[3,"ngValue"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","The golang template format string to specify the output data format. The input of the template is the sink message which is always an array of map. If no data template is specified, the raw input will be the data.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","dataTemplate",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","EdgeX Message bus connection optional",1,"fa","fa-question-circle-o","fa-lg"],[3,"optional","optionalChange"],[3,"sinkBaseProperties","sinkBasePropertiesChange"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span",3),e._uU(4,"EdgeX Sink"),e.qZA()(),e.TgZ(5,"div",4)(6,"form")(7,"div",5)(8,"label",6)(9,"span",7),e._uU(10,"Type"),e.qZA(),e._UZ(11,"span",8),e.qZA(),e.TgZ(12,"div",9)(13,"select",10),e.NdJ("ngModelChange",function(s){return t.edgeXSink.type=s}),e.TgZ(14,"option",11),e._uU(15,"redis"),e.qZA(),e.TgZ(16,"option",12),e._uU(17,"zero"),e.qZA(),e.TgZ(18,"option",13),e._uU(19,"mqtt"),e.qZA()()()(),e.TgZ(20,"div",5)(21,"label",6),e._uU(22,"Protocol"),e.qZA(),e.TgZ(23,"div",9)(24,"input",14),e.NdJ("ngModelChange",function(s){return t.edgeXSink.protocol=s}),e.qZA()()(),e.TgZ(25,"div",5)(26,"label",6),e._uU(27,"Host"),e.qZA(),e.TgZ(28,"div",9)(29,"input",15),e.NdJ("ngModelChange",function(s){return t.edgeXSink.host=s}),e.qZA()()(),e.TgZ(30,"div",5)(31,"label",6),e._uU(32,"Port"),e.qZA(),e.TgZ(33,"div",9)(34,"input",16),e.NdJ("ngModelChange",function(s){return t.edgeXSink.port=s}),e.qZA()()(),e.TgZ(35,"div",5)(36,"label",6)(37,"span",7),e._uU(38,"Topic"),e.qZA(),e._UZ(39,"span",17),e.qZA(),e.TgZ(40,"div",9)(41,"input",18),e.NdJ("ngModelChange",function(s){return t.edgeXSink.topic=s}),e.qZA()()(),e.TgZ(42,"div",5)(43,"label",6)(44,"span",7),e._uU(45,"TopicPrefix"),e.qZA(),e._UZ(46,"span",19),e.qZA(),e.TgZ(47,"div",9)(48,"input",20),e.NdJ("ngModelChange",function(s){return t.edgeXSink.topicPrefix=s}),e.qZA()()(),e.TgZ(49,"div",5)(50,"label",6),e._uU(51,"ContentType"),e.qZA(),e.TgZ(52,"div",9)(53,"input",21),e.NdJ("ngModelChange",function(s){return t.edgeXSink.contentType=s}),e.qZA()()(),e.TgZ(54,"div",5)(55,"label",6)(56,"span",7),e._uU(57,"MessageType"),e.qZA(),e._UZ(58,"span",22),e.qZA(),e.TgZ(59,"div",9)(60,"select",23),e.NdJ("ngModelChange",function(s){return t.edgeXSink.messageType=s}),e.TgZ(61,"option",24),e._uU(62,"event"),e.qZA(),e.TgZ(63,"option",25),e._uU(64,"request"),e.qZA()()()(),e.TgZ(65,"div",5)(66,"label",6)(67,"span",7),e._uU(68,"Metadata"),e.qZA(),e._UZ(69,"span",26),e.qZA(),e.TgZ(70,"div",9)(71,"input",27),e.NdJ("ngModelChange",function(s){return t.edgeXSink.metadata=s}),e.qZA()()(),e.TgZ(72,"div",5)(73,"label",6),e._uU(74,"ProfileName"),e.qZA(),e.TgZ(75,"div",9)(76,"app-device-profile-combo-list",28),e.NdJ("singleProfileSelectedChange",function(s){return t.edgeXSink.profileName=s}),e.qZA()()(),e.TgZ(77,"div",5)(78,"label",6),e._uU(79,"DeviceName"),e.qZA(),e.TgZ(80,"div",9)(81,"app-device-combo-list",29),e.NdJ("singleDeviceSelectedChange",function(s){return t.edgeXSink.deviceName=s}),e.qZA()()(),e.TgZ(82,"div",5)(83,"label",6),e._uU(84,"SourceName"),e.qZA(),e.TgZ(85,"div",9)(86,"input",30),e.NdJ("ngModelChange",function(s){return t.edgeXSink.sourceName=s}),e.qZA()()(),e.TgZ(87,"div",5)(88,"label",6)(89,"span",7),e._uU(90,"SendSingle"),e.qZA(),e._UZ(91,"span",31),e.qZA(),e.TgZ(92,"div",9)(93,"select",32),e.NdJ("ngModelChange",function(s){return t.edgeXSink.sendSingle=s}),e.TgZ(94,"option",33),e._uU(95,"false"),e.qZA(),e.TgZ(96,"option",33),e._uU(97,"true"),e.qZA()()()(),e.TgZ(98,"div",5)(99,"label",6)(100,"span",7),e._uU(101,"DataTemplate"),e.qZA(),e._UZ(102,"span",34),e.qZA(),e.TgZ(103,"div",9)(104,"input",35),e.NdJ("ngModelChange",function(s){return t.edgeXSink.dataTemplate=s}),e.qZA()()(),e.TgZ(105,"div",5)(106,"label",6)(107,"span",7),e._uU(108,"EdgeX Sink Options"),e.qZA(),e._UZ(109,"span",36),e.qZA(),e.TgZ(110,"div",9)(111,"app-edgex-sink-optional",37),e.NdJ("optionalChange",function(s){return t.edgeXSink.optional=s}),e.qZA()()(),e.TgZ(112,"div",5)(113,"label",6),e._uU(114,"Advanced Options"),e.qZA(),e.TgZ(115,"div",9)(116,"app-sink-base-properties",38),e.NdJ("sinkBasePropertiesChange",function(s){return t.onSinkBasePropertiesChange(s)}),e.qZA()()()()()()),2&o&&(e.xp6(13),e.Q6J("ngModel",t.edgeXSink.type),e.xp6(11),e.Q6J("ngModel",t.edgeXSink.protocol),e.xp6(5),e.Q6J("ngModel",t.edgeXSink.host),e.xp6(5),e.Q6J("ngModel",t.edgeXSink.port),e.xp6(7),e.Q6J("ngModel",t.edgeXSink.topic),e.xp6(7),e.Q6J("ngModel",t.edgeXSink.topicPrefix),e.xp6(5),e.Q6J("ngModel",t.edgeXSink.contentType),e.xp6(7),e.Q6J("ngModel",t.edgeXSink.messageType),e.xp6(11),e.Q6J("ngModel",t.edgeXSink.metadata),e.xp6(5),e.Q6J("singleSelectionMode",!0)("singleProfileSelected",t.edgeXSink.profileName),e.xp6(5),e.Q6J("singleSelectionMode",!0)("singleDeviceSelected",t.edgeXSink.deviceName),e.xp6(5),e.Q6J("ngModel",t.edgeXSink.sourceName),e.xp6(7),e.Q6J("ngModel",t.edgeXSink.sendSingle),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0),e.xp6(8),e.Q6J("ngModel",t.edgeXSink.dataTemplate),e.xp6(7),e.Q6J("optional",t.edgeXSink.optional),e.xp6(5),e.Q6J("sinkBaseProperties",t.sinkBaseProperties))},dependencies:[l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.On,l.F,G.h,w.o,N,te]})}return a})();var oe=d(5167),ie=d(9167),ae=d(4546);function se(a,r){1&a&&(e.TgZ(0,"div",21),e._UZ(1,"i",22),e.TgZ(2,"span"),e.SDv(3,23),e.qZA()())}function le(a,r){1&a&&(e.TgZ(0,"div")(1,"span"),e.SDv(2,32),e.qZA()())}function re(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"select",37),e.NdJ("change",function(t){e.CHM(n);const i=e.oxw(4);return e.KtG(i.onValueOfPutParamsChange(t))}),e.TgZ(1,"option",38),e._uU(2,"false"),e.qZA(),e.TgZ(3,"option",38),e._uU(4,"true"),e.qZA()()}if(2&a){const n=e.oxw().$implicit;e.MGl("id","cmd-param-",n.resourceName,""),e.s9C("name",n.resourceName),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0)}}function de(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"input",39),e.NdJ("change",function(t){e.CHM(n);const i=e.oxw(4);return e.KtG(i.onValueOfPutParamsChange(t))}),e.qZA()}if(2&a){const n=e.oxw().$implicit;e.MGl("id","cmd-param-",n.resourceName,""),e.s9C("name",n.resourceName),e.MGl("placeholder","valueType: ",n.valueType,"")}}function _e(a,r){if(1&a&&(e.ynx(0),e._uU(1),e.BQk()),2&a){const n=e.oxw(4);e.xp6(1),e.hij(" ",n.cmdParametersValueRender()," ")}}function ce(a,r){if(1&a&&(e.TgZ(0,"div")(1,"form")(2,"div",2)(3,"label",33),e.SDv(4,34),e.qZA(),e.TgZ(5,"div",6),e.YNc(6,re,5,4,"select",35),e.YNc(7,de,1,3,"ng-template",null,36,e.W1O),e.qZA()()(),e.YNc(9,_e,2,1,"ng-container",30),e.qZA()),2&a){const n=r.$implicit,o=r.last,t=e.MAs(8);e.xp6(3),e.s9C("for",n.resourceName),e.xp6(1),e.pQV(n.resourceName),e.QtT(4),e.xp6(2),e.Q6J("ngIf","Bool"==n.valueType)("ngIfElse",t),e.xp6(3),e.Q6J("ngIf",o)}}function ge(a,r){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,le,3,0,"div",30),e.YNc(2,ce,10,5,"div",31),e.qZA()),2&a){const n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",0==n.cmdSvcInfo.parametersOfPutCommand.length),e.xp6(1),e.Q6J("ngForOf",n.cmdSvcInfo.parametersOfPutCommand)}}function pe(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div",2)(1,"label",40)(2,"span",4),e.SDv(3,41),e.qZA(),e._UZ(4,"span",42),e.qZA(),e.TgZ(5,"div",6)(6,"select",43),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw(2);return e.KtG(i.cmdSvcInfo.pushEventOfGetCmdParamter=t)}),e.TgZ(7,"option",44),e._uU(8,"true"),e.qZA(),e.TgZ(9,"option",45),e._uU(10,"false"),e.qZA()()()(),e.TgZ(11,"div",2)(12,"label",46)(13,"span",4),e.SDv(14,47),e.qZA(),e._UZ(15,"span",48),e.qZA(),e.TgZ(16,"div",6)(17,"select",49),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw(2);return e.KtG(i.cmdSvcInfo.returnEventOfGetCmdParamter=t)}),e.TgZ(18,"option",44),e._uU(19,"true"),e.qZA(),e.TgZ(20,"option",45),e._uU(21,"false"),e.qZA()()()()}if(2&a){const n=e.oxw(2);e.xp6(6),e.Q6J("ngModel",n.cmdSvcInfo.pushEventOfGetCmdParamter),e.xp6(11),e.Q6J("ngModel",n.cmdSvcInfo.returnEventOfGetCmdParamter)}}function ue(a,r){if(1&a&&(e.TgZ(0,"div",2)(1,"label",18),e._uU(2,"Parameters"),e.qZA(),e.TgZ(3,"div",6)(4,"div",24)(5,"div",25)(6,"span"),e.SDv(7,26),e.qZA()(),e.TgZ(8,"div",27),e.YNc(9,ge,3,2,"div",28),e.YNc(10,pe,22,2,"ng-template",null,29,e.W1O),e.qZA()()()()),2&a){const n=e.MAs(11),o=e.oxw();e.xp6(9),e.Q6J("ngIf","PUT"==o.cmdSvcInfo.httpMethod)("ngIfElse",n)}}let L=(()=>{class a{get url(){return this._url}set url(n){this._url=n,this._url&&this.urlParser(n)}get httpMethod(){return this._httpMethod}set httpMethod(n){this._httpMethod=n,this.cmdSvcInfo.httpMethod=this._httpMethod}get requestBodyJSONStr(){return this._requestBodyJSONStr}set requestBodyJSONStr(n){this._requestBodyJSONStr=n}constructor(n,o){this.metedataSvc=n,this.cmdSvc=o,this.cmdURLFixedPrefix="/api/v3/device/name/",this.notCommandPathMsgShow=!1,this.deviceName="",this.commandName="",this.parameter={},this._url="",this._httpMethod="",this._requestBodyJSONStr="",this.cmdSvcInfoChange=new e.vpe,this.profileForm=new l.nJ({host:new l.p4(""),port:new l.p4(""),path:new l.p4(""),httpMethod:new l.p4(""),pushEventOfGetCmdParamter:new l.p4(""),returnEventOfGetCmdParamter:new l.p4("")}),this.cmdSvcInfo={host:"edgex-core-command",port:59882,path:"",pushEventOfGetCmdParamter:"true",returnEventOfGetCmdParamter:"true",parametersOfPutCommand:[]}}ngOnInit(){}ngAfterViewInit(){this.profileForm.valueChanges.pipe(b(400),(0,Z.x)()).subscribe(()=>{this.cmdSvcInfoChange.emit(this.cmdSvcInfo)}),this.renderPopoverComponent()}urlParser(n){let o={};try{o=new URL(n)}catch{return void(this.notCommandPathMsgShow=!0)}if(o.pathname.startsWith(this.cmdURLFixedPrefix)){let t=o.pathname.substring(this.cmdURLFixedPrefix.length).split("/");if(2===t.length)return this.deviceName=t[0],this.commandName=t[1],this.getCommandParameterByDeviceAndCommandName(this.deviceName,this.commandName),this.cmdSvcInfo.path=o.pathname,this.cmdSvcInfo.host=o.hostname,this.cmdSvcInfo.port=Number(o.port),this.cmdSvcInfo.pushEventOfGetCmdParamter=o.searchParams.get("ds-pushevent")||"true",void(this.cmdSvcInfo.returnEventOfGetCmdParamter=o.searchParams.get("ds-returnevent")||"true")}this.notCommandPathMsgShow=!0}getCommandParameterByDeviceAndCommandName(n,o){this.cmdSvc.findDeviceAssociatedCommnadsByDeviceName(n).subscribe(t=>{t.deviceCoreCommand.coreCommands.forEach(i=>{i.name===o&&(this.cmdSvcInfo.parametersOfPutCommand=i.parameters)})})}cmdParametersValueRender(){let n={};try{n=JSON.parse(this.requestBodyJSONStr)}catch{return}for(const[o,t]of Object.entries(n))this.cmdSvcInfo.parametersOfPutCommand.forEach(i=>{i.resourceName===o&&$(`#cmd-param-${o}`).val(t)})}onValueOfPutParamsChange(n){this.cmdSvcInfoChange.emit(this.cmdSvcInfo)}renderPopoverComponent(){$('[data-toggle="popover"]').popover({trigger:"hover"})}onCmdMethodSelected(n){this.cmdSvcInfo.httpMethod=n,this.cmdSvcInfoChange.emit(this.cmdSvcInfo),setTimeout(()=>{this.renderPopoverComponent()},500)}onCommandSelected(n){this.cmdSvcInfo.path=n.path,this.cmdSvcInfo.parametersOfPutCommand=n.parameters}requestBodyAssemble(){let n={};return this.cmdSvcInfo.parametersOfPutCommand.forEach(o=>{!o||!$(`#cmd-param-${o.resourceName}`).val()||""!==$(`#cmd-param-${o.resourceName}`).val().trim()&&(n[o.resourceName]=$(`#cmd-param-${o.resourceName}`).val().trim())}),JSON.stringify(n)}resetPathParameterSuffix(){(-1!==this.cmdSvcInfo.path.indexOf("ds-pushevent")||-1!==this.cmdSvcInfo.path.indexOf("ds-returnevent"))&&(this.cmdSvcInfo.path=this.cmdSvcInfo.path.split("?")[0]),this.cmdSvcInfo.path=`${this.cmdSvcInfo.path}?ds-pushevent=${this.cmdSvcInfo.pushEventOfGetCmdParamter}&ds-returnevent=${this.cmdSvcInfo.returnEventOfGetCmdParamter}`}getHttpMethod(){return this.cmdSvcInfo.httpMethod}getRequestBodyJSONStr(){return this.requestBodyAssemble()}getUrl(){return"GET"===this.cmdSvcInfo.httpMethod&&this.resetPathParameterSuffix(),`http://${this.cmdSvcInfo.host}:${this.cmdSvcInfo.port}${this.cmdSvcInfo.path}`}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(oe.D),e.Y36(ie.V))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-command-service-template"]],inputs:{url:"url",httpMethod:"httpMethod",requestBodyJSONStr:"requestBodyJSONStr",cmdSvcInfo:"cmdSvcInfo"},outputs:{cmdSvcInfoChange:"cmdSvcInfoChange"},decls:33,vars:19,consts:function(){let n,o,t,i,s,_,f,p;return n="the REST address host can't be empty!",o="the REST address port can't be empty and only pure integer is supported!",t=" Invalid command service url, please don't use this template for custom http request, or select one new valid command path if you insist on using the template! ",i="Command Parameters Setting",s="no paramters.",_="" + "\ufffd0\ufffd" + "",f="pushevent",p="returnevent",[["class","alert alert-danger","role","alert",4,"ngIf"],[3,"formGroup"],[1,"form-group","row"],["for","HttpMethod","required","",1,"col-md-2","col-form-label"],[1,"mr-2"],["role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","httpMethod field will be filled up automatically when the path field is selected! ",1,"fa","fa-question-circle-o","fa-lg"],[1,"col-md-10"],["type","text","name","httpMethod","formControlName","httpMethod","readonly","true","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","row","has-validation"],["for","addressHostREST","required","",1,"col-md-2","col-form-label"],["role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","Both Host and Port fields are editable if you have a different host address !",1,"fa","fa-question-circle-o","fa-lg"],["type","text","id","addressHostREST","name","addressHost","formControlName","host","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","addressHostRESTFeedback",1,"invalid-feedback"],n,["for","addressPortREST","required","",1,"col-md-2","col-form-label"],["type","number","id","addressPortREST","name","addressPort","formControlName","port","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","addressPortRESTFeedback",1,"invalid-feedback"],o,["for","addressPath","required","",1,"col-md-2","col-form-label"],[3,"validate","deviceName","commandName","httpMethod","commandPath","cmdMethodEvent","commandSelectedEvent"],["class","form-group row",4,"ngIf"],["role","alert",1,"alert","alert-danger"],[1,"fa","fa-warning"],t,[1,"card"],[1,"card-header"],i,[1,"card-body"],[4,"ngIf","ngIfElse"],["getParameter",""],[4,"ngIf"],[4,"ngFor","ngForOf"],s,[1,"col-md-2","col-form-label",3,"for"],_,["class","custom-select",3,"id","name","change",4,"ngIf","ngIfElse"],["valueTypeIsNotBool",""],[1,"custom-select",3,"id","name","change"],[3,"ngValue"],["type","text",1,"form-control",3,"id","name","placeholder","change"],["for","ds-pushevent",1,"col-md-2","col-form-label"],f,["role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","true indicates a successful GET will result in an event being pushed to the EdgeX system",1,"fa","fa-question-circle-o","fa-lg"],["id","ds-pushevent","name","ds-pushevent","formControlName","pushEventOfGetCmdParamter",1,"custom-select",3,"ngModel","ngModelChange"],["value","true"],["value","false"],["for","ds-returnevent",1,"col-md-2","col-form-label"],p,["role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","no indicates there will be no Event returned in the http response",1,"fa","fa-question-circle-o","fa-lg"],["id","ds-returnevent","name","ds-returnevent","formControlName","returnEventOfGetCmdParamter",1,"custom-select",3,"ngModel","ngModelChange"]]},template:function(o,t){1&o&&(e.YNc(0,se,4,0,"div",0),e.TgZ(1,"form",1)(2,"div",2)(3,"label",3)(4,"span",4),e._uU(5,"HttpMethod"),e.qZA(),e._UZ(6,"span",5),e.qZA(),e.TgZ(7,"div",6)(8,"input",7),e.NdJ("ngModelChange",function(s){return t.cmdSvcInfo.httpMethod=s}),e.qZA()()(),e.TgZ(9,"div",8)(10,"label",9)(11,"span",4),e._uU(12,"Host"),e.qZA(),e._UZ(13,"span",10),e.qZA(),e.TgZ(14,"div",6)(15,"input",11),e.NdJ("ngModelChange",function(s){return t.cmdSvcInfo.host=s}),e.qZA(),e.TgZ(16,"div",12)(17,"small"),e.SDv(18,13),e.qZA()()()(),e.TgZ(19,"div",8)(20,"label",14),e._uU(21,"Port"),e.qZA(),e.TgZ(22,"div",6)(23,"input",15),e.NdJ("ngModelChange",function(s){return t.cmdSvcInfo.port=s}),e.qZA(),e.TgZ(24,"div",16)(25,"small"),e.SDv(26,17),e.qZA()()()(),e.TgZ(27,"div",2)(28,"label",18),e._uU(29,"Path"),e.qZA(),e.TgZ(30,"div",6)(31,"app-device-core-command-combo-list",19),e.NdJ("cmdMethodEvent",function(s){return t.onCmdMethodSelected(s)})("commandSelectedEvent",function(s){return t.onCommandSelected(s)}),e.qZA()()(),e.YNc(32,ue,12,2,"div",20),e.qZA()),2&o&&(e.Q6J("ngIf",t.notCommandPathMsgShow),e.xp6(1),e.Q6J("formGroup",t.profileForm),e.xp6(7),e.Q6J("ngModel",t.cmdSvcInfo.httpMethod),e.xp6(7),e.ekj("is-invalid",!t.cmdSvcInfo.host)("is-valid",t.cmdSvcInfo.host),e.Q6J("ngModel",t.cmdSvcInfo.host),e.xp6(8),e.ekj("is-invalid",!t.cmdSvcInfo.port)("is-valid",t.cmdSvcInfo.port),e.Q6J("ngModel",t.cmdSvcInfo.port),e.xp6(8),e.Q6J("validate",!0)("deviceName",t.deviceName)("commandName",t.commandName)("httpMethod",t.cmdSvcInfo.httpMethod)("commandPath",t.cmdSvcInfo.path),e.xp6(1),e.Q6J("ngIf",t.cmdSvcInfo.path&&t.cmdSvcInfo.httpMethod&&0!==t.cmdSvcInfo.parametersOfPutCommand.length))},dependencies:[u.sg,u.O5,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.Q7,l.F,l.sg,l.u,ae.P]})}return a})();function me(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"app-command-service-template",8),e.NdJ("cmdSvcInfoChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.onCmdSvcTemplateInfoChange(t))}),e.qZA()()}if(2&a){const n=e.oxw();e.xp6(1),e.Q6J("url",n.restSink.url)("httpMethod",n.restSink.method)("requestBodyJSONStr",n.restSink.dataTemplate?n.restSink.dataTemplate:"")}}function Se(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"form",51)(2,"div",52)(3,"div",53)(4,"span",54),e._uU(5,"Key"),e.qZA()(),e.TgZ(6,"input",55),e.NdJ("ngModelChange",function(t){const s=e.CHM(n).$implicit;return e.KtG(s.key=t)})("ngModelChange",function(t){e.CHM(n);const i=e.oxw(2);return e.KtG(i.requestHeaderChange(t))}),e.qZA()(),e.TgZ(7,"div",56),e._UZ(8,"i",57),e.qZA(),e.TgZ(9,"div",58)(10,"div",53)(11,"span",54),e._uU(12,"Value"),e.qZA()(),e.TgZ(13,"input",59),e.NdJ("ngModelChange",function(t){const s=e.CHM(n).$implicit;return e.KtG(s.value=t)})("ngModelChange",function(t){e.CHM(n);const i=e.oxw(2);return e.KtG(i.requestHeaderChange(t))}),e.qZA()(),e.TgZ(14,"div",60)(15,"button",61),e.NdJ("click",function(){const i=e.CHM(n).index,s=e.oxw(2);return e.KtG(s.removeRequestHeader(i))}),e._UZ(16,"i",62),e.qZA()()()()}if(2&a){const n=r.$implicit;e.xp6(6),e.Q6J("ngModel",n.key),e.xp6(7),e.Q6J("ngModel",n.value)}}function fe(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"form")(2,"div",9)(3,"label",10),e._uU(4,"Method"),e.qZA(),e.TgZ(5,"div",11)(6,"select",12),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.method=t)}),e.TgZ(7,"option",13),e._uU(8,"GET"),e.qZA(),e.TgZ(9,"option",14),e._uU(10,"POST"),e.qZA(),e.TgZ(11,"option",15),e._uU(12,"PUT"),e.qZA(),e.TgZ(13,"option",16),e._uU(14,"DELETE"),e.qZA(),e.TgZ(15,"option",17),e._uU(16,"PATCH"),e.qZA(),e.TgZ(17,"option",18),e._uU(18,"HEAD"),e.qZA()()()(),e.TgZ(19,"div",19)(20,"label",10),e._uU(21,"URL"),e.qZA(),e.TgZ(22,"div",11)(23,"input",20),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.url=t)}),e.qZA(),e.TgZ(24,"div",21)(25,"small"),e.SDv(26,22),e.qZA()()()(),e.TgZ(27,"div",9)(28,"label",10),e._uU(29,"BodyType"),e.qZA(),e.TgZ(30,"div",11)(31,"select",23),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.bodyType=t)}),e.TgZ(32,"option",24),e._uU(33,"none"),e.qZA(),e.TgZ(34,"option",25),e._uU(35,"json"),e.qZA(),e.TgZ(36,"option",26),e._uU(37,"text"),e.qZA(),e.TgZ(38,"option",27),e._uU(39,"html"),e.qZA(),e.TgZ(40,"option",28),e._uU(41,"xml"),e.qZA(),e.TgZ(42,"option",29),e._uU(43,"javascript"),e.qZA(),e.TgZ(44,"option",30),e._uU(45,"form"),e.qZA()()()(),e.TgZ(46,"div",9)(47,"label",10),e._uU(48,"Headers"),e.qZA(),e.TgZ(49,"div",11)(50,"div",0)(51,"div",6)(52,"p",31),e._UZ(53,"span",32),e.TgZ(54,"span",33),e.NdJ("click",function(){e.CHM(n);const t=e.oxw();return e.KtG(t.addRequestHeader())}),e.SDv(55,34),e.qZA()(),e.YNc(56,Se,17,2,"div",35),e.qZA()()()(),e.TgZ(57,"div",9)(58,"label",10)(59,"span",36),e._uU(60,"timeout"),e.qZA(),e._UZ(61,"span",37),e.qZA(),e.TgZ(62,"div",11)(63,"input",38),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.timeout=t)}),e.qZA()()(),e.TgZ(64,"div",9)(65,"label",10)(66,"span",36),e._uU(67,"DebugResp"),e.qZA(),e._UZ(68,"span",39),e.qZA(),e.TgZ(69,"div",11)(70,"select",40),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.debugResp=t)}),e.TgZ(71,"option",41),e._uU(72,"false"),e.qZA(),e.TgZ(73,"option",41),e._uU(74,"true"),e.qZA()()()(),e.TgZ(75,"div",9)(76,"label",10)(77,"span",36),e._uU(78,"sendSingle"),e.qZA(),e._UZ(79,"span",42),e.qZA(),e.TgZ(80,"div",11)(81,"select",43),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.sendSingle=t)}),e.TgZ(82,"option",41),e._uU(83,"false"),e.qZA(),e.TgZ(84,"option",41),e._uU(85,"true"),e.qZA()()()(),e.TgZ(86,"div",9)(87,"label",10)(88,"span",36),e._uU(89,"dataTemplate"),e.qZA(),e._UZ(90,"span",44),e.qZA(),e.TgZ(91,"div",11)(92,"input",45),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.dataTemplate=t)}),e.qZA()()(),e.TgZ(93,"div",9)(94,"label",10),e._uU(95,"InsecureSkipVerify"),e.qZA(),e.TgZ(96,"div",11)(97,"select",46),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.insecureSkipVerify=t)}),e.TgZ(98,"option",41),e._uU(99,"true"),e.qZA(),e.TgZ(100,"option",41),e._uU(101,"false"),e.qZA()()()(),e.TgZ(102,"div",9)(103,"label",10),e._uU(104,"CertificationPath"),e.qZA(),e.TgZ(105,"div",11)(106,"input",47),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.certificationPath=t)}),e.qZA()()(),e.TgZ(107,"div",9)(108,"label",10),e._uU(109,"PrivateKeyPath"),e.qZA(),e.TgZ(110,"div",11)(111,"input",48),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.privateKeyPath=t)}),e.qZA()()(),e.TgZ(112,"div",9)(113,"label",10),e._uU(114,"RootCaPath"),e.qZA(),e.TgZ(115,"div",11)(116,"input",49),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.restSink.rootCaPath=t)}),e.qZA()()(),e.TgZ(117,"div",9)(118,"label",10),e._uU(119,"Advanced Options"),e.qZA(),e.TgZ(120,"div",11)(121,"app-sink-base-properties",50),e.NdJ("sinkBasePropertiesChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.onSinkBasePropertiesChange(t))}),e.qZA()()()()()}if(2&a){const n=e.oxw();e.xp6(6),e.Q6J("ngModel",n.restSink.method),e.xp6(17),e.ekj("is-invalid",!n.restSink.url)("is-valid",n.restSink.url),e.Q6J("ngModel",n.restSink.url),e.xp6(8),e.Q6J("ngModel",n.restSink.bodyType),e.xp6(25),e.Q6J("ngForOf",n.requestHeaderList),e.xp6(7),e.Q6J("ngModel",n.restSink.timeout),e.xp6(7),e.Q6J("ngModel",n.restSink.debugResp),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0),e.xp6(8),e.Q6J("ngModel",n.restSink.sendSingle),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0),e.xp6(8),e.Q6J("ngModel",n.restSink.dataTemplate),e.xp6(5),e.Q6J("ngModel",n.restSink.insecureSkipVerify),e.xp6(1),e.Q6J("ngValue",!0),e.xp6(2),e.Q6J("ngValue",!1),e.xp6(6),e.Q6J("ngModel",n.restSink.certificationPath),e.xp6(5),e.Q6J("ngModel",n.restSink.privateKeyPath),e.xp6(5),e.Q6J("ngModel",n.restSink.rootCaPath),e.xp6(5),e.Q6J("sinkBaseProperties",n.sinkBaseProperties)}}let Te=(()=>{class a{get restSink(){return this._restSink}set restSink(n){Object.assign(this._restSink,n)}constructor(){this.SVC_TYPE_COMMAND="command",this.SVC_TYPE_CUSTOM="custom",this.templateTypeSelected=this.SVC_TYPE_COMMAND,this.sinkBaseProperties={},this.restSinkChange=new e.vpe,this.requestHeaderList=[],this._restSink={method:"GET",bodyType:"json",debugResp:!1,insecureSkipVerify:!0,timeout:5e3,sendSingle:!1,dataTemplate:""}}ngOnInit(){if(Object.assign(this.sinkBaseProperties,this.restSink),this.restSink.headers)for(const[n,o]of Object.entries(this.restSink.headers))this.requestHeaderList.push({key:n,value:o});this.renderPopoverComponent()}ngOnChanges(){this.restSinkChange.emit(this.restSink)}ngAfterViewInit(){}renderPopoverComponent(){$('[data-toggle="popover"]').popover({trigger:"hover"})}templateTypeToggle(n){this.templateTypeSelected=n,window.setTimeout(()=>{this.renderPopoverComponent()},1e3)}requestHeaderChange(n){this.headersResovler()}headersResovler(){let n={};this.requestHeaderList.forEach(o=>{n[`${o.key}`]=`${o.value}`}),this.restSink.headers=n,this.restSinkChange.emit(this.restSink)}addRequestHeader(){this.requestHeaderList.push({key:"",value:""})}removeRequestHeader(n,o){this.requestHeaderList.splice(n,1),this.headersResovler()}onSinkBasePropertiesChange(n){Object.assign(this.restSink,n)}onCmdSvcTemplateInfoChange(n){this.getValuesSettingAllOfCommandTemplate()}getValuesSettingAllOfCommandTemplate(){this.restSink.method=this.cmdSvcTemplate.getHttpMethod(),this.restSink.url=this.cmdSvcTemplate.getUrl(),this.restSink.dataTemplate=this.cmdSvcTemplate.getRequestBodyJSONStr()}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-rest-sink"]],viewQuery:function(o,t){if(1&o&&e.Gf(L,5),2&o){let i;e.iGM(i=e.CRH())&&(t.cmdSvcTemplate=i.first)}},inputs:{restSink:"restSink"},outputs:{restSinkChange:"restSinkChange"},features:[e.TTD],decls:17,vars:10,consts:function(){let n,o;return n="the url can't be empty!",o="Add Headers KV",[[1,"card"],[1,"card-header"],[1,"fa","fa-tags","text-danger","mr-2"],[1,"font-weight-bold"],["role","button",1,"badge","badge-secondary","mr-2",3,"click"],[1,"fa","fa-square-o","mr-1"],[1,"card-body"],[4,"ngIf"],[3,"url","httpMethod","requestBodyJSONStr","cmdSvcInfoChange"],[1,"form-group","row"],[1,"col-sm-3","col-form-label","text-nowrap","text-truncate"],[1,"col-sm-9"],["name","method",1,"custom-select",3,"ngModel","ngModelChange"],["value","GET"],["value","POST"],["value","PUT"],["value","DELETE"],["value","PATCH"],["value","HEAD"],[1,"form-group","row","has-validation"],["type","text","name","url",1,"form-control",3,"ngModel","ngModelChange"],["id","ruleName",1,"invalid-feedback"],n,["name","bodyType",1,"custom-select",3,"ngModel","ngModelChange"],["value","none"],["value","json"],["value","text"],["value","html"],["value","xml"],["value","javascript"],["value","form"],[1,"badge","badge-secondary","font-weight-bold"],[1,"fa","fa-plus-circle","mr-2"],["role","button",1,"user-select-none",3,"click"],o,[4,"ngFor","ngForOf"],[1,"mr-2"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","The timeout (milliseconds) for a HTTP request, defaults to 5000 ms",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","timeout",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Control if print the response information into the console. If set it to true, then print response; If set to false, then skip print log. The default is false.",1,"fa","fa-question-circle-o","fa-lg"],["name","debugResp",1,"custom-select",3,"ngModel","ngModelChange"],[3,"ngValue"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content",'The output messages are received as an array. This is indicate whether to send the results one by one. If false, the output message will be {"result":"${the string of received message}"}. For example, {"result":"[{\\"count\\":30},"\\"count\\":20}]"}. Otherwise, the result message will be sent one by one with the actual field name. For the same example as above, it will send {"count":30}, then send {"count":20} to the RESTful endpoint.Default to false.',1,"fa","fa-question-circle-o","fa-lg"],["name","sendSingle",1,"custom-select",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","here be treated as http post or put RequestBody,The golang template format string to specify the output data format. The input of the template is the sink message which is always an array of map. If no data template is specified, the raw input will be the data.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","dataTemplate",1,"form-control",3,"ngModel","ngModelChange"],["name","insecureSkipVerify",1,"custom-select",3,"ngModel","ngModelChange"],["type","text","name","certificationPath",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","privateKeyPath",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","rootCaPath",1,"form-control",3,"ngModel","ngModelChange"],[3,"sinkBaseProperties","sinkBasePropertiesChange"],[1,"form-inline","mb-1"],[1,"input-group","mb-1"],[1,"input-group-prepend"],[1,"input-group-text"],["type","text","name","headerKey",1,"form-control",2,"width","200px","min-width","200px",3,"ngModel","ngModelChange"],[1,"input-group","mx-2"],[1,"fa","fa-long-arrow-right"],[1,"input-group"],["type","text","name","headerValue",1,"form-control",2,"width","200px","min-width","200px",3,"ngModel","ngModelChange"],[1,"input-group","ml-2"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash"]]},template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span",3),e._uU(4,"REST Sink"),e.qZA()(),e.TgZ(5,"div",1)(6,"span",4),e.NdJ("click",function(){return t.templateTypeToggle(t.SVC_TYPE_COMMAND)}),e._UZ(7,"i",5),e.TgZ(8,"span"),e._uU(9,"EdgeXCommandServiceTemplate"),e.qZA()(),e.TgZ(10,"span",4),e.NdJ("click",function(){return t.templateTypeToggle(t.SVC_TYPE_CUSTOM)}),e._UZ(11,"i",5),e.TgZ(12,"span"),e._uU(13,"CustomHttpServiceTemplate"),e.qZA()()(),e.TgZ(14,"div",6),e.YNc(15,me,2,3,"div",7),e.YNc(16,fe,122,23,"div",7),e.qZA()()),2&o&&(e.xp6(6),e.ekj("badge-info",t.templateTypeSelected===t.SVC_TYPE_COMMAND),e.xp6(1),e.ekj("fa-check-square",t.templateTypeSelected===t.SVC_TYPE_COMMAND),e.xp6(3),e.ekj("badge-info",t.templateTypeSelected===t.SVC_TYPE_CUSTOM),e.xp6(1),e.ekj("fa-check-square",t.templateTypeSelected===t.SVC_TYPE_CUSTOM),e.xp6(4),e.Q6J("ngIf",t.templateTypeSelected===t.SVC_TYPE_COMMAND),e.xp6(1),e.Q6J("ngIf",t.templateTypeSelected===t.SVC_TYPE_CUSTOM))},dependencies:[u.sg,u.O5,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.On,l.F,L,N]})}return a})(),Ee=(()=>{class a{get mqttSink(){return this._mqttSink}set mqttSink(n){Object.assign(this._mqttSink,n)}constructor(){this.sinkBaseProperties={},this.mqttSinkChange=new e.vpe,this._mqttSink={server:"tcp://127.0.0.1:1883",protocolVersion:"3.1",qos:0,insecureSkipVerify:!0,retained:!1,sendSingle:!1}}ngOnInit(){this.renderPopoverComponent(),Object.assign(this.sinkBaseProperties,this.mqttSink)}ngOnChanges(){this.mqttSinkChange.emit(this.mqttSink)}renderPopoverComponent(){$('[data-toggle="popover"]').popover({trigger:"hover"})}onSinkBasePropertiesChange(n){Object.assign(this.mqttSink,n)}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-mqtt-sink"]],inputs:{mqttSink:"mqttSink"},outputs:{mqttSinkChange:"mqttSinkChange"},features:[e.TTD],decls:114,vars:32,consts:function(){let n,o,t,i;return n="the mqtt server address can't be empty!",o="the topic can't be empty!",t="Username",i="Password",[[1,"card"],[1,"card-header"],[1,"fa","fa-tags","text-danger","mr-2"],[1,"font-weight-bold"],[1,"card-body"],[1,"form-group","row","has-validation"],[1,"col-sm-3","col-form-label","text-nowrap","text-truncate"],[1,"col-sm-9"],["type","text","name","server",1,"form-control",3,"ngModel","ngModelChange"],["id","ruleName",1,"invalid-feedback"],n,["type","text","name","topic",1,"form-control",3,"ngModel","ngModelChange"],o,[1,"form-group","row"],["type","text","name","clientId",1,"form-control",3,"ngModel","ngModelChange"],["name","protocolVersion",1,"custom-select",3,"ngModel","ngModelChange"],["value","3.1"],["value","3.1.1"],["name","qos",1,"custom-select",3,"ngModel","ngModelChange"],[3,"ngValue"],t,["type","text","name","username",1,"form-control",3,"ngModel","ngModelChange"],i,["type","text","name","password",1,"form-control",3,"ngModel","ngModelChange"],["name","retained",1,"custom-select",3,"ngModel","ngModelChange"],[1,"mr-2"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content",'The output messages are received as an array. This is indicate whether to send the results one by one. If false, the output message will be {"result":"${the string of received message}"}. For example, {"result":"[{\\"count\\":30},"\\"count\\":20}]"}. Otherwise, the result message will be sent one by one with the actual field name. For the same example as above, it will send {"count":30}, then send {"count":20} to the RESTful endpoint.Default to false.',1,"fa","fa-question-circle-o","fa-lg"],["name","sendSingle",1,"custom-select",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","here is treated as mqtt payload, The golang template format string to specify the output data format. The input of the template is the sink message which is always an array of map. If no data template is specified, the raw input will be the data.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","dataTemplate",1,"form-control",3,"ngModel","ngModelChange"],["name","insecureSkipVerify",1,"custom-select",3,"ngModel","ngModelChange"],["type","text","name","certificationPath",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","privateKeyPath",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","rootCaPath",1,"form-control",3,"ngModel","ngModelChange"],[3,"sinkBaseProperties","sinkBasePropertiesChange"]]},template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span",3),e._uU(4,"MQTT Sink"),e.qZA()(),e.TgZ(5,"div",4)(6,"form")(7,"div",5)(8,"label",6),e._uU(9,"Server"),e.qZA(),e.TgZ(10,"div",7)(11,"input",8),e.NdJ("ngModelChange",function(s){return t.mqttSink.server=s}),e.qZA(),e.TgZ(12,"div",9)(13,"small"),e.SDv(14,10),e.qZA()()()(),e.TgZ(15,"div",5)(16,"label",6),e._uU(17,"Topic"),e.qZA(),e.TgZ(18,"div",7)(19,"input",11),e.NdJ("ngModelChange",function(s){return t.mqttSink.topic=s}),e.qZA(),e.TgZ(20,"div",9)(21,"small"),e.SDv(22,12),e.qZA()()()(),e.TgZ(23,"div",13)(24,"label",6),e._uU(25,"ClientId"),e.qZA(),e.TgZ(26,"div",7)(27,"input",14),e.NdJ("ngModelChange",function(s){return t.mqttSink.clientId=s}),e.qZA()()(),e.TgZ(28,"div",13)(29,"label",6),e._uU(30,"ProtocolVersion"),e.qZA(),e.TgZ(31,"div",7)(32,"select",15),e.NdJ("ngModelChange",function(s){return t.mqttSink.protocolVersion=s}),e.TgZ(33,"option",16),e._uU(34,"3.1"),e.qZA(),e.TgZ(35,"option",17),e._uU(36,"3.1.1"),e.qZA()()()(),e.TgZ(37,"div",13)(38,"label",6),e._uU(39,"Qos"),e.qZA(),e.TgZ(40,"div",7)(41,"select",18),e.NdJ("ngModelChange",function(s){return t.mqttSink.qos=s}),e.TgZ(42,"option",19),e._uU(43,"0"),e.qZA(),e.TgZ(44,"option",19),e._uU(45,"1"),e.qZA(),e.TgZ(46,"option",19),e._uU(47,"2"),e.qZA()()()(),e.TgZ(48,"div",13)(49,"label",6),e.SDv(50,20),e.qZA(),e.TgZ(51,"div",7)(52,"input",21),e.NdJ("ngModelChange",function(s){return t.mqttSink.username=s}),e.qZA()()(),e.TgZ(53,"div",13)(54,"label",6),e.SDv(55,22),e.qZA(),e.TgZ(56,"div",7)(57,"input",23),e.NdJ("ngModelChange",function(s){return t.mqttSink.password=s}),e.qZA()()(),e.TgZ(58,"div",13)(59,"label",6),e._uU(60,"Retained"),e.qZA(),e.TgZ(61,"div",7)(62,"select",24),e.NdJ("ngModelChange",function(s){return t.mqttSink.retained=s}),e.TgZ(63,"option",19),e._uU(64,"false"),e.qZA(),e.TgZ(65,"option",19),e._uU(66,"true"),e.qZA()()()(),e.TgZ(67,"div",13)(68,"label",6)(69,"span",25),e._uU(70,"sendSingle"),e.qZA(),e._UZ(71,"span",26),e.qZA(),e.TgZ(72,"div",7)(73,"select",27),e.NdJ("ngModelChange",function(s){return t.mqttSink.sendSingle=s}),e.TgZ(74,"option",19),e._uU(75,"false"),e.qZA(),e.TgZ(76,"option",19),e._uU(77,"true"),e.qZA()()()(),e.TgZ(78,"div",13)(79,"label",6)(80,"span",25),e._uU(81,"dataTemplate"),e.qZA(),e._UZ(82,"span",28),e.qZA(),e.TgZ(83,"div",7)(84,"input",29),e.NdJ("ngModelChange",function(s){return t.mqttSink.dataTemplate=s}),e.qZA()()(),e.TgZ(85,"div",13)(86,"label",6),e._uU(87,"InsecureSkipVerify"),e.qZA(),e.TgZ(88,"div",7)(89,"select",30),e.NdJ("ngModelChange",function(s){return t.mqttSink.insecureSkipVerify=s}),e.TgZ(90,"option",19),e._uU(91,"true"),e.qZA(),e.TgZ(92,"option",19),e._uU(93,"false"),e.qZA()()()(),e.TgZ(94,"div",13)(95,"label",6),e._uU(96,"CertificationPath"),e.qZA(),e.TgZ(97,"div",7)(98,"input",31),e.NdJ("ngModelChange",function(s){return t.mqttSink.certificationPath=s}),e.qZA()()(),e.TgZ(99,"div",13)(100,"label",6),e._uU(101,"PrivateKeyPath"),e.qZA(),e.TgZ(102,"div",7)(103,"input",32),e.NdJ("ngModelChange",function(s){return t.mqttSink.privateKeyPath=s}),e.qZA()()(),e.TgZ(104,"div",13)(105,"label",6),e._uU(106,"RootCaPath"),e.qZA(),e.TgZ(107,"div",7)(108,"input",33),e.NdJ("ngModelChange",function(s){return t.mqttSink.rootCaPath=s}),e.qZA()()(),e.TgZ(109,"div",13)(110,"label",6),e._uU(111,"Advanced Options"),e.qZA(),e.TgZ(112,"div",7)(113,"app-sink-base-properties",34),e.NdJ("sinkBasePropertiesChange",function(s){return t.onSinkBasePropertiesChange(s)}),e.qZA()()()()()()),2&o&&(e.xp6(11),e.ekj("is-invalid",!t.mqttSink.server)("is-valid",t.mqttSink.server),e.Q6J("ngModel",t.mqttSink.server),e.xp6(8),e.ekj("is-invalid",!t.mqttSink.topic)("is-valid",t.mqttSink.topic),e.Q6J("ngModel",t.mqttSink.topic),e.xp6(8),e.Q6J("ngModel",t.mqttSink.clientId),e.xp6(5),e.Q6J("ngModel",t.mqttSink.protocolVersion),e.xp6(9),e.Q6J("ngModel",t.mqttSink.qos),e.xp6(1),e.Q6J("ngValue",0),e.xp6(2),e.Q6J("ngValue",1),e.xp6(2),e.Q6J("ngValue",2),e.xp6(6),e.Q6J("ngModel",t.mqttSink.username),e.xp6(5),e.Q6J("ngModel",t.mqttSink.password),e.xp6(5),e.Q6J("ngModel",t.mqttSink.retained),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0),e.xp6(8),e.Q6J("ngModel",t.mqttSink.sendSingle),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0),e.xp6(8),e.Q6J("ngModel",t.mqttSink.dataTemplate),e.xp6(5),e.Q6J("ngModel",t.mqttSink.insecureSkipVerify),e.xp6(1),e.Q6J("ngValue",!0),e.xp6(2),e.Q6J("ngValue",!1),e.xp6(6),e.Q6J("ngModel",t.mqttSink.certificationPath),e.xp6(5),e.Q6J("ngModel",t.mqttSink.privateKeyPath),e.xp6(5),e.Q6J("ngModel",t.mqttSink.rootCaPath),e.xp6(5),e.Q6J("sinkBaseProperties",t.sinkBaseProperties))},dependencies:[l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.On,l.F,N]})}return a})(),he=(()=>{class a{get logSink(){return this._logSink}set logSink(n){Object.assign(this._logSink,n)}constructor(){this.sinkBaseProperties={},this.logSinkChange=new e.vpe,this._logSink={sendSingle:!1}}ngOnInit(){Object.assign(this.sinkBaseProperties,this.logSink),this.renderPopoverComponent()}ngOnChanges(){this.logSinkChange.emit(this.logSink)}renderPopoverComponent(){$('[data-toggle="popover"]').popover({trigger:"hover"})}onSinkBasePropertiesChange(n){Object.assign(this.logSink,n)}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-log-sink"]],inputs:{logSink:"logSink"},outputs:{logSinkChange:"logSinkChange"},features:[e.TTD],decls:35,vars:5,consts:[[1,"card"],[1,"card-header"],[1,"fa","fa-tags","text-danger","mr-2"],[1,"font-weight-bold"],[1,"card-body"],[1,"text-info","mb-2"],[1,"fa","fa-info-circle","mr-1"],[1,"form-group","row"],[1,"col-sm-3","col-form-label","text-nowrap","text-truncate"],[1,"mr-2"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content",'The output messages are received as an array. This is indicate whether to send the results one by one. If false, the output message will be {"result":"${the string of received message}"}. For example, {"result":"[{\\"count\\":30},"\\"count\\":20}]"}. Otherwise, the result message will be sent one by one with the actual field name. For the same example as above, it will send {"count":30}, then send {"count":20} to the RESTful endpoint.Default to false.',1,"fa","fa-question-circle-o","fa-lg"],[1,"col-sm-9"],["name","sendSingle",1,"custom-select",3,"ngModel","ngModelChange"],[3,"ngValue"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","here is treated as mqtt payload, The golang template format string to specify the output data format. The input of the template is the sink message which is always an array of map. If no data template is specified, the raw input will be the data.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","dataTemplate",1,"form-control",3,"ngModel","ngModelChange"],[3,"sinkBaseProperties","sinkBasePropertiesChange"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span",3),e._uU(4,"Log Sink"),e.qZA()(),e.TgZ(5,"div",4)(6,"p",5),e._UZ(7,"i",6),e._uU(8," The action is used for print output message into log file, the log file is at $eKuiper_install/log/stream.log by default."),e._UZ(9,"br"),e._uU(10," No properties can be specified for the action. "),e.qZA(),e.TgZ(11,"div",7)(12,"label",8)(13,"span",9),e._uU(14,"sendSingle"),e.qZA(),e._UZ(15,"span",10),e.qZA(),e.TgZ(16,"div",11)(17,"select",12),e.NdJ("ngModelChange",function(s){return t.logSink.sendSingle=s}),e.TgZ(18,"option",13),e._uU(19,"false"),e.qZA(),e.TgZ(20,"option",13),e._uU(21,"true"),e.qZA()()()(),e.TgZ(22,"div",7)(23,"label",8)(24,"span",9),e._uU(25,"dataTemplate"),e.qZA(),e._UZ(26,"span",14),e.qZA(),e.TgZ(27,"div",11)(28,"input",15),e.NdJ("ngModelChange",function(s){return t.logSink.dataTemplate=s}),e.qZA()()(),e.TgZ(29,"form")(30,"div",7)(31,"label",8),e._uU(32,"Advanced Options"),e.qZA(),e.TgZ(33,"div",11)(34,"app-sink-base-properties",16),e.NdJ("sinkBasePropertiesChange",function(s){return t.onSinkBasePropertiesChange(s)}),e.qZA()()()()()()),2&o&&(e.xp6(17),e.Q6J("ngModel",t.logSink.sendSingle),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0),e.xp6(8),e.Q6J("ngModel",t.logSink.dataTemplate),e.xp6(6),e.Q6J("sinkBaseProperties",t.sinkBaseProperties))},dependencies:[l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.On,l.F,N]})}return a})();function Ce(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"li",9)(1,"span",10),e._uU(2),e.qZA(),e.TgZ(3,"span",11)(4,"span",12),e.NdJ("click",function(){const t=e.CHM(n),i=t.$implicit,s=t.index,_=e.oxw(2);return e.KtG(_.editSinkTransfer(i,s))}),e._UZ(5,"i",13),e.qZA(),e.TgZ(6,"span",14),e.NdJ("click",function(){const t=e.CHM(n),i=t.$implicit,s=t.index,_=e.oxw(2);return e.KtG(_.deleteSink(i,s))}),e._UZ(7,"i",15),e.qZA()()()}if(2&a){const n=r.$implicit,o=r.index,t=e.oxw(2);e.ekj("list-group-item-light",o!==t.selectedSinkIndex)("list-group-item-secondary",o===t.selectedSinkIndex),e.xp6(2),e.Oqu(t.getSinkTypeOfAction(n))}}function Me(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"p",2)(2,"span",3),e.NdJ("click",function(){e.CHM(n);const t=e.oxw();return e.KtG(t.addSinkTransfer())}),e._UZ(3,"span",4),e.TgZ(4,"span",5),e.SDv(5,6),e.qZA()()(),e.TgZ(6,"ul",7),e.YNc(7,Ce,8,5,"li",8),e.qZA()()}if(2&a){const n=e.oxw();e.xp6(7),e.Q6J("ngForOf",n.ruleActions)}}function ve(a,r){1&a&&(e.TgZ(0,"span",33),e._uU(1,"Edit Sink"),e.qZA())}function Ne(a,r){if(1&a&&(e.TgZ(0,"span"),e._UZ(1,"i",32),e.TgZ(2,"span",33),e._uU(3,"Add Sink"),e.qZA(),e.YNc(4,ve,2,0,"span",34),e.qZA()),2&a){const n=e.oxw(2);e.xp6(4),e.Q6J("ngIf",n.sinkAddOrEditOperation===n.sinkOperation_EDIT)}}function Ae(a,r){1&a&&(e.TgZ(0,"span"),e._UZ(1,"i",35),e.TgZ(2,"span",33),e._uU(3,"Edit Sink"),e.qZA()())}function Re(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(n);const t=e.oxw(2);return e.KtG(t.addOneNewSink())}),e._uU(1,"Add"),e.qZA()}if(2&a){const n=e.oxw(2);e.Q6J("disabled",!n.validate())}}function be(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(n);const t=e.oxw(2);return e.KtG(t.updateSink())}),e._uU(1,"Update"),e.qZA()}if(2&a){const n=e.oxw(2);e.Q6J("disabled",!n.validate())}}function Ze(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"app-edgex-sink",37),e.NdJ("edgeXSinkChange",function(t){e.CHM(n);const i=e.oxw(2);return e.KtG(i.edgeXSink=t)}),e.qZA()()}if(2&a){const n=e.oxw(2);e.xp6(1),e.Q6J("edgeXSink",n.edgeXSink)}}function Le(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"app-mqtt-sink",38),e.NdJ("mqttSinkChange",function(t){e.CHM(n);const i=e.oxw(2);return e.KtG(i.mqttSink=t)}),e.qZA()()}if(2&a){const n=e.oxw(2);e.xp6(1),e.Q6J("mqttSink",n.mqttSink)}}function Ie(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"app-rest-sink",39),e.NdJ("restSinkChange",function(t){e.CHM(n);const i=e.oxw(2);return e.KtG(i.restSink=t)}),e.qZA()()}if(2&a){const n=e.oxw(2);e.xp6(1),e.Q6J("restSink",n.restSink)}}function ke(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div")(1,"app-log-sink",40),e.NdJ("logSinkChange",function(t){e.CHM(n);const i=e.oxw(2);return e.KtG(i.logSink=t)}),e.qZA()()}if(2&a){const n=e.oxw(2);e.xp6(1),e.Q6J("logSink",n.logSink)}}function Ue(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div",16)(1,"div",17),e.YNc(2,Ne,5,1,"span",0),e.YNc(3,Ae,4,0,"span",0),e.TgZ(4,"span",11),e.YNc(5,Re,2,1,"button",18),e.YNc(6,be,2,1,"button",18),e.TgZ(7,"button",19),e.NdJ("click",function(){e.CHM(n);const t=e.oxw();return e.KtG(t.cancel())}),e._uU(8,"Cancel"),e.qZA()()(),e.TgZ(9,"div",20)(10,"form",21)(11,"div",22)(12,"label",23),e.SDv(13,24),e.qZA(),e.TgZ(14,"div",25)(15,"select",26),e.NdJ("ngModelChange",function(t){e.CHM(n);const i=e.oxw();return e.KtG(i.selectedSinkType=t)}),e.TgZ(16,"option",27),e._uU(17),e.qZA(),e.TgZ(18,"option",27),e._uU(19),e.qZA(),e.TgZ(20,"option",27),e._uU(21),e.qZA(),e.TgZ(22,"option",27),e._uU(23),e.qZA()(),e.TgZ(24,"div",28)(25,"small"),e.SDv(26,29),e.qZA()()()()(),e.TgZ(27,"div",30),e.YNc(28,Ze,2,1,"div",31),e.YNc(29,Le,2,1,"div",31),e.YNc(30,Ie,2,1,"div",31),e.YNc(31,ke,2,1,"div",31),e.qZA()()()}if(2&a){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",n.sinkAddOrEditOperation===n.sinkOperation_ADD),e.xp6(1),e.Q6J("ngIf",n.sinkAddOrEditOperation===n.sinkOperation_EDIT),e.xp6(2),e.Q6J("ngIf",n.sinkAddOrEditOperation===n.sinkOperation_ADD),e.xp6(1),e.Q6J("ngIf",n.sinkAddOrEditOperation===n.sinkOperation_EDIT),e.xp6(9),e.ekj("is-invalid",!n.selectedSinkType),e.Q6J("ngModel",n.selectedSinkType),e.xp6(1),e.s9C("value",n.EdgeX_SINK),e.xp6(1),e.Oqu(n.EdgeX_SINK),e.xp6(1),e.s9C("value",n.MQTT_SINK),e.xp6(1),e.Oqu(n.MQTT_SINK),e.xp6(1),e.s9C("value",n.REST_SINK),e.xp6(1),e.Oqu(n.REST_SINK),e.xp6(1),e.s9C("value",n.LOG_SINK),e.xp6(1),e.Oqu(n.LOG_SINK),e.xp6(4),e.Q6J("ngSwitch",n.selectedSinkType),e.xp6(1),e.Q6J("ngSwitchCase",n.EdgeX_SINK),e.xp6(1),e.Q6J("ngSwitchCase",n.MQTT_SINK),e.xp6(1),e.Q6J("ngSwitchCase",n.REST_SINK),e.xp6(1),e.Q6J("ngSwitchCase",n.LOG_SINK)}}let I=(()=>{class a{get ruleActions(){return this._ruleActions}set ruleActions(n){n&&(this._ruleActions=n)}constructor(){this.EdgeX_SINK="edgex",this.MQTT_SINK="mqtt",this.REST_SINK="rest",this.LOG_SINK="log",this.NOP_SINK="nop",this.ruleActionsChange=new e.vpe,this.edgeXSink={},this.mqttSink={},this.restSink={},this.nopSink={},this.logSink={},this.selectedSinkIndex=-1,this.selectedSinkType="",this.sinkAddOrEditStatus=!1,this.sinkOperation_ADD="add",this.sinkOperation_EDIT="edit",this.sinkAddOrEditOperation="",this.updateTimestamp="",this._ruleActions=[]}ngOnInit(){}ngOnChanges(){this.ruleActionsChange.emit(this.ruleActions)}resetSinksConcreteAll(){this.edgeXSink={},this.mqttSink={},this.restSink={},this.nopSink={},this.logSink={}}getSinkTypeOfAction(n){let o=Object.keys(n);return 0===o.length?"":o[0]}getSinkByType(n){let o={};switch(n){case this.EdgeX_SINK:o.edgex=this.edgeXSink;break;case this.MQTT_SINK:o.mqtt=this.mqttSink;break;case this.REST_SINK:o.rest=this.restSink;break;case this.LOG_SINK:o.log=this.logSink;break;default:o.nop=this.nopSink}return o}sinkConcreteExtractor(n){let o=this.getSinkTypeOfAction(n);switch(this.selectedSinkType=o,o){case this.EdgeX_SINK:this.edgeXSink=n.edgex;break;case this.MQTT_SINK:this.mqttSink=n.mqtt;break;case this.REST_SINK:this.restSink=n.rest;break;case this.LOG_SINK:this.logSink=n.log;break;default:this.nopSink=n.nop}}addSinkTransfer(){this.sinkAddOrEditStatus=!0,this.sinkAddOrEditOperation=this.sinkOperation_ADD,this.selectedSinkIndex=-1,this.selectedSinkType="",this.resetSinksConcreteAll()}editSinkTransfer(n,o){this.sinkAddOrEditStatus=!0,this.sinkAddOrEditOperation=this.sinkOperation_EDIT,this.selectedSinkIndex=o,this.sinkConcreteExtractor(n),this.selectedSinkType=this.getSinkTypeOfAction(n)}addOneNewSink(){this.ruleActions.push(this.getSinkByType(this.selectedSinkType)),this.sinkAddOrEditStatus=!1}updateSink(){this.ruleActions.splice(this.selectedSinkIndex,1,this.getSinkByType(this.selectedSinkType)),this.sinkAddOrEditStatus=!1}deleteSink(n,o){this.ruleActions.splice(o,1),this.selectedSinkIndex=-1}cancel(){this.sinkAddOrEditStatus=!1}validate(){if(!this.selectedSinkType)return!1;switch(this.selectedSinkType){case this.MQTT_SINK:if(!this.mqttSink.server||!this.mqttSink.topic)return!1;break;case this.REST_SINK:if(!this.restSink.url)return!1}return!0}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-sink-list"]],inputs:{ruleActions:"ruleActions"},outputs:{ruleActionsChange:"ruleActionsChange"},features:[e.TTD],decls:2,vars:2,consts:function(){let n,o,t;return n="Add Sink",o="Sink Type",t="please select a valid Sink Type !",[[4,"ngIf"],["class","card",4,"ngIf"],[1,"badge","badge-secondary","font-weight-bold"],[3,"click"],[1,"fa","fa-plus-circle","mr-1"],["role","button",1,"user-select-none"],n,[1,"list-group"],["class","list-group-item list-group-item-action ",3,"list-group-item-light","list-group-item-secondary",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action"],[1,"text-dark","mr-2"],[1,"float-right"],["role","button",1,"badge","badge-info","mr-2",3,"click"],[1,"fa","fa-edit"],["role","button",1,"badge","badge-danger",3,"click"],[1,"fa","fa-trash"],[1,"card"],[1,"card-header","p-2"],["class","btn btn-success btn-sm mr-2",3,"disabled","click",4,"ngIf"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"card-body"],[1,"mb-2"],[1,"form-group","row"],[1,"col-sm-3","col-form-label","text-nowrap","text-truncate"],o,[1,"col-sm-9"],["name","SinkType",1,"custom-select",3,"ngModel","ngModelChange"],[3,"value"],["id","validationSinkTypeFeedback",1,"invalid-feedback"],t,[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"fa","fa-plus","mr-2","text-info"],[1,"font-weight-bold"],["class","font-weight-bold",4,"ngIf"],[1,"fa","fa-edit","mr-2","text-info"],[1,"btn","btn-success","btn-sm","mr-2",3,"disabled","click"],[3,"edgeXSink","edgeXSinkChange"],[3,"mqttSink","mqttSinkChange"],[3,"restSink","restSinkChange"],[3,"logSink","logSinkChange"]]},template:function(o,t){1&o&&(e.YNc(0,Me,8,1,"div",0),e.YNc(1,Ue,32,20,"div",1)),2&o&&(e.Q6J("ngIf",!t.sinkAddOrEditStatus),e.xp6(1),e.Q6J("ngIf",t.sinkAddOrEditStatus))},dependencies:[u.sg,u.O5,u.RF,u.n9,l._Y,l.YN,l.Kr,l.EJ,l.JJ,l.JL,l.On,l.F,ne,Te,Ee,he],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]})}return a})();function Pe(a,r){1&a&&e._UZ(0,"i",29)}function qe(a,r){1&a&&e._UZ(0,"i",30)}let k=(()=>{class a{get ruleOptions(){return this._ruleOptions}set ruleOptions(n){Object.assign(this._ruleOptions,n)}constructor(){this.collapseToggleStatus=!1,this.ruleOptionsChange=new e.vpe,this._ruleOptions={isEventTime:!1,sendMetaToSink:!1,sendError:!0,qos:0}}ngOnInit(){}ngOnChanges(){this.ruleOptionsChange.emit(this.ruleOptions)}collapseToggle(n){this.collapseToggleStatus=!this.collapseToggleStatus}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-rule-advanced-options"]],inputs:{ruleOptions:"ruleOptions"},outputs:{ruleOptionsChange:"ruleOptionsChange"},features:[e.TTD],decls:84,vars:19,consts:[[1,"card"],["role","button","data-toggle","collapse","data-target","#clllapse-rule-opts","aria-expanded","false","aria-controls","clllapse-rule-opts",1,"card-header",3,"click"],[1,"fa","fa-tags","text-primary","mr-2"],[1,"font-weight-bold","text-primary"],[1,"text-primary","ml-2"],["aria-disabled","true","class","fa fa-angle-double-down fa-lg","data-toggle","collapse","data-target","#clllapse-rule-opts","aria-expanded","false","aria-controls","clllapse-rule-opts",4,"ngIf"],["aria-disabled","true","class","fa fa-angle-double-up fa-lg","data-toggle","collapse","data-target","#clllapse-rule-opts","aria-expanded","false","aria-controls","clllapse-rule-opts",4,"ngIf"],["id","clllapse-rule-opts",1,"card-body","collapse"],[1,"form-group","row"],[1,"col-sm-3","col-form-label","text-nowrap","text-truncate"],[1,"mr-2"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Whether to use event time or processing time as the timestamp for an event. If event time is used, the timestamp will be extracted from the payload. The timestamp filed must be specified by the stream definition.",1,"fa","fa-question-circle-o","fa-lg"],[1,"col-sm-9"],["name","isEventTime",1,"custom-select",3,"ngModel","ngModelChange"],[3,"ngValue"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify the qos of the stream. The options are 0: At most once; 1: At least once and 2: Exactly once. If qos is bigger than 0, the checkpoint mechanism will be activated to save states periodically so that the rule can be resumed from errors.",1,"fa","fa-question-circle-o","fa-lg"],["name","SkipCertVerify",1,"custom-select",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","When working with event-time windowing, it can happen that elements arrive late. LateTolerance can specify by how much time(unit is millisecond) elements can be late before they are dropped. By default, the value is 0 which means late elements are dropped.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","lateTolerance",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","A rule is processed by several phases of plans according to the sql statement. This option will specify how many instances will be run for each plan. If the value is bigger than 1, the order of the messages may not be retained.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","concurrency",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify how many messages can be buffered in memory for each plan. If the buffered messages exceed the limit, the plan will block message receiving until the buffered messages have been sent out so that the buffered size is less than the limit. A bigger value will accommodate more throughput but will also take up more memory footprint.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","bufferLength",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify the time interval in milliseconds to trigger a checkpoint. This is only effective when qos is bigger than 0.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","checkpointInterval",1,"form-control",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Specify whether the meta data of an event will be sent to the sink. If true, the sink can get te meta data information.",1,"fa","fa-question-circle-o","fa-lg"],["name","sendMetaToSink",1,"custom-select",3,"ngModel","ngModelChange"],["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Whether to send the error to sink. If true, any runtime error will be sent through the whole rule into sinks. Otherwise, the error will only be printed out in the log.",1,"fa","fa-question-circle-o","fa-lg"],["name","sendError",1,"custom-select",3,"ngModel","ngModelChange"],["aria-disabled","true","data-toggle","collapse","data-target","#clllapse-rule-opts","aria-expanded","false","aria-controls","clllapse-rule-opts",1,"fa","fa-angle-double-down","fa-lg"],["aria-disabled","true","data-toggle","collapse","data-target","#clllapse-rule-opts","aria-expanded","false","aria-controls","clllapse-rule-opts",1,"fa","fa-angle-double-up","fa-lg"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(s){return t.collapseToggle(s)}),e._UZ(2,"i",2),e.TgZ(3,"span",3),e._uU(4,"Rule Advanced Options"),e.qZA(),e.TgZ(5,"span",4),e.YNc(6,Pe,1,0,"i",5),e.YNc(7,qe,1,0,"i",6),e.qZA()(),e.TgZ(8,"div",7)(9,"form")(10,"div",8)(11,"label",9)(12,"span",10),e._uU(13,"IsEventTime"),e.qZA(),e._UZ(14,"span",11),e.qZA(),e.TgZ(15,"div",12)(16,"select",13),e.NdJ("ngModelChange",function(s){return t.ruleOptions.isEventTime=s}),e.TgZ(17,"option",14),e._uU(18,"false"),e.qZA(),e.TgZ(19,"option",14),e._uU(20,"true"),e.qZA()()()(),e.TgZ(21,"div",8)(22,"label",9)(23,"span",10),e._uU(24,"Qos"),e.qZA(),e._UZ(25,"span",15),e.qZA(),e.TgZ(26,"div",12)(27,"select",16),e.NdJ("ngModelChange",function(s){return t.ruleOptions.qos=s}),e.TgZ(28,"option",14),e._uU(29,"0"),e.qZA(),e.TgZ(30,"option",14),e._uU(31,"1"),e.qZA(),e.TgZ(32,"option",14),e._uU(33,"2"),e.qZA()()()(),e.TgZ(34,"div",8)(35,"label",9)(36,"span",10),e._uU(37,"LateTolerance"),e.qZA(),e._UZ(38,"span",17),e.qZA(),e.TgZ(39,"div",12)(40,"input",18),e.NdJ("ngModelChange",function(s){return t.ruleOptions.lateTolerance=s}),e.qZA()()(),e.TgZ(41,"div",8)(42,"label",9)(43,"span",10),e._uU(44,"Concurrency"),e.qZA(),e._UZ(45,"span",19),e.qZA(),e.TgZ(46,"div",12)(47,"input",20),e.NdJ("ngModelChange",function(s){return t.ruleOptions.concurrency=s}),e.qZA()()(),e.TgZ(48,"div",8)(49,"label",9)(50,"span",10),e._uU(51,"BufferLength"),e.qZA(),e._UZ(52,"span",21),e.qZA(),e.TgZ(53,"div",12)(54,"input",22),e.NdJ("ngModelChange",function(s){return t.ruleOptions.bufferLength=s}),e.qZA()()(),e.TgZ(55,"div",8)(56,"label",9)(57,"span",10),e._uU(58,"CheckpointInterval"),e.qZA(),e._UZ(59,"span",23),e.qZA(),e.TgZ(60,"div",12)(61,"input",24),e.NdJ("ngModelChange",function(s){return t.ruleOptions.checkpointInterval=s}),e.qZA()()(),e.TgZ(62,"div",8)(63,"label",9)(64,"span",10),e._uU(65,"SendMetaToSink"),e.qZA(),e._UZ(66,"span",25),e.qZA(),e.TgZ(67,"div",12)(68,"select",26),e.NdJ("ngModelChange",function(s){return t.ruleOptions.sendMetaToSink=s}),e.TgZ(69,"option",14),e._uU(70,"false"),e.qZA(),e.TgZ(71,"option",14),e._uU(72,"true"),e.qZA()()()(),e.TgZ(73,"div",8)(74,"label",9)(75,"span",10),e._uU(76,"SendError"),e.qZA(),e._UZ(77,"span",27),e.qZA(),e.TgZ(78,"div",12)(79,"select",28),e.NdJ("ngModelChange",function(s){return t.ruleOptions.sendError=s}),e.TgZ(80,"option",14),e._uU(81,"false"),e.qZA(),e.TgZ(82,"option",14),e._uU(83,"true"),e.qZA()()()()()()()),2&o&&(e.xp6(6),e.Q6J("ngIf",!t.collapseToggleStatus),e.xp6(1),e.Q6J("ngIf",t.collapseToggleStatus),e.xp6(9),e.Q6J("ngModel",t.ruleOptions.isEventTime),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0),e.xp6(8),e.Q6J("ngModel",t.ruleOptions.qos),e.xp6(1),e.Q6J("ngValue",0),e.xp6(2),e.Q6J("ngValue",1),e.xp6(2),e.Q6J("ngValue",2),e.xp6(8),e.Q6J("ngModel",t.ruleOptions.lateTolerance),e.xp6(7),e.Q6J("ngModel",t.ruleOptions.concurrency),e.xp6(7),e.Q6J("ngModel",t.ruleOptions.bufferLength),e.xp6(7),e.Q6J("ngModel",t.ruleOptions.checkpointInterval),e.xp6(7),e.Q6J("ngModel",t.ruleOptions.sendMetaToSink),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0),e.xp6(8),e.Q6J("ngModel",t.ruleOptions.sendError),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0))},dependencies:[u.O5,l._Y,l.YN,l.Kr,l.Fj,l.wV,l.EJ,l.JJ,l.JL,l.On,l.F]})}return a})();function Oe(a,r){1&a&&(e.TgZ(0,"span",40),e._UZ(1,"i",41),e.TgZ(2,"span"),e.SDv(3,42),e.qZA()())}function ye(a,r){1&a&&(e.TgZ(0,"span",40),e._UZ(1,"i",41),e.TgZ(2,"span"),e.SDv(3,43),e.qZA()())}let xe=(()=>{class a{constructor(n,o,t,i){this.ruleSvc=n,this.msgSvc=o,this.router=t,this.route=i,this.ruleSql="",this.SQL_CUSTOM_KEYWORDS=["CONCAT","concat"],this.rule={}}ngOnInit(){this.sqlEditorRender(),$(function(){$('[data-toggle="tooltip"]').tooltip()}),this.renderPopoverComponent()}renderPopoverComponent(){$('[data-toggle="popover"]').popover({trigger:"hover"})}sqlEditorRender(){let n=document.getElementById("sql-editor");this.SQL_CUSTOM_KEYWORDS.forEach(o=>{CodeMirror.resolveMode("text/x-pgsql").keywords[o]=!0}),this.sqlEditor=CodeMirror.fromTextArea(n,{mode:"text/x-pgsql",tabSize:4,theme:"gruvbox-dark",lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],autofocus:!0,matchBrackets:!0,styleActiveLine:!0,cursorHeight:.85}),this.sqlEditor.setSize("auto","500px"),this.sqlEditor.on("drop",(o,t)=>{}),this.sqlEditor.on("paste",(o,t)=>{}),this.sqlEditor.on("keyup",(o,t)=>{t.keyCode>=65&&t.keyCode<=90&&o.showHint({completeSingle:!1})})}formatSql(){let n="";n=this.sqlEditor.getValue(),this.sqlEditor.setValue(sqlFormatter.format(n,{language:"postgresql"}))}validate(){return!(!this.rule.id||!this.sqlEditor.getValue()||!this.rule.actions||0===this.rule.actions.length)}submit(){this.rule.sql=this.sqlEditor.getValue(),this.ruleSvc.addRule(this.rule).subscribe(()=>{this.msgSvc.success("Add rule",`Name: ${this.rule.id}`),this.router.navigate(["../rules-list"],{relativeTo:this.route})})}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(h.n),e.Y36(C.e),e.Y36(g.F0),e.Y36(g.gz))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-rules"]],decls:59,vars:18,consts:function(){let n,o,t,i,s,_,f,p,c,m,T;return n="Add Rule",o="Submit",t="Name",i="the rule name can't be empty!",s="RuleSQL",_="SQL Editor",f="Action",p="Add Action",c="Options",m="SQL can't be empty!",T="at least one rule action required!",[[1,"card"],[1,"card-header"],[1,"fa","fa-plus","mr-1","text-danger"],[1,"font-weight-bold"],n,[1,"btn","btn-success","btn-sm","float-right",3,"disabled","click"],[1,"fa","fa-save","mr-1"],o,[1,"card-body","p-0"],[1,"px-5","py-4"],[1,"form-group","row","has-validation"],["for","ruleName",1,"col-md-2","col-form-label"],[1,"mr-2"],t,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","The identification of the rule. The rule name cannot be duplicated in the same Kuiper instance.",1,"fa","fa-question-circle-o","fa-lg"],[1,"col-md-10"],["type","text","id","ruleName","name","ruleId",1,"form-control",3,"ngModel","ngModelChange"],["id","ruleName",1,"invalid-feedback"],i,["for","ruleSql",1,"col-md-2","col-form-label"],s,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content",'The sql query to run for the rule.The Table name must be your stream name.For example "SELECT EdgexStream.temperature, EdgexStream.temp FROM EdgexStream where EdgexStream.temperature > EdgexStream.temp ".',1,"fa","fa-question-circle-o","fa-lg"],[1,"card-header","p-2"],[1,"fa","fa-code","text-info","mr-2","font-weight-bolder"],_,["class","text-danger float-right",4,"ngIf"],[1,"card-header","bg-secondary","py-2"],[1,"text-light"],["role","button","data-toggle","tooltip","data-placement","top","title","formatter",1,"fa","fa-indent","fa-lg","mr-3",3,"click"],["id","sql-editor","name","sql-editor"],["for","ruleActions",1,"col-md-2","col-form-label"],f,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","where the sql result data sent to",1,"fa","fa-question-circle-o","fa-lg"],[1,"fa","fa-plus","mr-2","text-info"],p,[1,"card-body"],[3,"ruleActions","ruleActionsChange"],c,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","Advanced Options",1,"fa","fa-question-circle-o","fa-lg"],[3,"ruleOptions","ruleOptionsChange"],[1,"text-danger","float-right"],[1,"fa","fa-warning","mr-2"],m,T]},template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span",3),e.SDv(4,4),e.qZA(),e.TgZ(5,"button",5),e.NdJ("click",function(){return t.submit()}),e._UZ(6,"i",6),e.TgZ(7,"span"),e.SDv(8,7),e.qZA()()(),e.TgZ(9,"div",8)(10,"form",9)(11,"div",10)(12,"label",11)(13,"span",12),e.SDv(14,13),e.qZA(),e._UZ(15,"span",14),e.qZA(),e.TgZ(16,"div",15)(17,"input",16),e.NdJ("ngModelChange",function(s){return t.rule.id=s}),e.qZA(),e.TgZ(18,"div",17)(19,"small"),e.SDv(20,18),e.qZA()()()(),e.TgZ(21,"div",10)(22,"label",19)(23,"span",12),e.SDv(24,20),e.qZA(),e._UZ(25,"span",21),e.qZA(),e.TgZ(26,"div",15)(27,"div",0)(28,"div",22),e._UZ(29,"i",23),e.TgZ(30,"span",3),e.SDv(31,24),e.qZA(),e.YNc(32,Oe,4,0,"span",25),e.qZA(),e.TgZ(33,"div",26)(34,"span",27)(35,"i",28),e.NdJ("click",function(){return t.formatSql()}),e.qZA()()(),e.TgZ(36,"div",8),e._UZ(37,"textarea",29),e.qZA()()()(),e.TgZ(38,"div",10)(39,"label",30)(40,"span",12),e.SDv(41,31),e.qZA(),e._UZ(42,"span",32),e.qZA(),e.TgZ(43,"div",15)(44,"div",0)(45,"div",1),e._UZ(46,"i",33),e.TgZ(47,"span",3),e.SDv(48,34),e.qZA(),e.YNc(49,ye,4,0,"span",25),e.qZA(),e.TgZ(50,"div",35)(51,"app-sink-list",36),e.NdJ("ruleActionsChange",function(s){return t.rule.actions=s}),e.qZA()()()()(),e.TgZ(52,"div",10)(53,"label",19)(54,"span",12),e.SDv(55,37),e.qZA(),e._UZ(56,"span",38),e.qZA(),e.TgZ(57,"div",15)(58,"app-rule-advanced-options",39),e.NdJ("ruleOptionsChange",function(s){return t.rule.options=s}),e.qZA()()()()()()),2&o&&(e.xp6(5),e.Q6J("disabled",!t.validate()),e.xp6(12),e.ekj("is-invalid",!t.rule.id)("is-valid",t.rule.id),e.Q6J("ngModel",t.rule.id),e.xp6(11),e.ekj("border",!t.sqlEditor.getValue())("border-danger",!t.sqlEditor.getValue()),e.xp6(4),e.Q6J("ngIf",!t.sqlEditor.getValue()),e.xp6(13),e.ekj("border",!t.rule.actions||0===t.rule.actions.length)("border-danger",!t.rule.actions||0===t.rule.actions.length),e.xp6(4),e.Q6J("ngIf",!t.rule.actions||0===t.rule.actions.length),e.xp6(2),e.Q6J("ruleActions",t.rule.actions),e.xp6(7),e.Q6J("ruleOptions",t.rule.options))},dependencies:[u.O5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F,I,k],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]})}return a})();function $e(a,r){1&a&&(e.TgZ(0,"span",40),e._UZ(1,"i",41),e.TgZ(2,"span"),e._uU(3,"SQL can't be empty!"),e.qZA()())}function De(a,r){1&a&&(e.TgZ(0,"span",40),e._UZ(1,"i",41),e.TgZ(2,"span"),e.SDv(3,42),e.qZA()())}let Je=(()=>{class a{constructor(n,o,t,i){this.ruleSvc=n,this.msgSvc=o,this.router=t,this.route=i,this.ruleSql="",this.SQL_CUSTOM_KEYWORDS=["CONCAT","concat"],this.rule={}}ngOnInit(){this.route.queryParams.subscribe(n=>{n.ruleID&&this.getRuleByID(n.ruleID)}),this.sqlEditorRender(),$(function(){$('[data-toggle="tooltip"]').tooltip()}),this.renderPopoverComponent()}getRuleByID(n){this.ruleSvc.findRuleById(n).subscribe(o=>{this.rule=o,this.sqlEditor.setValue(this.rule.sql)})}renderPopoverComponent(){$('[data-toggle="popover"]').popover({trigger:"hover"})}sqlEditorRender(){let n=document.getElementById("sql-editor");this.SQL_CUSTOM_KEYWORDS.forEach(o=>{CodeMirror.resolveMode("text/x-pgsql").keywords[o]=!0}),this.sqlEditor=CodeMirror.fromTextArea(n,{mode:"text/x-pgsql",tabSize:4,theme:"gruvbox-dark",lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],autofocus:!0,matchBrackets:!0,styleActiveLine:!0,cursorHeight:.85}),this.sqlEditor.setSize("auto","500px"),this.sqlEditor.on("drop",(o,t)=>{}),this.sqlEditor.on("paste",(o,t)=>{}),this.sqlEditor.on("keyup",(o,t)=>{t.keyCode>=65&&t.keyCode<=90&&o.showHint({completeSingle:!1})})}formatSql(){let n="";n=this.sqlEditor.getValue(),this.sqlEditor.setValue(sqlFormatter.format(n,{language:"postgresql"}))}validate(){return!(!this.rule.id||!this.sqlEditor.getValue()||!this.rule.actions||0===this.rule.actions.length)}update(){this.rule.sql=this.sqlEditor.getValue(),this.ruleSvc.updateRule(this.rule).subscribe(()=>{this.msgSvc.success("update",`name: ${this.rule.id}`),this.router.navigate(["../rules-list"],{relativeTo:this.route})})}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(h.n),e.Y36(C.e),e.Y36(g.F0),e.Y36(g.gz))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-edit-rules"]],decls:59,vars:18,consts:function(){let n,o,t,i,s,_,f,p,c,m;return n="Edit Rule",o="Update",t="Name",i="the rule name can't be empty!",s="RuleSQL",_="SQL Editor",f="Action",p="Add Action",c="Options",m="at least one rule action required!",[[1,"card"],[1,"card-header"],[1,"fa","fa-plus","mr-1","text-danger"],[1,"font-weight-bold"],n,[1,"btn","btn-success","btn-sm","float-right",3,"disabled","click"],[1,"fa","fa-save","mr-1"],o,[1,"card-body","p-0"],[1,"px-5","py-4"],[1,"form-group","row","has-validation"],["for","ruleName",1,"col-md-2","col-form-label"],[1,"mr-2"],t,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","The identification of the rule. The rule name cannot be duplicated in the same Kuiper instance.",1,"fa","fa-question-circle-o","fa-lg"],[1,"col-md-10"],["type","text","id","ruleName","name","ruleId",1,"form-control",3,"ngModel","ngModelChange"],["id","ruleName",1,"invalid-feedback"],i,["for","ruleSql",1,"col-md-2","col-form-label"],s,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content",'The sql query to run for the rule.The Table name must be your stream name.For example "SELECT EdgexStream.temperature, EdgexStream.temp FROM EdgexStream where EdgexStream.temperature > EdgexStream.temp ".',1,"fa","fa-question-circle-o","fa-lg"],[1,"card-header","p-2"],[1,"fa","fa-code","text-info","mr-2","font-weight-bolder"],_,["class","text-danger float-right",4,"ngIf"],[1,"card-header","bg-secondary","py-2"],[1,"text-light"],["role","button","data-toggle","tooltip","data-placement","top","title","formatter",1,"fa","fa-indent","fa-lg","mr-3",3,"click"],["id","sql-editor","name","sql-editor"],["for","ruleActions",1,"col-md-2","col-form-label"],f,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","where the sql result data sent to",1,"fa","fa-question-circle-o","fa-lg"],[1,"fa","fa-plus","mr-2","text-info"],p,[1,"card-body"],[3,"ruleActions","ruleActionsChange"],c,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","Advanced Options",1,"fa","fa-question-circle-o","fa-lg"],[3,"ruleOptions","ruleOptionsChange"],[1,"text-danger","float-right"],[1,"fa","fa-warning","mr-2"],m]},template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span",3),e.SDv(4,4),e.qZA(),e.TgZ(5,"button",5),e.NdJ("click",function(){return t.update()}),e._UZ(6,"i",6),e.TgZ(7,"span"),e.SDv(8,7),e.qZA()()(),e.TgZ(9,"div",8)(10,"form",9)(11,"div",10)(12,"label",11)(13,"span",12),e.SDv(14,13),e.qZA(),e._UZ(15,"span",14),e.qZA(),e.TgZ(16,"div",15)(17,"input",16),e.NdJ("ngModelChange",function(s){return t.rule.id=s}),e.qZA(),e.TgZ(18,"div",17)(19,"small"),e.SDv(20,18),e.qZA()()()(),e.TgZ(21,"div",10)(22,"label",19)(23,"span",12),e.SDv(24,20),e.qZA(),e._UZ(25,"span",21),e.qZA(),e.TgZ(26,"div",15)(27,"div",0)(28,"div",22),e._UZ(29,"i",23),e.TgZ(30,"span",3),e.SDv(31,24),e.qZA(),e.YNc(32,$e,4,0,"span",25),e.qZA(),e.TgZ(33,"div",26)(34,"span",27)(35,"i",28),e.NdJ("click",function(){return t.formatSql()}),e.qZA()()(),e.TgZ(36,"div",8),e._UZ(37,"textarea",29),e.qZA()()()(),e.TgZ(38,"div",10)(39,"label",30)(40,"span",12),e.SDv(41,31),e.qZA(),e._UZ(42,"span",32),e.qZA(),e.TgZ(43,"div",15)(44,"div",0)(45,"div",1),e._UZ(46,"i",33),e.TgZ(47,"span",3),e.SDv(48,34),e.qZA(),e.YNc(49,De,4,0,"span",25),e.qZA(),e.TgZ(50,"div",35)(51,"app-sink-list",36),e.NdJ("ruleActionsChange",function(s){return t.rule.actions=s}),e.qZA()()()()(),e.TgZ(52,"div",10)(53,"label",19)(54,"span",12),e.SDv(55,37),e.qZA(),e._UZ(56,"span",38),e.qZA(),e.TgZ(57,"div",15)(58,"app-rule-advanced-options",39),e.NdJ("ruleOptionsChange",function(s){return t.rule.options=s}),e.qZA()()()()()()),2&o&&(e.xp6(5),e.Q6J("disabled",!t.validate()),e.xp6(12),e.ekj("is-invalid",!t.rule.id)("is-valid",t.rule.id),e.Q6J("ngModel",t.rule.id),e.xp6(11),e.ekj("border",!t.sqlEditor.getValue())("border-danger",!t.sqlEditor.getValue()),e.xp6(4),e.Q6J("ngIf",!t.sqlEditor.getValue()),e.xp6(13),e.ekj("border",!t.rule.actions||0===t.rule.actions.length)("border-danger",!t.rule.actions||0===t.rule.actions.length),e.xp6(4),e.Q6J("ngIf",!t.rule.actions||0===t.rule.actions.length),e.xp6(2),e.Q6J("ruleActions",t.rule.actions),e.xp6(7),e.Q6J("ruleOptions",t.rule.options))},dependencies:[u.O5,l._Y,l.Fj,l.JJ,l.JL,l.On,l.F,I,k]})}return a})(),Ge=(()=>{class a{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-rules-center"]],decls:1,vars:0,template:function(o,t){1&o&&e._UZ(0,"router-outlet")},dependencies:[g.lC]})}return a})();function we(a,r){1&a&&(e.TgZ(0,"span")(1,"div",50)(2,"span",51),e._uU(3,"Loading..."),e.qZA()()())}function Xe(a,r){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&a){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ",n.status," ")}}function Qe(a,r){1&a&&(e.TgZ(0,"span")(1,"div",52)(2,"span",51),e._uU(3,"Loading..."),e.qZA()(),e.TgZ(4,"div",53)(5,"span",51),e._uU(6,"Loading..."),e.qZA()(),e.TgZ(7,"div",54)(8,"span",51),e._uU(9,"Loading..."),e.qZA()()())}function Ke(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"span")(1,"span",55),e.NdJ("click",function(){e.CHM(n);const t=e.oxw().$implicit,i=e.oxw();return e.KtG(i.execute(t.id,"start"))}),e.SDv(2,56),e.qZA(),e.TgZ(3,"span",57),e.NdJ("click",function(){e.CHM(n);const t=e.oxw().$implicit,i=e.oxw();return e.KtG(i.execute(t.id,"restart"))}),e.SDv(4,58),e.qZA(),e.TgZ(5,"span",59),e.NdJ("click",function(){e.CHM(n);const t=e.oxw().$implicit,i=e.oxw();return e.KtG(i.execute(t.id,"stop"))}),e.SDv(6,60),e.qZA()()}}function Fe(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"input",24),e.NdJ("click",function(t){const s=e.CHM(n).$implicit,_=e.oxw();return e.KtG(_.selectOne(t,s))}),e.qZA()(),e.TgZ(3,"td",46),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.YNc(6,we,4,0,"span",47),e.YNc(7,Xe,2,1,"span",47),e.qZA(),e.TgZ(8,"td",48)(9,"i",49),e.NdJ("click",function(){const i=e.CHM(n).$implicit,s=e.oxw();return e.KtG(s.statusMetrics(i.id))}),e.qZA()(),e.TgZ(10,"td"),e.YNc(11,Qe,10,0,"span",47),e.YNc(12,Ke,7,0,"span",47),e.qZA()()}if(2&a){const n=r.$implicit,o=e.oxw();e.ekj("table-active",o.isChecked(n.id)),e.xp6(2),e.Q6J("checked",o.isChecked(n.id)),e.xp6(2),e.Oqu(n.id),e.xp6(2),e.Q6J("ngIf",o.operationStatus),e.xp6(1),e.Q6J("ngIf",!o.operationStatus),e.xp6(2),e.ekj("text-info",o.statusMetricsRuleID===n.id),e.xp6(2),e.Q6J("ngIf",o.operationStatus),e.xp6(1),e.Q6J("ngIf",!o.operationStatus)}}function Ve(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"div",61)(1,"div",1),e._UZ(2,"i",62),e.TgZ(3,"span",63),e._uU(4),e.qZA(),e.TgZ(5,"span"),e.SDv(6,64),e.qZA(),e.TgZ(7,"span",65),e.NdJ("click",function(){e.CHM(n);const t=e.oxw();return e.KtG(t.statusMetricsRefresh(t.statusMetricsRuleID))}),e._UZ(8,"i",8),e.TgZ(9,"span"),e.SDv(10,66),e.qZA()(),e.TgZ(11,"span",67)(12,"i",68),e.NdJ("click",function(){e.CHM(n);const t=e.oxw();return e.KtG(t.statusMetricsShowClose())}),e.qZA()()(),e.TgZ(13,"div",69)(14,"pre",70),e._uU(15),e.qZA()()()}if(2&a){const n=e.oxw();e.xp6(4),e.Oqu(n.statusMetricsRuleID),e.xp6(11),e.Oqu(n.ruleStatusMetrics)}}let Be=(()=>{class a{constructor(n,o,t,i){this.ruleSvc=n,this.msgSvc=o,this.route=t,this.router=i,this.rulesList=[],this.selectedRules=[],this.ruleStatusMetrics="",this.statusMetricsRuleID="",this.operationStatus=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{this.getRulesList()})}getRulesList(){this.ruleSvc.allRules().subscribe(n=>{this.rulesList=n})}refresh(){this.ruleSvc.allRules().subscribe(n=>{this.rulesList=n,this.msgSvc.success("refresh")})}edit(){this.router.navigate(["../edit-rules"],{relativeTo:this.route,queryParams:{ruleID:this.selectedRules[0].id}})}statusMetrics(n){this.statusMetricsRuleID="",this.ruleStatusMetrics="",this.ruleSvc.getRuleStatusMetricsById(n).subscribe(o=>{let t;this.statusMetricsRuleID=n;try{t=JSON.parse(o)}catch{return void(this.ruleStatusMetrics=o)}this.ruleStatusMetrics=JSON.stringify(t,null,3)})}statusMetricsShowClose(){this.statusMetricsRuleID="",this.ruleStatusMetrics=""}statusMetricsRefresh(n){this.statusMetrics(n)}deleteConfirm(){$("#deleteConfirmDialog").modal("show")}delete(){this.selectedRules.forEach((n,o)=>{this.ruleSvc.deleteOneRuleById(n.id).subscribe(()=>{this.selectedRules.splice(o,1),this.rulesList.forEach((t,i)=>{t.id===n.id&&(this.rulesList.splice(i,1),this.msgSvc.success("remove rule ",` Id: ${n.id}`))})})}),$("#deleteConfirmDialog").modal("hide")}isCheckedAll(){let n=!0;return this.rulesList&&0===this.rulesList.length&&(n=!1),this.rulesList.forEach(o=>{-1===this.selectedRules.findIndex(t=>t.id===o.id)&&(n=!1)}),n}selectAll(n){this.rulesList.forEach(n.target.checked?t=>{-1===this.selectedRules.findIndex(i=>i.id===t.id)&&this.selectedRules.push(t)}:t=>{let i=this.selectedRules.findIndex(s=>s.id===t.id);-1!==i&&this.selectedRules.splice(i,1)})}isChecked(n){return this.selectedRules.findIndex(o=>o.id===n)>=0}selectOne(n,o){if(n.target.checked)return void this.selectedRules.push(o);let i=this.selectedRules.findIndex(s=>s.id===o.id);-1!==i&&this.selectedRules.splice(i,1)}execute(n,o){this.operationStatus=!0,this.ruleSvc.executeRuleCommand(n,o).subscribe({next:()=>{this.operationStatus=!1,this.msgSvc.success(`${o} ${n}`),this.getRulesList()},error:()=>this.operationStatus=!1})}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(h.n),e.Y36(C.e),e.Y36(g.gz),e.Y36(g.F0))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-rules-list"]],decls:56,vars:5,consts:function(){let n,o,t,i,s,_,f,p,c,m,T,E,P,q,O,y,x,D;return n="Rule List",o="Refresh",t="Add",i="Edit",s="Delete",_="ID",f="Status",p="Status Metrics",c="Operaion",m="Warning",T=" The data will be permanently erased!!! Are you sure to execute delete operation\uFF1F ",E="Cancel",P="Confirm",q="start",O="restart",y="stop",x="Status Metrics",D="refresh",[[1,"card"],[1,"card-header"],[1,"fa","fa-list","text-danger","mr-2"],[1,"font-weight-bold"],n,[1,"card-header","p-2"],["role","group",1,"btn-group","btn-group-sm"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-refresh","mr-1"],o,["type","button","routerLink","../add-rules",1,"btn","btn-info"],[1,"fa","fa-plus","mr-1"],t,["type","button",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-edit","mr-1"],i,["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash","mr-1"],s,[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],["type","checkbox","role","button",3,"checked","click"],_,f,["scope","col",1,"text-center"],p,c,[3,"table-active",4,"ngFor","ngForOf"],["class","card mt-3",4,"ngIf"],["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],m,[1,"modal-body"],T,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],E,["type","button",1,"btn","btn-danger",3,"click"],P,[1,"user-select-all"],[4,"ngIf"],[1,"text-center"],["role","button",1,"fa","fa-line-chart","text-primary",3,"click"],["role","status",1,"spinner-border","spinner-border-sm","text-secondary"],[1,"sr-only"],["role","status",1,"spinner-border","spinner-border-sm","mr-1","text-success"],["role","status",1,"spinner-border","spinner-border-sm","mr-1","text-info"],["role","status",1,"spinner-border","spinner-border-sm","mr-1","text-danger"],["role","button",1,"badge","badge-success","mr-1",3,"click"],q,["role","button",1,"badge","badge-info","mr-1",3,"click"],O,["role","button",1,"badge","badge-danger","mr-1",3,"click"],y,[1,"card","mt-3"],[1,"fa","fa-line-chart","mr-2","text-info"],[1,"mr-2","font-weight-bold"],x,["role","button",1,"badge","badge-primary","mx-2",3,"click"],D,["role","button",1,"align-bottom"],[1,"fa","fa-window-close","fa-lg","text-danger","float-right","mt-1",3,"click"],[1,"card-body"],[1,"p-2"]]},template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span",3),e.SDv(4,4),e.qZA()(),e.TgZ(5,"div",5)(6,"div",6)(7,"button",7),e.NdJ("click",function(){return t.refresh()}),e._UZ(8,"i",8),e.TgZ(9,"span"),e.SDv(10,9),e.qZA()(),e.TgZ(11,"button",10),e._UZ(12,"i",11),e.TgZ(13,"span"),e.SDv(14,12),e.qZA()(),e.TgZ(15,"button",13),e.NdJ("click",function(){return t.edit()}),e._UZ(16,"i",14),e.TgZ(17,"span"),e.SDv(18,15),e.qZA()(),e.TgZ(19,"button",16),e.NdJ("click",function(){return t.deleteConfirm()}),e._UZ(20,"i",17),e.TgZ(21,"span"),e.SDv(22,18),e.qZA()()()(),e.TgZ(23,"div",19)(24,"div",20)(25,"table",21)(26,"thead",22)(27,"tr")(28,"th",23)(29,"input",24),e.NdJ("click",function(s){return t.selectAll(s)}),e.qZA()(),e.TgZ(30,"th",23),e.SDv(31,25),e.qZA(),e.TgZ(32,"th",23),e.SDv(33,26),e.qZA(),e.TgZ(34,"th",27),e.SDv(35,28),e.qZA(),e.TgZ(36,"th",23),e.SDv(37,29),e.qZA()()(),e.TgZ(38,"tbody"),e.YNc(39,Fe,13,10,"tr",30),e.qZA()()()()(),e.YNc(40,Ve,16,2,"div",31),e.TgZ(41,"div",32)(42,"div",33)(43,"div",34)(44,"div",35)(45,"h5",36),e._UZ(46,"i",37),e.TgZ(47,"span"),e.SDv(48,38),e.qZA()()(),e.TgZ(49,"div",39),e.SDv(50,40),e.qZA(),e.TgZ(51,"div",41)(52,"button",42),e.SDv(53,43),e.qZA(),e.TgZ(54,"button",44),e.NdJ("click",function(){return t.delete()}),e.SDv(55,45),e.qZA()()()()()),2&o&&(e.xp6(15),e.Q6J("disabled",1!==t.selectedRules.length),e.xp6(4),e.Q6J("disabled",0===t.selectedRules.length),e.xp6(10),e.Q6J("checked",t.isCheckedAll()),e.xp6(10),e.Q6J("ngForOf",t.rulesList),e.xp6(1),e.Q6J("ngIf",t.ruleStatusMetrics&&t.statusMetricsRuleID))},dependencies:[u.sg,u.O5,g.rH],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]})}return a})();function Ye(a,r){1&a&&(e.TgZ(0,"div",18),e._UZ(1,"i",19),e.TgZ(2,"span"),e.SDv(3,20),e.qZA()())}let ze=(()=>{class a{constructor(n,o,t,i){this.ruleSvc=n,this.msgSvc=o,this.router=t,this.route=i,this.EDGEX="edgex",this.CUSTOM="custom",this.SQL_CUSTOM_KEYWORDS=["STREAM","stream"],this.templateTypeSelected=this.EDGEX,this.edgexStreamDataTemplate='CREATE STREAM EdgeXStream () WITH ( FORMAT = "JSON", TYPE = "edgex" )',this.customStreamDataTemplate='CREATE STREAM demo ( field1 bigint, field2 float ) WITH ( DATASOURCE = "", KEY = "", FORMAT = "JSON", CONF_KEY = "", TYPE = "edgex", STRICT_VALIDATION = "true", TIMESTAMP = "", TIMESTAMP_FORMAT = "", RETAIN_SIZE = "0", SHARED = "false" )',this.streamIsNullMsg=!1}ngOnInit(){this.sqlEditorRender(),$(function(){$('[data-toggle="tooltip"]').tooltip()})}templateTypeToggle(n){this.templateTypeSelected=n,n===this.EDGEX?this.sqlEditor.setValue(this.edgexStreamDataTemplate):(this.sqlEditor.setValue(this.customStreamDataTemplate),this.formatSql())}sqlEditorRender(){let n=document.getElementById("sql-editor");this.SQL_CUSTOM_KEYWORDS.forEach(o=>{CodeMirror.resolveMode("text/x-pgsql").keywords[o]=!0}),this.sqlEditor=CodeMirror.fromTextArea(n,{mode:"text/x-pgsql",tabSize:4,theme:"gruvbox-dark",lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],autofocus:!0,matchBrackets:!0,styleActiveLine:!0,cursorHeight:.85,hint:CodeMirror.hint.sql}),this.sqlEditor.setSize("auto","500px"),this.sqlEditor.on("drop",(o,t)=>{}),this.sqlEditor.on("paste",(o,t)=>{}),this.sqlEditor.on("keyup",(o,t)=>{t.keyCode>=65&&t.keyCode<=90&&o.showHint({completeSingle:!1})}),this.sqlEditor.setValue(this.edgexStreamDataTemplate)}formatSql(){let n="";n=this.sqlEditor.getValue(),this.sqlEditor.setValue(sqlFormatter.format(n,{language:"postgresql"}))}documentShow(){$("#stream-document").modal("show")}submit(){let n=this.sqlEditor.getValue();if(!n.trim())return this.streamIsNullMsg=!0,void window.setTimeout(()=>{this.streamIsNullMsg=!1},2e3);this.ruleSvc.addStream(JSON.stringify({sql:n})).subscribe(()=>{this.msgSvc.success("Add Stream"),this.router.navigate(["../stream-list"],{relativeTo:this.route})})}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(h.n),e.Y36(C.e),e.Y36(g.F0),e.Y36(g.gz))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-stream"]],decls:25,vars:9,consts:function(){let n,o,t;return n="Add Stream",o="Submit",t="Stream can't be empty!",[["class","alert alert-warning","role","alert",4,"ngIf"],[1,"card"],[1,"card-header","p-2"],[1,""],[1,"text-danger","font-weight-bold","fa","fa-code","mr-2"],[1,"mr-3","font-weight-bold"],n,["type","button",1,"btn","btn-success","btn-sm","float-right",3,"click"],[1,"fa","fa-save","mr-1"],o,[1,"card-header"],["role","button",1,"badge","badge-secondary","mr-2",3,"click"],[1,"fa","fa-square-o","mr-1"],[1,"card-body","p-0"],[1,"card-header","bg-secondary","py-2"],[1,"text-light"],["role","button","data-toggle","tooltip","data-placement","top","title","formatter",1,"fa","fa-indent","fa-lg","mr-3",3,"click"],["id","sql-editor","name","sql-editor"],["role","alert",1,"alert","alert-warning"],[1,"fa","fa-warning","mr-2"],t]},template:function(o,t){1&o&&(e.YNc(0,Ye,4,0,"div",0),e.TgZ(1,"div",1)(2,"div",2)(3,"span",3),e._UZ(4,"span",4),e.TgZ(5,"span",5),e.SDv(6,6),e.qZA()(),e.TgZ(7,"button",7),e.NdJ("click",function(){return t.submit()}),e._UZ(8,"i",8),e.TgZ(9,"span"),e.SDv(10,9),e.qZA()()(),e.TgZ(11,"div",10)(12,"span",11),e.NdJ("click",function(){return t.templateTypeToggle(t.EDGEX)}),e._UZ(13,"i",12),e.TgZ(14,"span"),e._uU(15,"EdgeXStreamTemplate"),e.qZA()(),e.TgZ(16,"span",11),e.NdJ("click",function(){return t.templateTypeToggle(t.CUSTOM)}),e._UZ(17,"i",12),e.TgZ(18,"span"),e._uU(19,"CustomStreamTemplate"),e.qZA()()(),e.TgZ(20,"div",13)(21,"div",14)(22,"span",15)(23,"i",16),e.NdJ("click",function(){return t.formatSql()}),e.qZA()()(),e._UZ(24,"textarea",17),e.qZA()()),2&o&&(e.Q6J("ngIf",t.streamIsNullMsg),e.xp6(12),e.ekj("badge-info",t.templateTypeSelected===t.EDGEX),e.xp6(1),e.ekj("fa-check-square",t.templateTypeSelected===t.EDGEX),e.xp6(3),e.ekj("badge-info",t.templateTypeSelected===t.CUSTOM),e.xp6(1),e.ekj("fa-check-square",t.templateTypeSelected===t.CUSTOM))},dependencies:[u.O5],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]})}return a})();function He(a,r){1&a&&(e.TgZ(0,"div",16),e._UZ(1,"i",17),e.TgZ(2,"span"),e.SDv(3,18),e.qZA()())}let je=(()=>{class a{constructor(n,o,t,i){this.ruleSvc=n,this.msgSvc=o,this.router=t,this.route=i,this.SQL_CUSTOM_KEYWORDS=["STREAM","stream"],this.streamName="",this.streamStringFormatObj="",this.streamIsNullMsg=!1}ngOnInit(){this.route.queryParams.subscribe(n=>{n.streamName&&(this.streamName=n.streamName,this.getStreamByNameOrID())}),this.sqlEditorRender(),$(function(){$('[data-toggle="tooltip"]').tooltip()})}getStreamByNameOrID(){this.ruleSvc.findStreamByName(this.streamName).subscribe(n=>{this.streamJSONFormatObj=n,this.dataFormatJSONToStringConvertor(),this.sqlEditor.setValue(this.streamStringFormatObj),this.formatSql()})}dataFormatJSONToStringConvertor(){if(!this.streamJSONFormatObj)return;let n=[];this.streamJSONFormatObj?.StreamFields?.forEach((t,i)=>{n.push(`${t.Name} ${t.FieldType}`)});let o=[];for(const[t,i]of Object.entries(this.streamJSONFormatObj.Options))o.push(`${t} = "${i}"`);this.streamStringFormatObj=`CREATE STREAM ${this.streamJSONFormatObj?.Name} ( ${n.join(", ")} ) WITH ( ${o.join(", ")} )`}sqlEditorRender(){let n=document.getElementById("sql-editor");this.SQL_CUSTOM_KEYWORDS.forEach(o=>{CodeMirror.resolveMode("text/x-pgsql").keywords[o]=!0}),this.sqlEditor=CodeMirror.fromTextArea(n,{mode:"text/x-pgsql",tabSize:4,theme:"gruvbox-dark",lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],autofocus:!0,matchBrackets:!0,styleActiveLine:!0,cursorHeight:.85,hint:CodeMirror.hint.sql}),this.sqlEditor.setSize("auto","500px"),this.sqlEditor.on("drop",(o,t)=>{}),this.sqlEditor.on("paste",(o,t)=>{}),this.sqlEditor.on("keyup",(o,t)=>{t.keyCode>=65&&t.keyCode<=90&&o.showHint({completeSingle:!1})})}formatSql(){let n="";n=this.sqlEditor.getValue(),this.sqlEditor.setValue(sqlFormatter.format(n,{language:"postgresql"}))}submit(){let n=this.sqlEditor.getValue();if(!n.trim())return this.streamIsNullMsg=!0,void window.setTimeout(()=>{this.streamIsNullMsg=!1},2e3);this.ruleSvc.updateStream(JSON.stringify({sql:n}),this.streamName).subscribe(()=>{this.msgSvc.success("Update Stream"),this.router.navigate(["../stream-list"],{relativeTo:this.route})})}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(h.n),e.Y36(C.e),e.Y36(g.F0),e.Y36(g.gz))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-edit-stream"]],decls:19,vars:3,consts:function(){let n,o,t;return n="Edit Stream",o="Submit",t="Stream can't be empty!",[["class","alert alert-warning","role","alert",4,"ngIf"],[1,"card"],[1,"card-header","p-2"],[1,"text-danger","font-weight-bold","fa","fa-code","mr-2"],[1,"mr-2"],n,[1,"font-weight-bold"],[1,"float-right"],["type","button",1,"btn","btn-success","btn-sm",3,"disabled","click"],[1,"fa","fa-save","mr-1"],o,[1,"card-body","p-0"],[1,"card-header","bg-secondary","py-2"],[1,"text-light"],["role","button","data-toggle","tooltip","data-placement","top","title","formatter",1,"fa","fa-indent","fa-lg","mr-3",3,"click"],["id","sql-editor","name","sql-editor"],["role","alert",1,"alert","alert-warning"],[1,"fa","fa-warning","mr-2"],t]},template:function(o,t){1&o&&(e.YNc(0,He,4,0,"div",0),e.TgZ(1,"div",1)(2,"div",2)(3,"span"),e._UZ(4,"span",3),e.TgZ(5,"span",4),e.SDv(6,5),e.qZA(),e.TgZ(7,"span",6),e._uU(8),e.qZA()(),e.TgZ(9,"span",7)(10,"button",8),e.NdJ("click",function(){return t.submit()}),e._UZ(11,"i",9),e.TgZ(12,"span"),e.SDv(13,10),e.qZA()()()(),e.TgZ(14,"div",11)(15,"div",12)(16,"span",13)(17,"i",14),e.NdJ("click",function(){return t.formatSql()}),e.qZA()()(),e._UZ(18,"textarea",15),e.qZA()()),2&o&&(e.Q6J("ngIf",t.streamIsNullMsg),e.xp6(8),e.Oqu(t.streamName),e.xp6(2),e.Q6J("disabled",!t.streamStringFormatObj))},dependencies:[u.O5],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]})}return a})(),We=(()=>{class a{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-stream-center"]],decls:1,vars:0,template:function(o,t){1&o&&e._UZ(0,"router-outlet")},dependencies:[g.lC]})}return a})();function et(a,r){if(1&a){const n=e.EpF();e.TgZ(0,"li",29)(1,"div",30)(2,"div",31),e._UZ(3,"i",32),e.qZA(),e.TgZ(4,"div",33)(5,"div",34)(6,"h5",35),e._uU(7),e.qZA()(),e.TgZ(8,"div")(9,"span",36)(10,"span",37),e.NdJ("click",function(){const i=e.CHM(n).$implicit,s=e.oxw();return e.KtG(s.edit(i))}),e._UZ(11,"i",38),e.TgZ(12,"span"),e.SDv(13,39),e.qZA()(),e.TgZ(14,"span",40),e.NdJ("click",function(){const i=e.CHM(n).$implicit,s=e.oxw();return e.KtG(s.deleteConfirm(i))}),e._UZ(15,"i",41),e.TgZ(16,"span"),e.SDv(17,42),e.qZA()()()()()()()}if(2&a){const n=r.$implicit;e.xp6(7),e.Oqu(n)}}let tt=(()=>{class a{constructor(n,o,t,i){this.ruleSvc=n,this.msgSvc=o,this.route=t,this.router=i,this.streamList=[],this.selectedStream=""}ngOnInit(){this.getStreamList()}getStreamList(){this.ruleSvc.allStreams().subscribe(n=>{this.streamList=n})}refresh(){this.ruleSvc.allStreams().subscribe(n=>{this.streamList=n,this.msgSvc.success("refresh")})}add(){this.router.navigate(["../add-stream"],{relativeTo:this.route})}edit(n){this.router.navigate(["../edit-stream"],{relativeTo:this.route,queryParams:{streamName:n}})}deleteConfirm(n){this.selectedStream=n,$("#deleteConfirmDialog").modal("show")}delete(){$("#deleteConfirmDialog").modal("hide"),this.ruleSvc.deleteOneStreamById(this.selectedStream).subscribe(()=>{this.msgSvc.success("delete",`name: ${this.selectedStream}`),this.streamList.forEach((n,o)=>{n===this.selectedStream&&this.streamList.splice(o,1)})})}static#e=this.\u0275fac=function(o){return new(o||a)(e.Y36(h.n),e.Y36(C.e),e.Y36(g.gz),e.Y36(g.F0))};static#t=this.\u0275cmp=e.Xpm({type:a,selectors:[["app-stream-list"]],decls:33,vars:1,consts:function(){let n,o,t,i,s,_,f,p,c;return n="Stream List",o="Refresh",t="Add",i="Warning",s=" The data will be permanently erased!!! Are you sure to execute delete operation\uFF1F ",_="Cancel",f="Confirm",p="Edit",c="Delete",[[1,"card"],[1,"card-header"],[1,"fa","fa-list","mr-2","text-danger"],n,[1,"card-header","p-2"],["role","group",1,"btn-group","btn-group-sm"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-refresh","mr-1"],o,[1,"btn","btn-success","btn-sm",3,"click"],[1,"fa","fa-plus-circle","mr-1"],t,[1,"card-body","p-0"],[1,"list-group","p-0","border-0"],["class","list-group-item list-group-item-action list-group-item-light border-top-0 border-left-0  border-right-0",4,"ngFor","ngForOf"],["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],i,[1,"modal-body"],s,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],_,["type","button",1,"btn","btn-danger",3,"click"],f,[1,"list-group-item","list-group-item-action","list-group-item-light","border-top-0","border-left-0","border-right-0"],[1,"media"],[1,"align-self-center","mr-3"],[1,"fa","fa-tags","fa-2x","text-secondary"],[1,"media-body"],[1,"mt-0","mb-1"],[1,"d-inline","mr-3","align-middle","text-dark"],[1,"float-right"],["role","button",1,"badge","badge-info","mr-2",3,"click"],[1,"fa","fa-edit","mr-1"],p,["role","button",1,"badge","badge-danger",3,"click"],[1,"fa","fa-trash","mr-1"],c]},template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span"),e.SDv(4,3),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5)(7,"button",6),e.NdJ("click",function(){return t.refresh()}),e._UZ(8,"i",7),e.TgZ(9,"span"),e.SDv(10,8),e.qZA()(),e.TgZ(11,"button",9),e.NdJ("click",function(){return t.add()}),e._UZ(12,"i",10),e.TgZ(13,"span"),e.SDv(14,11),e.qZA()()()(),e.TgZ(15,"div",12)(16,"ul",13),e.YNc(17,et,18,1,"li",14),e.qZA()()(),e.TgZ(18,"div",15)(19,"div",16)(20,"div",17)(21,"div",18)(22,"h5",19),e._UZ(23,"i",20),e.TgZ(24,"span"),e.SDv(25,21),e.qZA()()(),e.TgZ(26,"div",22),e.SDv(27,23),e.qZA(),e.TgZ(28,"div",24)(29,"button",25),e.SDv(30,26),e.qZA(),e.TgZ(31,"button",27),e.NdJ("click",function(){return t.delete()}),e.SDv(32,28),e.qZA()()()()()),2&o&&(e.xp6(17),e.Q6J("ngForOf",t.streamList))},dependencies:[u.sg],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}#addStreamDialog[_ngcontent-%COMP%]   #editStreamDialog[_ngcontent-%COMP%]{margin-top:10%}"]})}return a})();var nt=d(2560),ot=d(2096),it=d(8180),at=d(6306),st=d(1631);let U=(()=>{class a{constructor(n,o){this.router=n,this.ruleSvc=o}canActivate(n,o){return this.checkAvailable(n,o)}canActivateChild(n,o){return this.canActivate(n,o)}checkAvailable(n,o){return this.ruleSvc.ping().pipe((0,it.q)(1),(0,at.K)(t=>this.router.navigate(["/svc-unavailable"],{queryParams:{svcName:"rule engine",routerPath:`/${o.url.split("/")[1]}`}})),(0,st.z)(()=>(0,ot.of)(!0)))}static#e=this.\u0275fac=function(o){return new(o||a)(e.LFG(g.F0),e.LFG(h.n))};static#t=this.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();const lt=[{path:"",component:J,canActivate:[nt.a,U],canActivateChild:[U],children:[{path:"",redirectTo:"stream-center",pathMatch:"full"},{path:"stream-center",component:We,children:[{path:"",redirectTo:"stream-list",pathMatch:"full"},{path:"stream-list",component:tt},{path:"add-stream",component:ze},{path:"edit-stream",component:je}]},{path:"rules-center",component:Ge,children:[{path:"",redirectTo:"rules-list",pathMatch:"full"},{path:"rules-list",component:Be},{path:"add-rules",component:xe},{path:"edit-rules",component:Je}]}]}];let rt=(()=>{class a{static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275mod=e.oAB({type:a});static#n=this.\u0275inj=e.cJS({imports:[g.Bz.forChild(lt),g.Bz]})}return a})();var dt=d(7181),_t=d(2649);let ct=(()=>{class a{static#e=this.\u0275fac=function(o){return new(o||a)};static#t=this.\u0275mod=e.oAB({type:a});static#n=this.\u0275inj=e.cJS({imports:[u.ez,l.u5,l.UX,rt,dt.Y,_t.MetadataModule]})}return a})()}}]);