"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[744],{9744:(re,G,l)=>{l.r(G),l.d(G,{NotificationsModule:()=>de});var v=l(6814),I=l(95),d=l(9919),e=l(6689);let k=(()=>{class o{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-notifications"]],decls:11,vars:0,consts:function(){let t,i;return t="Notification",i="Subscription",[[1,"card"],[1,"card-header"],[1,"nav","nav-tabs","card-header-tabs","font-weight-bold"],[1,"nav-item"],["routerLink","./notification-center","routerLinkActive","active",1,"nav-link"],t,["routerLink","./subscription-center","routerLinkActive","active",1,"nav-link"],i,[1,"card-body"]]},template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ul",2)(3,"li",3)(4,"a",4),e.SDv(5,5),e.qZA()(),e.TgZ(6,"li",3)(7,"a",6),e.SDv(8,7),e.qZA()()()(),e.TgZ(9,"div",8),e._UZ(10,"router-outlet"),e.qZA()())},dependencies:[d.lC,d.rH,d.Od]})}return o})(),x=(()=>{class o{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-notification-center"]],decls:1,vars:0,template:function(i,n){1&i&&e._UZ(0,"router-outlet")},dependencies:[d.lC]})}return o})();var F=l(4875),D=l(5425),y=l(3685);function J(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"input",48),e.NdJ("click",function(n){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.selectOne(n,a))}),e.qZA()(),e.TgZ(3,"td",91),e._uU(4),e.qZA(),e.TgZ(5,"td",91),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.ALo(23,"date"),e.qZA(),e.TgZ(24,"td"),e._uU(25),e.ALo(26,"date"),e.qZA()()}if(2&o){const t=c.$implicit,i=e.oxw();e.ekj("table-active",i.isChecked(t.id)),e.xp6(2),e.Q6J("checked",i.isChecked(t.id)),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.category),e.xp6(2),e.Oqu(t.labels),e.xp6(2),e.Oqu(t.content),e.xp6(2),e.Oqu(t.contentType),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(t.sender),e.xp6(2),e.Oqu(t.severity),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Oqu(e.xi3(23,14,t.created,"yyyy-MM-dd hh:mm:ss")),e.xp6(3),e.Oqu(e.xi3(26,17,t.modified,"yyyy-MM-dd hh:mm:ss"))}}let z=(()=>{class o{constructor(t,i){this.notiSvc=t,this.msgSvc=i,this.notificationList=[],this.notificationSelected=[],this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit,this.categorySelected="SECURITY",this.statusSelected="NEW",this.advancedOperation=!1}ngOnInit(){$('[data-toggle="popover"]').popover({trigger:"hover"}),this.setSearchMode("status"),this.findNotificationsByStatusPagination(!0),this.initDatePickr()}initDatePickr(){this.calendarStart=(0,F.Z)("input[name='startSelected']",{dateFormat:"U",altFormat:"Y-m-d H:i:S",altInput:!0,enableTime:!0,enableSeconds:!0,time_24hr:!0,allowInput:!1,onChange:(t,i,n)=>{this.startSelected=1e3*Number(i)}}),this.calendarEnd=(0,F.Z)("input[name='endSelected']",{dateFormat:"U",altFormat:"Y-m-d H:i:S",altInput:!0,enableTime:!0,enableSeconds:!0,time_24hr:!0,allowInput:!1,onChange:(t,i,n)=>{this.endSelected=1e3*Number(i)}}),this.calendarStart=(0,F.Z)("input[name='ageCleanupAll']",{dateFormat:"U",altFormat:"Y-m-d H:i:S",altInput:!0,enableTime:!0,enableSeconds:!0,time_24hr:!0,allowInput:!1,onChange:(t,i,n)=>{this.ageCleanupAll=1e3*Number(i)}}),this.calendarEnd=(0,F.Z)("input[name='ageCleanupByStatusIsProcessed']",{dateFormat:"U",altFormat:"Y-m-d H:i:S",altInput:!0,enableTime:!0,enableSeconds:!0,time_24hr:!0,allowInput:!1,onChange:(t,i,n)=>{this.ageCleanupByStatusIsProcessed=1e3*Number(i)}})}advancedToggle(){this.advancedOperation=!this.advancedOperation}findNotificationsByCategoryPagination(t){this.notiSvc.findNotificationsByCategoryPagination(this.pageOffset,this.pageLimit,this.categorySelected).subscribe(i=>{this.notificationList=i.notifications,!t&&this.msgSvc.success("search by category")})}findNotificationsByStatusPagination(t){this.notiSvc.findNotificationsByStatusPagination(this.pageOffset,this.pageLimit,this.statusSelected).subscribe(i=>{this.notificationList=i.notifications,!t&&this.msgSvc.success("search by status")})}findNotificationsByLabelPagination(t){this.notiSvc.findNotificationsByLabelPagination(this.pageOffset,this.pageLimit,this.labelSelected).subscribe(i=>{this.notificationList=i.notifications,!t&&this.msgSvc.success("search by label")})}findNotificationsByStartEndPagination(t){console.log(this.startSelected,this.endSelected),this.notiSvc.findNotificationsByStartEndPagination(this.pageOffset,this.pageLimit,this.startSelected,this.endSelected).subscribe(i=>{this.notificationList=i.notifications,!t&&this.msgSvc.success("search by start and end")})}setSearchMode(t){this.searchMode=t}searchByStatus(){this.resetPagination(),this.setSearchMode("status"),this.findNotificationsByStatusPagination()}searchByCategory(){this.resetPagination(),this.setSearchMode("category"),this.findNotificationsByCategoryPagination()}searchByStartEnd(){this.resetPagination(),this.setSearchMode("duration"),this.findNotificationsByStartEndPagination()}deleteConfirm(t){this.cleanMode=t,$("#deleteConfirmDialog").modal("show")}cleanup(){switch(this.cleanMode){case"age":this.cleanupByAge();break;case"status":this.cleanupByAgeAndStatusIsProcessed();break;default:this.deleteSelected()}}cleanupByAge(){this.notiSvc.deleteNotificationByAgeAndStatus(this.ageCleanupAll).subscribe(()=>{this.msgSvc.success("cleanup by age")}),$("#deleteConfirmDialog").modal("hide")}cleanupByAgeAndStatusIsProcessed(){this.notiSvc.deleteNotificationByAgeAndStatus(this.ageCleanupByStatusIsProcessed).subscribe(()=>{this.msgSvc.success("cleanup by age when status is processed")}),$("#deleteConfirmDialog").modal("hide")}deleteSelected(){this.notificationSelected.forEach(t=>{this.notiSvc.deleteNotificationById(t.id).subscribe(()=>{this.msgSvc.success("delete",`ID: ${t.id}`)})}),$("#deleteConfirmDialog").modal("hide")}isCheckedAll(){let t=!0;return this.notificationList&&0===this.notificationList.length&&(t=!1),this.notificationList.forEach(i=>{-1===this.notificationSelected.findIndex(n=>n.id===i.id)&&(t=!1)}),t}selectAll(t){this.notificationList.forEach(t.target.checked?n=>{-1===this.notificationSelected.findIndex(_=>_.id===n.id)&&this.notificationSelected.push(n)}:n=>{let _=this.notificationSelected.findIndex(a=>a.id===n.id);-1!==_&&this.notificationSelected.splice(_,1)})}isChecked(t){return this.notificationSelected.findIndex(i=>i.id===t)>=0}selectOne(t,i){if(t.target.checked)return void this.notificationSelected.push(i);let _=this.notificationSelected.findIndex(a=>a.id===i.id);-1!==_&&this.notificationSelected.splice(_,1)}paginationBySearchMode(){switch(this.searchMode){case"status":this.findNotificationsByStatusPagination(!0);break;case"category":this.findNotificationsByCategoryPagination(!0);break;case"duration":this.findNotificationsByStartEndPagination(!0)}}onPageSelected(){this.resetPagination(),this.paginationBySearchMode()}prePage(){this.setPagination(-1),this.paginationBySearchMode()}nextPage(){this.setPagination(1),this.paginationBySearchMode()}setPagination(t){1===t?this.pagination+=1:-1===t&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit}resetPagination(){this.pagination=1,this.setPagination()}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(D.T),e.Y36(y.e))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-notification-list"]],decls:161,vars:11,consts:function(){let t,i,n,_,a,r,N,C,O,g,u,p,f,A,P,R,b,M,m,E,h,T,L,U,Z,B;return t="Notification List",i="\xA0The data loaded by default takes the value of status as NEW",n="Delete",_="Advanced",a="Status",r="Start",N="End",C="CleanupByAge",O="Cleanup",g="Category",u="Labels",p="Content",f="ContentType",A="Description",P="Sender",R="Severity",b="Status",M="Created",m="Modified",E="items per page",h="Previous",T="Next",L="Warning",U=" The data will be permanently erased!!! Are you sure to execute delete operation\uFF1F ",Z="Cancel",B="Confirm",[[1,"card"],[1,"card-header"],[1,"fa","fa-list","text-danger","mr-1"],t,[1,"fa","fa-info-circle","text-success","font-weight-bold","ml-1"],i,[1,"bg-light","card-header","p-0"],[1,"px-2","py-2"],["role","group",1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash","mr-1"],n,["role","button",1,"text-primary","ml-3","text-decoration-none",3,"click"],_,[1,"fa","fa-angle-double-right","ml-1"],[1,"bg-light","card-header","p-0",3,"hidden"],[1,"form-group","row"],[1,"col-md-10"],[1,"input-group",2,"width","600px"],[1,"input-group-prepend"],[1,"input-group-text"],a,["name","statusSelected",1,"custom-select",3,"ngModel","ngModelChange"],["value","NEW"],["value","PROCESSED"],["value","ESCALATED"],["role","button",1,"input-group-append",3,"click"],[1,"fa","fa-search"],r,[1,"fa","fa-calendar"],["type","text","name","startSelected",1,"form-control"],N,["type","text","name","endSelected",1,"form-control"],[1,"input-group-append"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],C,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","Deletes notifications which have age and is less than the specified one, where the age of Notification is calculated by subtracting its last modification timestamp from the current timestamp. Note that the corresponding transmissions will also be deleted.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","ageCleanupAll",1,"form-control"],[1,"fa","fa-trash-o"],O,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","Deletes the processed notifications if the current timestamp minus their last modification timestamp is less than the age parameter, and the corresponding transmissions will also be deleted. Please notice that this API is only for processed notifications (status = PROCESSED). If the deletion purpose includes each kind of notifications, please refer to cleanupAll.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","ageCleanupByStatusIsProcessed",1,"form-control"],["type","button",1,"btn","btn-danger","font-weight-bold",3,"disabled","click"],[1,"card-body","p-0","position-relative"],[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],["type","checkbox","role","button",3,"checked","click"],g,u,p,f,A,P,R,b,M,m,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],E,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],h,[1,"page-item"],T,["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],L,[1,"modal-body"],U,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],Z,["type","button",1,"btn","btn-danger",3,"click"],B,[1,"user-select-all"]]},template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span"),e.SDv(4,3),e.qZA(),e.TgZ(5,"span",4),e.SDv(6,5),e.qZA()(),e.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"button",9),e.NdJ("click",function(){return n.deleteConfirm()}),e.TgZ(11,"span"),e._UZ(12,"i",10),e.TgZ(13,"span"),e.SDv(14,11),e.qZA()()()(),e.TgZ(15,"a",12),e.NdJ("click",function(){return n.advancedToggle()}),e.TgZ(16,"span")(17,"span"),e.SDv(18,13),e.qZA(),e._UZ(19,"i",14),e.qZA()()()(),e.TgZ(20,"div",15)(21,"div",7)(22,"form")(23,"div",16)(24,"div",17)(25,"div",18)(26,"div",19)(27,"span",20),e.SDv(28,21),e.qZA()(),e.TgZ(29,"select",22),e.NdJ("ngModelChange",function(a){return n.statusSelected=a}),e.TgZ(30,"option",23),e._uU(31,"NEW"),e.qZA(),e.TgZ(32,"option",24),e._uU(33,"PROCESSED"),e.qZA(),e.TgZ(34,"option",25),e._uU(35,"ESCALATED"),e.qZA()(),e.TgZ(36,"div",26),e.NdJ("click",function(){return n.searchByStatus()}),e.TgZ(37,"span",20),e._UZ(38,"i",27),e.qZA()()()()(),e.TgZ(39,"div",16)(40,"div",17)(41,"div",18)(42,"div",19)(43,"span",20),e.SDv(44,28),e.qZA()(),e.TgZ(45,"div",19)(46,"span",20),e._UZ(47,"i",29),e.qZA()(),e._UZ(48,"input",30),e.TgZ(49,"div",19)(50,"span",20),e.SDv(51,31),e.qZA()(),e.TgZ(52,"div",19)(53,"span",20),e._UZ(54,"i",29),e.qZA()(),e._UZ(55,"input",32),e.TgZ(56,"div",33)(57,"button",34),e.NdJ("click",function(){return n.searchByStartEnd()}),e._UZ(58,"i",27),e.qZA()()()()(),e.TgZ(59,"div",16)(60,"div",17)(61,"div",18)(62,"div",19)(63,"span",20)(64,"span"),e.SDv(65,35),e.qZA(),e._uU(66,"\xa0 "),e._UZ(67,"span",36),e.qZA()(),e.TgZ(68,"div",19)(69,"span",20),e._UZ(70,"i",29),e.qZA()(),e._UZ(71,"input",37),e.TgZ(72,"div",33)(73,"button",9),e.NdJ("click",function(){return n.deleteConfirm("age")}),e._UZ(74,"i",38),e.qZA()()()()(),e.TgZ(75,"div",16)(76,"div",17)(77,"div",18)(78,"div",19)(79,"span",20)(80,"span"),e.SDv(81,39),e.qZA(),e._uU(82,"\xa0 "),e._UZ(83,"span",40),e.qZA()(),e.TgZ(84,"div",19)(85,"span",20),e._UZ(86,"i",29),e.qZA()(),e._UZ(87,"input",41),e.TgZ(88,"div",33)(89,"button",42),e.NdJ("click",function(){return n.deleteConfirm("status")}),e._UZ(90,"i",38),e.qZA()()()()()()()(),e.TgZ(91,"div",43)(92,"div",44)(93,"table",45)(94,"thead",46)(95,"tr")(96,"th",47)(97,"input",48),e.NdJ("click",function(a){return n.selectAll(a)}),e.qZA()(),e.TgZ(98,"th",47),e._uU(99,"ID"),e.qZA(),e.TgZ(100,"th",47),e.SDv(101,49),e.qZA(),e.TgZ(102,"th",47),e.SDv(103,50),e.qZA(),e.TgZ(104,"th",47),e.SDv(105,51),e.qZA(),e.TgZ(106,"th",47),e.SDv(107,52),e.qZA(),e.TgZ(108,"th",47),e.SDv(109,53),e.qZA(),e.TgZ(110,"th",47),e.SDv(111,54),e.qZA(),e.TgZ(112,"th",47),e.SDv(113,55),e.qZA(),e.TgZ(114,"th",47),e.SDv(115,56),e.qZA(),e.TgZ(116,"th",47),e.SDv(117,57),e.qZA(),e.TgZ(118,"th",47),e.SDv(119,58),e.qZA()()(),e.TgZ(120,"tbody"),e.YNc(121,J,27,20,"tr",59),e.qZA()()()(),e.TgZ(122,"div",60)(123,"nav",61)(124,"ul",62)(125,"li",63)(126,"span",64),e.SDv(127,65),e.qZA()(),e.TgZ(128,"li",66)(129,"select",67),e.NdJ("ngModelChange",function(a){return n.pageLimit=a})("ngModelChange",function(){return n.onPageSelected()}),e.TgZ(130,"option",68),e._uU(131,"5"),e.qZA(),e.TgZ(132,"option",69),e._uU(133,"10"),e.qZA(),e.TgZ(134,"option",70),e._uU(135,"20"),e.qZA()()(),e.TgZ(136,"li",71)(137,"button",72),e.NdJ("click",function(){return n.prePage()}),e._UZ(138,"i",73),e.TgZ(139,"span"),e.SDv(140,74),e.qZA()()(),e.TgZ(141,"li",75)(142,"button",72),e.NdJ("click",function(){return n.nextPage()}),e.TgZ(143,"span"),e.SDv(144,76),e.qZA(),e._UZ(145,"i",14),e.qZA()()()()()(),e.TgZ(146,"div",77)(147,"div",78)(148,"div",79)(149,"div",80)(150,"h5",81),e._UZ(151,"i",82),e.TgZ(152,"span"),e.SDv(153,83),e.qZA()()(),e.TgZ(154,"div",84),e.SDv(155,85),e.qZA(),e.TgZ(156,"div",86)(157,"button",87),e.SDv(158,88),e.qZA(),e.TgZ(159,"button",89),e.NdJ("click",function(){return n.cleanup()}),e.SDv(160,90),e.qZA()()()()()),2&i&&(e.xp6(10),e.Q6J("disabled",0===n.notificationSelected.length),e.xp6(10),e.Q6J("hidden",!n.advancedOperation),e.xp6(9),e.Q6J("ngModel",n.statusSelected),e.xp6(28),e.Q6J("disabled",!n.startSelected||!n.endSelected),e.xp6(16),e.Q6J("disabled",!n.ageCleanupAll),e.xp6(16),e.Q6J("disabled",!n.ageCleanupByStatusIsProcessed),e.xp6(8),e.Q6J("checked",n.isCheckedAll()),e.xp6(24),e.Q6J("ngForOf",n.notificationList),e.xp6(8),e.Q6J("ngModel",n.pageLimit),e.xp6(8),e.Q6J("disabled",1===n.pagination),e.xp6(5),e.Q6J("disabled",n.pageLimit>n.notificationList.length))},dependencies:[v.sg,I._Y,I.YN,I.Kr,I.EJ,I.JJ,I.JL,I.On,I.F,v.uU],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]})}return o})(),w=(()=>{class o{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-subscription-center"]],decls:1,vars:0,template:function(i,n){1&i&&e._UZ(0,"router-outlet")},dependencies:[d.lC]})}return o})();var q=l(8027);function Q(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"input",23),e.NdJ("click",function(n){const a=e.CHM(t).$implicit,r=e.oxw();return e.KtG(r.selectOne(n,a))}),e.qZA()(),e.TgZ(3,"td",66),e._uU(4),e.qZA(),e.TgZ(5,"td",66),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td",67)(14,"span",68),e.NdJ("click",function(){const _=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.checkChannels(_))}),e._UZ(15,"i",69),e._uU(16),e.qZA()(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA()()}if(2&o){const t=c.$implicit,i=e.oxw();e.ekj("table-active",i.isChecked(t.name)),e.xp6(2),e.Q6J("checked",i.isChecked(t.name)),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(t.categories),e.xp6(2),e.Oqu(t.labels),e.xp6(4),e.hij(" ",t.channels.length," "),e.xp6(2),e.Oqu(t.receiver),e.xp6(2),e.Oqu(t.resendLimit),e.xp6(2),e.Oqu(t.resendInterval)}}let H=(()=>{class o{constructor(t,i,n,_,a){this.notiSvc=t,this.msgSvc=i,this.route=n,this.router=_,this.errSvc=a,this.subscriptionList=[],this.subscriptionSelected=[],this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.findAllSubscriptionsPagination()}refresh(){this.notiSvc.findAllSubscriptionPagination(this.pageOffset,this.pageLimit).subscribe(t=>{this.subscriptionList=t.subscriptions,this.msgSvc.success("refresh")})}findAllSubscriptionsPagination(){this.notiSvc.findAllSubscriptionPagination(this.pageOffset,this.pageLimit).subscribe(t=>{this.subscriptionList=t.subscriptions})}checkChannels(t){this.router.navigate(["../edit-subscription"],{relativeTo:this.route,queryParams:{subName:t.name}})}isCheckedAll(){let t=!0;return this.subscriptionList&&0===this.subscriptionList.length&&(t=!1),this.subscriptionList.forEach(i=>{-1===this.subscriptionSelected.findIndex(n=>n.id===i.id)&&(t=!1)}),t}selectAll(t){this.subscriptionList.forEach(t.target.checked?n=>{-1===this.subscriptionSelected.findIndex(_=>_.name===n.name)&&this.subscriptionSelected.push(n)}:n=>{let _=this.subscriptionSelected.findIndex(a=>a.name===n.name);-1!==_&&this.subscriptionSelected.splice(_,1)})}isChecked(t){return this.subscriptionSelected.findIndex(i=>i.name===t)>=0}selectOne(t,i){if(t.target.checked)return void this.subscriptionSelected.push(i);let _=this.subscriptionSelected.findIndex(a=>a.name===i.name);-1!==_&&this.subscriptionSelected.splice(_,1)}edit(){this.router.navigate(["../edit-subscription"],{relativeTo:this.route,queryParams:{subName:this.subscriptionSelected[0].name}})}deleteConfirm(){$("#deleteConfirmDialog").modal("show")}deleteSubs(){this.subscriptionSelected.forEach(t=>{this.notiSvc.deleteOneSubscriptionByName(t.name).subscribe(i=>{this.errSvc.handleErrorForAPI(i)||(this.subscriptionList.forEach((n,_)=>{n.name!==t.name||this.subscriptionList.splice(_,1)}),this.msgSvc.success("delete",`name: ${t.name}`),this.resetPagination(),this.findAllSubscriptionsPagination())})}),$("#deleteConfirmDialog").modal("hide")}onPageSelected(){this.resetPagination(),this.setPagination(),this.findAllSubscriptionsPagination()}prePage(){this.setPagination(-1),this.findAllSubscriptionsPagination()}nextPage(){this.setPagination(1),this.findAllSubscriptionsPagination()}setPagination(t){1===t?this.pagination+=1:-1===t&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit}resetPagination(){this.pagination=1}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(D.T),e.Y36(y.e),e.Y36(d.gz),e.Y36(d.F0),e.Y36(q.T))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-subscription-list"]],decls:93,vars:7,consts:function(){let t,i,n,_,a,r,N,C,O,g,u,p,f,A,P,R,b,M,m,E,h;return t="Subscription List",i="Refresh",n="Add",_="Edit",a="Delete",r="ID",N="Name",C="Description",O="Categories",g="Labels",u="Channels",p="Receiver",f="ResendLimit",A="ResendInterval",P="items per page",R="Previous",b="Next",M="Warning",m=" The data will be permanently erased!!! Are you sure to execute delete operation\uFF1F ",E="Cancel",h="Confirm",[[1,"card"],[1,"card-header"],[1,"fa","fa-list","text-danger","mr-1"],t,[1,"card-body","p-0","position-relative"],[1,"bg-light","px-2","py-2"],["role","group",1,"btn-group","btn-group-sm"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-refresh","mr-1"],i,["type","button","routerLink","../add-subscription",1,"btn","btn-info"],[1,"fa","fa-plus","mr-1"],n,["type","button",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-edit","mr-1"],_,["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash","mr-1"],a,[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],["type","checkbox","role","button",3,"checked","click"],r,N,C,O,g,u,p,f,A,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],P,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],R,[1,"page-item"],b,[1,"fa","fa-angle-double-right","ml-1"],["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],M,[1,"modal-body"],m,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],E,["type","button",1,"btn","btn-danger",3,"click"],h,[1,"user-select-all"],[1,"text-center"],["role","button",1,"badge","badge-primary","text-light",3,"click"],[1,"fa","fa-paper-plane-o"]]},template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span"),e.SDv(4,3),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5)(7,"div",6)(8,"button",7),e.NdJ("click",function(){return n.refresh()}),e.TgZ(9,"span"),e._UZ(10,"i",8),e.TgZ(11,"span"),e.SDv(12,9),e.qZA()()(),e.TgZ(13,"button",10)(14,"span"),e._UZ(15,"i",11),e.TgZ(16,"span"),e.SDv(17,12),e.qZA()()(),e.TgZ(18,"button",13),e.NdJ("click",function(){return n.edit()}),e.TgZ(19,"span"),e._UZ(20,"i",14),e.TgZ(21,"span"),e.SDv(22,15),e.qZA()()(),e.TgZ(23,"button",16),e.NdJ("click",function(){return n.deleteConfirm()}),e.TgZ(24,"span"),e._UZ(25,"i",17),e.TgZ(26,"span"),e.SDv(27,18),e.qZA()()()()(),e.TgZ(28,"div",19)(29,"table",20)(30,"thead",21)(31,"tr")(32,"th",22)(33,"input",23),e.NdJ("click",function(a){return n.selectAll(a)}),e.qZA()(),e.TgZ(34,"th",22),e.SDv(35,24),e.qZA(),e.TgZ(36,"th",22),e.SDv(37,25),e.qZA(),e.TgZ(38,"th",22),e.SDv(39,26),e.qZA(),e.TgZ(40,"th",22),e.SDv(41,27),e.qZA(),e.TgZ(42,"th",22),e.SDv(43,28),e.qZA(),e.TgZ(44,"th",22),e.SDv(45,29),e.qZA(),e.TgZ(46,"th",22),e.SDv(47,30),e.qZA(),e.TgZ(48,"th",22),e.SDv(49,31),e.qZA(),e.TgZ(50,"th",22),e.SDv(51,32),e.qZA()()(),e.TgZ(52,"tbody"),e.YNc(53,Q,23,12,"tr",33),e.qZA()()()(),e.TgZ(54,"div",34)(55,"nav",35)(56,"ul",36)(57,"li",37)(58,"span",38),e.SDv(59,39),e.qZA()(),e.TgZ(60,"li",40)(61,"select",41),e.NdJ("ngModelChange",function(a){return n.pageLimit=a})("ngModelChange",function(){return n.onPageSelected()}),e.TgZ(62,"option",42),e._uU(63,"5"),e.qZA(),e.TgZ(64,"option",43),e._uU(65,"10"),e.qZA(),e.TgZ(66,"option",44),e._uU(67,"20"),e.qZA()()(),e.TgZ(68,"li",45)(69,"button",46),e.NdJ("click",function(){return n.prePage()}),e._UZ(70,"i",47),e.TgZ(71,"span"),e.SDv(72,48),e.qZA()()(),e.TgZ(73,"li",49)(74,"button",46),e.NdJ("click",function(){return n.nextPage()}),e.TgZ(75,"span"),e.SDv(76,50),e.qZA(),e._UZ(77,"i",51),e.qZA()()()()()(),e.TgZ(78,"div",52)(79,"div",53)(80,"div",54)(81,"div",55)(82,"h5",56),e._UZ(83,"i",57),e.TgZ(84,"span"),e.SDv(85,58),e.qZA()()(),e.TgZ(86,"div",59),e.SDv(87,60),e.qZA(),e.TgZ(88,"div",61)(89,"button",62),e.SDv(90,63),e.qZA(),e.TgZ(91,"button",64),e.NdJ("click",function(){return n.deleteSubs()}),e.SDv(92,65),e.qZA()()()()()),2&i&&(e.xp6(18),e.Q6J("disabled",1!==n.subscriptionSelected.length),e.xp6(5),e.Q6J("disabled",0===n.subscriptionSelected.length),e.xp6(10),e.Q6J("checked",n.isCheckedAll()),e.xp6(20),e.Q6J("ngForOf",n.subscriptionList),e.xp6(8),e.Q6J("ngModel",n.pageLimit),e.xp6(8),e.Q6J("disabled",1===n.pagination),e.xp6(5),e.Q6J("disabled",n.pageLimit>n.subscriptionList.length))},dependencies:[v.sg,I.YN,I.Kr,I.EJ,I.JJ,I.On,d.rH]})}return o})();function Y(o,c){if(1&o&&e._UZ(0,"span",57),2&o){const t=e.oxw();e.ekj("text-danger",0===t.channelTemplates.length)}}function K(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"form")(2,"div",14)(3,"label",60)(4,"span",16),e.SDv(5,61),e.qZA(),e._UZ(6,"span",62),e.qZA(),e.TgZ(7,"div",10)(8,"input",63),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.recipients=n)}),e.qZA(),e.TgZ(9,"div",64)(10,"small"),e.SDv(11,65),e.qZA()()()()(),e.TgZ(12,"button",66),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,_=e.oxw();return e.KtG(_.removeChannelTemplate(n))}),e._UZ(13,"i",67),e.TgZ(14,"span"),e.SDv(15,68),e.qZA()()()}if(2&o){const t=e.oxw().$implicit;e.xp6(8),e.ekj("is-invalid",!t.recipients)("is-valid",t.recipients),e.Q6J("ngModel",t.recipients)}}function j(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"form")(2,"div",14)(3,"label",69),e.SDv(4,70),e.qZA(),e.TgZ(5,"div",10)(6,"select",71),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.httpMethod=n)}),e.TgZ(7,"option",72),e._uU(8,"GET"),e.qZA(),e.TgZ(9,"option",73),e._uU(10,"POST"),e.qZA(),e.TgZ(11,"option",74),e._uU(12,"PUT"),e.qZA(),e.TgZ(13,"option",75),e._uU(14,"DELETE"),e.qZA(),e.TgZ(15,"option",76),e._uU(16,"PATCH"),e.qZA(),e.TgZ(17,"option",77),e._uU(18,"HEAD"),e.qZA(),e.TgZ(19,"option",78),e._uU(20,"TRACE"),e.qZA(),e.TgZ(21,"option",79),e._uU(22,"CONNECT"),e.qZA()()()(),e.TgZ(23,"div",7)(24,"label",80),e.SDv(25,81),e.qZA(),e.TgZ(26,"div",10)(27,"input",82),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.host=n)}),e.qZA(),e.TgZ(28,"div",83)(29,"small"),e.SDv(30,84),e.qZA()()()(),e.TgZ(31,"div",7)(32,"label",85),e.SDv(33,86),e.qZA(),e.TgZ(34,"div",10)(35,"input",87),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.port=n)}),e.qZA(),e.TgZ(36,"div",88)(37,"small"),e.SDv(38,89),e.qZA()()()(),e.TgZ(39,"div",14)(40,"label",90),e.SDv(41,91),e.qZA(),e.TgZ(42,"div",10)(43,"input",92),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.path=n)}),e.qZA()()()(),e.TgZ(44,"button",66),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,_=e.oxw();return e.KtG(_.removeChannelTemplate(n))}),e._UZ(45,"i",67),e.TgZ(46,"span"),e.SDv(47,93),e.qZA()()()}if(2&o){const t=e.oxw().$implicit,i=e.oxw();e.xp6(6),e.Q6J("ngModel",t.httpMethod),e.xp6(21),e.ekj("is-invalid",!t.host)("is-valid",t.host),e.Q6J("ngModel",t.host),e.xp6(8),e.ekj("is-invalid",!i.isPureIntegerType(t.port))("is-valid",i.isPureIntegerType(t.port)),e.Q6J("ngModel",t.port),e.xp6(8),e.Q6J("ngModel",t.path)}}function W(o,c){if(1&o&&(e.TgZ(0,"div",58)(1,"div",6),e.YNc(2,K,16,5,"div",59),e.YNc(3,j,48,12,"div",59),e.qZA()()),2&o){const t=c.$implicit;e.xp6(2),e.Q6J("ngIf","EMAIL"===t.type),e.xp6(1),e.Q6J("ngIf","REST"===t.type)}}let V=(()=>{class o{constructor(t,i,n,_,a){this.notiSvc=t,this.msgSvc=i,this.errSvc=n,this.route=_,this.router=a,this.channelTemplates=[],this.subCategories="",this.subLabels="",this.subscription={adminState:"UNLOCKED"}}ngOnInit(){this.renderPopoverComponent()}renderPopoverComponent(){setTimeout(()=>{$('[data-toggle="popover"]').popover({trigger:"hover"})},150)}submit(){this.subscription.categories=this.subCategories.split(","),this.subscription.labels=this.subLabels.split(","),this.channelTemplates.forEach((t,i)=>{if("EMAIL"===t.type){let n=t.recipients.toString();t.recipients=n.split(",")}}),this.subscription.channels=this.channelTemplates,this.notiSvc.addOneSubscription(this.subscription).subscribe(t=>{this.errSvc.handleErrorForAPI(t)||(this.msgSvc.success("Add new subscription",`Name: ${this.subscription.name}`),this.router.navigate(["../subscription-list"],{relativeTo:this.route}))})}addChannelTemplate(t){switch(t){case"REST":this.addRESTAddr();break;case"EMAIL":this.addEMAILAddr()}}removeChannelTemplate(t){let i=this.channelTemplates.indexOf(t);-1!==i&&(this.channelTemplates.splice(i,1),this.renderPopoverComponent())}addRESTAddr(){this.channelTemplates.push({type:"REST",httpMethod:"GET"}),this.renderPopoverComponent()}addEMAILAddr(){this.channelTemplates.push({type:"EMAIL"}),this.renderPopoverComponent()}isPureIntegerType(t){return!isNaN(t)&&parseFloat(t)===parseInt(t)}validate(){let t=!1;return 0!==this.channelTemplates.length&&this.channelTemplates.forEach((i,n)=>{("REST"!==i.type||""!==i.path&&i.port)&&("EMAIL"!==i.type||i.recipients)||(t=!0)}),!(!t&&this.subscription.name&&this.subCategories&&this.subLabels&&this.subscription.receiver&&0!==this.channelTemplates.length)}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(D.T),e.Y36(y.e),e.Y36(q.T),e.Y36(d.gz),e.Y36(d.F0))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-subscription"]],decls:92,vars:30,consts:function(){let t,i,n,_,a,r,N,C,O,g,u,p,f,A,P,R,b,M,m,E,h,T,L,U,Z,B,s;return t="Add Subscription",i="Submit",n="Name",_="the subscription name can't be empty!",a="Categories",r="the subscription categories can't be empty!",N="Labels",C="the subscription labels can't be empty!",O="Receiver",g="the subscription receiver can't be empty!",u="ResendInterval",p="ResendLimit",f="AdminState",A="Channels",P="Add Channel Template",R="EMAIL Channel Template",b="REST Channel Template",M="EmailRecipients",m="the email address port can't be empty",E="Remove",h="HttpMethod",T="Host",L="the REST address host can't be empty!",U="Port",Z="the REST address port can't be empty and only pure integer is supported!",B="Path",s="Remove",[[1,"card"],[1,"card-header"],[1,"fa","fa-plus","text-danger","mr-2"],t,[1,"btn","btn-sm","btn-success","float-right",3,"disabled","click"],i,[1,"card-body"],[1,"form-group","row","has-validation"],["for","subscriptionName","required","",1,"col-md-2","col-form-label"],n,[1,"col-md-10"],["type","text","id","validationSubscriptionName","name","subscriptionName","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","validationSubscriptionNameFeedback",1,"invalid-feedback"],_,[1,"form-group","row"],["for","subscriptionStart",1,"col-md-2","col-form-label"],[1,"mr-2"],a,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Links the subscription to one or more categories of notification. Multiple categories are separated by commas, such as: xxx,yyy,zzz",1,"fa","fa-question-circle-o","fa-lg"],[1,"input-group","mb-3"],["type","text","name","subscriptionStart","required","",1,"form-control",3,"ngModel","ngModelChange"],r,["for","subscriptionLabels",1,"col-md-2","col-form-label"],N,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Arbitrary labels that can be applied to the subscription for further categorization or identification. Multiple labels are separated by commas, such as: xxx,yyy,zzz",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","subscriptionLabels",1,"form-control",3,"ngModel","ngModelChange"],C,["for","subscriptionReceiver",1,"col-md-2","col-form-label"],O,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Receiver indicates the name of the party interested in the notification.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","subscriptionReceiver","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","validationSubscriptionReceiverFeedback",1,"invalid-feedback"],g,["for","subscriptionResendInterval",1,"col-md-2","col-form-label"],u,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content",'Subscription ResendInterval indicates how often the specific resource needs to be polled. It represents as a duration string. The format of this field is to be an unsigned integer followed by a unit which may be "ns", "us" (or "\xb5s"), "ms", "s", "m", "h" representing nanoseconds, microseconds, milliseconds, seconds, minutes or hours. Eg, "100ms", "24h"',1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","subscriptionResendInterval","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","subscriptionResendLimit",1,"col-md-2","col-form-label"],p,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Pure integer! Subscription ResendLimit indicates the retry limit for attempts to send notifications.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","subscriptionResendLimit","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","subscriptionAdminState",1,"col-md-2","col-form-label"],f,["name","subscriptionAdminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"],["for","subscriptionChannels",1,"col-md-2","col-form-label"],A,P,["class","fa fa-question-circle-o fa-lg","role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","At least one channel must be created",3,"text-danger",4,"ngIf"],[1,"mb-3"],["role","button",1,"badge","badge-secondary","mr-2",3,"click"],[1,"fa","fa-plus-circle","mr-1"],R,["role","button",1,"badge","badge-secondary",3,"click"],b,["class","card mb-3",4,"ngFor","ngForOf"],["role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","At least one channel must be created",1,"fa","fa-question-circle-o","fa-lg"],[1,"card","mb-3"],[4,"ngIf"],["for","emailRecipients",1,"col-md-2","col-form-label"],M,["role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Multiple email addresses are separated by commas, such as: xxx@xxx.com, yyy@yyy.com",1,"fa","fa-question-circle-o","fa-lg"],["type","text","id","emailRecipients","name","emailRecipients",1,"form-control",3,"ngModel","ngModelChange"],["id","emailRecipientsFeedback",1,"invalid-feedback"],m,[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash","mr-1"],E,["for","HttpMethod","required","",1,"col-md-2","col-form-label"],h,["type","text","name","httpMethod",1,"custom-select",3,"ngModel","ngModelChange"],["value","GET"],["value","POST"],["value","PUT"],["value","DELETE"],["value","PATCH"],["value","HEAD"],["value","TRACE"],["value","CONNECT"],["for","addressHostREST","required","",1,"col-md-2","col-form-label"],T,["type","text","id","addressHostREST","name","addressHost","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","addressHostRESTFeedback",1,"invalid-feedback"],L,["for","addressPortREST","required","",1,"col-md-2","col-form-label"],U,["type","number","id","addressPortREST","name","addressPort","placeholder","Pure integer !","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","addressPortRESTFeedback",1,"invalid-feedback"],Z,["for","addressPath","required","",1,"col-md-2","col-form-label"],B,["type","text","id","addressPath","name","addressPath",1,"form-control",3,"ngModel","ngModelChange"],s]},template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span"),e.SDv(4,3),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return n.submit()}),e.SDv(6,5),e.qZA()(),e.TgZ(7,"div",6)(8,"form")(9,"div",7)(10,"label",8),e.SDv(11,9),e.qZA(),e.TgZ(12,"div",10)(13,"input",11),e.NdJ("ngModelChange",function(a){return n.subscription.name=a}),e.qZA(),e.TgZ(14,"div",12)(15,"small"),e.SDv(16,13),e.qZA()()()(),e.TgZ(17,"div",14)(18,"label",15)(19,"span",16),e.SDv(20,17),e.qZA(),e._UZ(21,"span",18),e.qZA(),e.TgZ(22,"div",10)(23,"div",19)(24,"input",20),e.NdJ("ngModelChange",function(a){return n.subCategories=a}),e.qZA(),e.TgZ(25,"div",12)(26,"small"),e.SDv(27,21),e.qZA()()()()(),e.TgZ(28,"div",14)(29,"label",22)(30,"span",16),e.SDv(31,23),e.qZA(),e._UZ(32,"span",24),e.qZA(),e.TgZ(33,"div",10)(34,"div",19)(35,"input",25),e.NdJ("ngModelChange",function(a){return n.subLabels=a}),e.qZA(),e.TgZ(36,"div",12)(37,"small"),e.SDv(38,26),e.qZA()()()()(),e.TgZ(39,"div",14)(40,"label",27)(41,"span",16),e.SDv(42,28),e.qZA(),e._UZ(43,"span",29),e.qZA(),e.TgZ(44,"div",10)(45,"input",30),e.NdJ("ngModelChange",function(a){return n.subscription.receiver=a}),e.qZA(),e.TgZ(46,"div",31)(47,"small"),e.SDv(48,32),e.qZA()()()(),e.TgZ(49,"div",14)(50,"label",33)(51,"span",16),e.SDv(52,34),e.qZA(),e._UZ(53,"span",35),e.qZA(),e.TgZ(54,"div",10)(55,"input",36),e.NdJ("ngModelChange",function(a){return n.subscription.resendInterval=a}),e.qZA()()(),e.TgZ(56,"div",14)(57,"label",37)(58,"span",16),e.SDv(59,38),e.qZA(),e._UZ(60,"span",39),e.qZA(),e.TgZ(61,"div",10)(62,"input",40),e.NdJ("ngModelChange",function(a){return n.subscription.resendLimit=a}),e.qZA()()(),e.TgZ(63,"div",14)(64,"label",41),e.SDv(65,42),e.qZA(),e.TgZ(66,"div",10)(67,"select",43),e.NdJ("ngModelChange",function(a){return n.subscription.adminState=a}),e.TgZ(68,"option",44),e._uU(69,"UNLOCKED"),e.qZA(),e.TgZ(70,"option",45),e._uU(71,"LOCKED"),e.qZA()()()(),e.TgZ(72,"div",14)(73,"label",46),e.SDv(74,47),e.qZA(),e.TgZ(75,"div",10)(76,"div",0)(77,"div",1)(78,"span",16),e.SDv(79,48),e.qZA(),e.YNc(80,Y,1,2,"span",49),e.qZA(),e.TgZ(81,"div",6)(82,"div",50)(83,"span",51),e.NdJ("click",function(){return n.addChannelTemplate("EMAIL")}),e._UZ(84,"i",52),e.TgZ(85,"span"),e.SDv(86,53),e.qZA()(),e.TgZ(87,"span",54),e.NdJ("click",function(){return n.addChannelTemplate("REST")}),e._UZ(88,"i",52),e.TgZ(89,"span"),e.SDv(90,55),e.qZA()()(),e.YNc(91,W,4,2,"div",56),e.qZA()()()()()()()),2&i&&(e.xp6(5),e.Q6J("disabled",n.validate()),e.xp6(8),e.ekj("is-invalid",!n.subscription.name)("is-valid",n.subscription.name),e.Q6J("ngModel",n.subscription.name),e.xp6(11),e.ekj("is-invalid",!n.subCategories)("is-valid",n.subCategories),e.Q6J("ngModel",n.subCategories),e.xp6(11),e.ekj("is-invalid",!n.subLabels)("is-valid",n.subLabels),e.Q6J("ngModel",n.subLabels),e.xp6(10),e.ekj("is-invalid",!n.subscription.receiver)("is-valid",n.subscription.receiver),e.Q6J("ngModel",n.subscription.receiver),e.xp6(10),e.Q6J("ngModel",n.subscription.resendInterval),e.xp6(7),e.Q6J("ngModel",n.subscription.resendLimit),e.xp6(5),e.Q6J("ngModel",n.subscription.adminState),e.xp6(10),e.ekj("border",0===n.channelTemplates.length)("border-danger",0===n.channelTemplates.length),e.xp6(3),e.Q6J("ngIf",0===n.channelTemplates.length),e.xp6(11),e.Q6J("ngForOf",n.channelTemplates))},dependencies:[v.sg,v.O5,I._Y,I.YN,I.Kr,I.Fj,I.wV,I.EJ,I.JJ,I.JL,I.Q7,I.On,I.F]})}return o})();function ee(o,c){if(1&o&&e._UZ(0,"span",57),2&o){const t=e.oxw();e.ekj("text-danger",0===t.channelTemplates.length)}}function te(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"form")(2,"div",14)(3,"label",60)(4,"span",16),e.SDv(5,61),e.qZA(),e._UZ(6,"span",62),e.qZA(),e.TgZ(7,"div",10)(8,"input",63),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.recipients=n)}),e.qZA(),e.TgZ(9,"div",64)(10,"small"),e.SDv(11,65),e.qZA()()()()(),e.TgZ(12,"button",66),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,_=e.oxw();return e.KtG(_.removeChannelTemplate(n))}),e._UZ(13,"i",67),e._uU(14," Remove"),e.qZA()()}if(2&o){const t=e.oxw().$implicit;e.xp6(8),e.ekj("is-invalid",!t.recipients)("is-valid",t.recipients),e.Q6J("ngModel",t.recipients)}}function ne(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"form")(2,"div",14)(3,"label",68),e.SDv(4,69),e.qZA(),e.TgZ(5,"div",10)(6,"select",70),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.httpMethod=n)}),e.TgZ(7,"option",71),e._uU(8,"GET"),e.qZA(),e.TgZ(9,"option",72),e._uU(10,"POST"),e.qZA(),e.TgZ(11,"option",73),e._uU(12,"PUT"),e.qZA(),e.TgZ(13,"option",74),e._uU(14,"DELETE"),e.qZA(),e.TgZ(15,"option",75),e._uU(16,"PATCH"),e.qZA(),e.TgZ(17,"option",76),e._uU(18,"HEAD"),e.qZA(),e.TgZ(19,"option",77),e._uU(20,"TRACE"),e.qZA(),e.TgZ(21,"option",78),e._uU(22,"CONNECT"),e.qZA()()()(),e.TgZ(23,"div",7)(24,"label",79),e.SDv(25,80),e.qZA(),e.TgZ(26,"div",10)(27,"input",81),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.host=n)}),e.qZA(),e.TgZ(28,"div",82)(29,"small"),e.SDv(30,83),e.qZA()()()(),e.TgZ(31,"div",7)(32,"label",84),e.SDv(33,85),e.qZA(),e.TgZ(34,"div",10)(35,"input",86),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.port=n)}),e.qZA(),e.TgZ(36,"div",87)(37,"small"),e.SDv(38,88),e.qZA()()()(),e.TgZ(39,"div",14)(40,"label",89),e.SDv(41,90),e.qZA(),e.TgZ(42,"div",10)(43,"input",91),e.NdJ("ngModelChange",function(n){e.CHM(t);const _=e.oxw().$implicit;return e.KtG(_.path=n)}),e.qZA()()()(),e.TgZ(44,"button",66),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,_=e.oxw();return e.KtG(_.removeChannelTemplate(n))}),e._UZ(45,"i",92),e.TgZ(46,"span"),e.SDv(47,93),e.qZA()()()}if(2&o){const t=e.oxw().$implicit,i=e.oxw();e.xp6(6),e.Q6J("ngModel",t.httpMethod),e.xp6(21),e.ekj("is-invalid",!t.host)("is-valid",t.host),e.Q6J("ngModel",t.host),e.xp6(8),e.ekj("is-invalid",!i.isPureIntegerType(t.port))("is-valid",i.isPureIntegerType(t.port)),e.Q6J("ngModel",t.port),e.xp6(8),e.Q6J("ngModel",t.path)}}function ie(o,c){if(1&o&&(e.TgZ(0,"div",58)(1,"div",6),e.YNc(2,te,15,5,"div",59),e.YNc(3,ne,48,12,"div",59),e.qZA()()),2&o){const t=c.$implicit;e.xp6(2),e.Q6J("ngIf","EMAIL"===t.type),e.xp6(1),e.Q6J("ngIf","REST"===t.type)}}let _e=(()=>{class o{constructor(t,i,n,_,a){this.notiSvc=t,this.msgSvc=i,this.errSvc=n,this.route=_,this.router=a,this.channelTemplates=[],this.subCategories="",this.subLabels="",this.subscription={}}ngOnInit(){this.renderPopoverComponent(),this.route.queryParams.subscribe(t=>{t.subName&&this.notiSvc.findOneSubscriptionByName(t.subName).subscribe(i=>{this.subscription=i.subscription,this.subCategories=this.subscription.categories.toString(),this.subLabels=this.subscription.labels.toString(),this.channelTemplates=this.subscription.channels})})}renderPopoverComponent(){setTimeout(()=>{$('[data-toggle="popover"]').popover({trigger:"hover"})},150)}update(){this.subscription.categories=this.subCategories.split(","),this.subscription.labels=this.subLabels.split(","),this.channelTemplates.forEach((t,i)=>{if("EMAIL"===t.type){let n=t.recipients.toString();t.recipients=n.split(",")}}),this.subscription.channels=this.channelTemplates,this.notiSvc.updateOneSubscription(this.subscription).subscribe(t=>{this.errSvc.handleErrorForAPI(t)||(this.msgSvc.success("Update subscription",`Name: ${this.subscription.name}`),this.router.navigate(["../subscription-list"],{relativeTo:this.route}))})}addChannelTemplate(t){switch(t){case"REST":this.addRESTAddr();break;case"EMAIL":this.addEMAILAddr()}}removeChannelTemplate(t){let i=this.channelTemplates.indexOf(t);-1!==i&&(this.channelTemplates.splice(i,1),this.renderPopoverComponent())}addRESTAddr(){this.channelTemplates.push({type:"REST",httpMethod:"GET"}),this.renderPopoverComponent()}addEMAILAddr(){this.channelTemplates.push({type:"EMAIL"}),this.renderPopoverComponent()}isPureIntegerType(t){return!isNaN(t)&&parseFloat(t)===parseInt(t)}validate(){let t=!1;return 0!==this.channelTemplates.length&&this.channelTemplates.forEach((i,n)=>{("REST"!==i.type||""!==i.path&&i.port)&&("EMAIL"!==i.type||i.recipients)||(t=!0)}),!(!t&&this.subscription.name&&this.subCategories&&this.subLabels&&this.subscription.receiver&&0!==this.channelTemplates.length)}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(D.T),e.Y36(y.e),e.Y36(q.T),e.Y36(d.gz),e.Y36(d.F0))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit-subscription"]],decls:92,vars:30,consts:function(){let t,i,n,_,a,r,N,C,O,g,u,p,f,A,P,R,b,M,m,E,h,T,L,U,Z,B;return t="Edit Subscription",i="Save",n="Name",_="the subscription name can't be empty!",a="Categories",r="the subscription categories can't be empty!",N="Labels",C="the subscription labels can't be empty!",O="Receiver",g="the subscription receiver can't be empty!",u="ResendInterval",p="ResendLimit",f="AdminState",A="Channels",P="Add Channel Template",R="EMAIL Channel Template",b="REST Channel Template",M="EmailRecipients",m="the email address port can't be empty",E="HttpMethod",h="Host",T="the REST address host can't be empty!",L="Port",U="the REST address port can't be empty and only pure integer is supported!",Z="Path",B="Remove",[[1,"card"],[1,"card-header"],[1,"fa","fa-edit","text-danger","mr-2"],t,[1,"btn","btn-sm","btn-success","float-right",3,"disabled","click"],i,[1,"card-body"],[1,"form-group","row","has-validation"],["for","subscriptionName","required","",1,"col-md-2","col-form-label"],n,[1,"col-md-10"],["type","text","id","validationSubscriptionName","name","subscriptionName","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","validationSubscriptionNameFeedback",1,"invalid-feedback"],_,[1,"form-group","row"],["for","subscriptionStart",1,"col-md-2","col-form-label"],[1,"mr-2"],a,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Links the subscription to one or more categories of notification. Multiple categories are separated by commas, such as: xxx,yyy,zzz",1,"fa","fa-question-circle-o","fa-lg"],[1,"input-group","mb-3"],["type","text","name","subscriptionStart","required","",1,"form-control",3,"ngModel","ngModelChange"],r,["for","subscriptionLabels",1,"col-md-2","col-form-label"],N,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Arbitrary labels that can be applied to the subscription for further categorization or identification. Multiple labels are separated by commas, such as: xxx,yyy,zzz",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","subscriptionLabels",1,"form-control",3,"ngModel","ngModelChange"],C,["for","subscriptionReceiver",1,"col-md-2","col-form-label"],O,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Receiver indicates the name of the party interested in the notification.",1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","subscriptionReceiver","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","validationSubscriptionReceiverFeedback",1,"invalid-feedback"],g,["for","subscriptionResendInterval",1,"col-md-2","col-form-label"],u,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content",'Subscription ResendInterval indicates how often the specific resource needs to be polled. It represents as a duration string. The format of this field is to be an unsigned integer followed by a unit which may be "ns", "us" (or "\xb5s"), "ms", "s", "m", "h" representing nanoseconds, microseconds, milliseconds, seconds, minutes or hours. Eg, "100ms", "24h"',1,"fa","fa-question-circle-o","fa-lg"],["type","text","name","subscriptionResendInterval","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","subscriptionResendLimit",1,"col-md-2","col-form-label"],p,["role","button","data-html","true","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Pure integer! Subscription ResendLimit indicates the retry limit for attempts to send notifications.",1,"fa","fa-question-circle-o","fa-lg"],["type","number","name","subscriptionResendLimit","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","subscriptionAdminState",1,"col-md-2","col-form-label"],f,["name","subscriptionAdminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"],["for","subscriptionChannels",1,"col-md-2","col-form-label"],A,P,["class","fa fa-question-circle-o fa-lg","role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","At least one channel must be created",3,"text-danger",4,"ngIf"],[1,"mb-3"],["role","button",1,"badge","badge-secondary","mr-2",3,"click"],[1,"fa","fa-plus-circle","mr-1"],R,["role","button",1,"badge","badge-secondary",3,"click"],b,["class","card mb-3",4,"ngFor","ngForOf"],["role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","tips","data-content","At least one channel must be created",1,"fa","fa-question-circle-o","fa-lg"],[1,"card","mb-3"],[4,"ngIf"],["for","emailRecipients",1,"col-md-2","col-form-label"],M,["role","button","data-html","false","data-animation","true","data-trigger","focus","data-toggle","popover","title","format tips","data-content","Multiple email addresses are separated by commas, such as: xxx@xxx.com, yyy@yyy.com",1,"fa","fa-question-circle-o","fa-lg"],["type","text","id","emailRecipients","name","emailRecipients",1,"form-control",3,"ngModel","ngModelChange"],["id","emailRecipientsFeedback",1,"invalid-feedback"],m,[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash"],["for","HttpMethod","required","",1,"col-md-2","col-form-label"],E,["type","text","name","httpMethod",1,"custom-select",3,"ngModel","ngModelChange"],["value","GET"],["value","POST"],["value","PUT"],["value","DELETE"],["value","PATCH"],["value","HEAD"],["value","TRACE"],["value","CONNECT"],["for","addressHostREST","required","",1,"col-md-2","col-form-label"],h,["type","text","id","addressHostREST","name","addressHost","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","addressHostRESTFeedback",1,"invalid-feedback"],T,["for","addressPortREST","required","",1,"col-md-2","col-form-label"],L,["type","number","id","addressPortREST","name","addressPort","placeholder","Pure integer !","required","",1,"form-control",3,"ngModel","ngModelChange"],["id","addressPortRESTFeedback",1,"invalid-feedback"],U,["for","addressPath","required","",1,"col-md-2","col-form-label"],Z,["type","text","id","addressPath","name","addressPath",1,"form-control",3,"ngModel","ngModelChange"],[1,"fa","fa-trash","mr-1"],B]},template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span"),e.SDv(4,3),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return n.update()}),e.SDv(6,5),e.qZA()(),e.TgZ(7,"div",6)(8,"form")(9,"div",7)(10,"label",8),e.SDv(11,9),e.qZA(),e.TgZ(12,"div",10)(13,"input",11),e.NdJ("ngModelChange",function(a){return n.subscription.name=a}),e.qZA(),e.TgZ(14,"div",12)(15,"small"),e.SDv(16,13),e.qZA()()()(),e.TgZ(17,"div",14)(18,"label",15)(19,"span",16),e.SDv(20,17),e.qZA(),e._UZ(21,"span",18),e.qZA(),e.TgZ(22,"div",10)(23,"div",19)(24,"input",20),e.NdJ("ngModelChange",function(a){return n.subCategories=a}),e.qZA(),e.TgZ(25,"div",12)(26,"small"),e.SDv(27,21),e.qZA()()()()(),e.TgZ(28,"div",14)(29,"label",22)(30,"span",16),e.SDv(31,23),e.qZA(),e._UZ(32,"span",24),e.qZA(),e.TgZ(33,"div",10)(34,"div",19)(35,"input",25),e.NdJ("ngModelChange",function(a){return n.subLabels=a}),e.qZA(),e.TgZ(36,"div",12)(37,"small"),e.SDv(38,26),e.qZA()()()()(),e.TgZ(39,"div",14)(40,"label",27)(41,"span",16),e.SDv(42,28),e.qZA(),e._UZ(43,"span",29),e.qZA(),e.TgZ(44,"div",10)(45,"input",30),e.NdJ("ngModelChange",function(a){return n.subscription.receiver=a}),e.qZA(),e.TgZ(46,"div",31)(47,"small"),e.SDv(48,32),e.qZA()()()(),e.TgZ(49,"div",14)(50,"label",33)(51,"span",16),e.SDv(52,34),e.qZA(),e._UZ(53,"span",35),e.qZA(),e.TgZ(54,"div",10)(55,"input",36),e.NdJ("ngModelChange",function(a){return n.subscription.resendInterval=a}),e.qZA()()(),e.TgZ(56,"div",14)(57,"label",37)(58,"span",16),e.SDv(59,38),e.qZA(),e._UZ(60,"span",39),e.qZA(),e.TgZ(61,"div",10)(62,"input",40),e.NdJ("ngModelChange",function(a){return n.subscription.resendLimit=a}),e.qZA()()(),e.TgZ(63,"div",14)(64,"label",41),e.SDv(65,42),e.qZA(),e.TgZ(66,"div",10)(67,"select",43),e.NdJ("ngModelChange",function(a){return n.subscription.adminState=a}),e.TgZ(68,"option",44),e._uU(69,"UNLOCKED"),e.qZA(),e.TgZ(70,"option",45),e._uU(71,"LOCKED"),e.qZA()()()(),e.TgZ(72,"div",14)(73,"label",46),e.SDv(74,47),e.qZA(),e.TgZ(75,"div",10)(76,"div",0)(77,"div",1)(78,"span",16),e.SDv(79,48),e.qZA(),e.YNc(80,ee,1,2,"span",49),e.qZA(),e.TgZ(81,"div",6)(82,"div",50)(83,"span",51),e.NdJ("click",function(){return n.addChannelTemplate("EMAIL")}),e._UZ(84,"i",52),e.TgZ(85,"span"),e.SDv(86,53),e.qZA()(),e.TgZ(87,"span",54),e.NdJ("click",function(){return n.addChannelTemplate("REST")}),e._UZ(88,"i",52),e.TgZ(89,"span"),e.SDv(90,55),e.qZA()()(),e.YNc(91,ie,4,2,"div",56),e.qZA()()()()()()()),2&i&&(e.xp6(5),e.Q6J("disabled",n.validate()),e.xp6(8),e.ekj("is-invalid",!n.subscription.name)("is-valid",n.subscription.name),e.Q6J("ngModel",n.subscription.name),e.xp6(11),e.ekj("is-invalid",!n.subCategories)("is-valid",n.subCategories),e.Q6J("ngModel",n.subCategories),e.xp6(11),e.ekj("is-invalid",!n.subLabels)("is-valid",n.subLabels),e.Q6J("ngModel",n.subLabels),e.xp6(10),e.ekj("is-invalid",!n.subscription.receiver)("is-valid",n.subscription.receiver),e.Q6J("ngModel",n.subscription.receiver),e.xp6(10),e.Q6J("ngModel",n.subscription.resendInterval),e.xp6(7),e.Q6J("ngModel",n.subscription.resendLimit),e.xp6(5),e.Q6J("ngModel",n.subscription.adminState),e.xp6(10),e.ekj("border",0===n.channelTemplates.length)("border-danger",0===n.channelTemplates.length),e.xp6(3),e.Q6J("ngIf",0===n.channelTemplates.length),e.xp6(11),e.Q6J("ngForOf",n.channelTemplates))},dependencies:[v.sg,v.O5,I._Y,I.YN,I.Kr,I.Fj,I.wV,I.EJ,I.JJ,I.JL,I.Q7,I.On,I.F]})}return o})();var oe=l(2560),ae=l(2096),se=l(8180),Ie=l(6306),Te=l(1631);let X=(()=>{class o{constructor(t,i){this.router=t,this.notiSvc=i}canActivate(t,i){return this.checkAvailable(t,i)}canActivateChild(t,i){return this.canActivate(t,i)}checkAvailable(t,i){return this.notiSvc.ping().pipe((0,se.q)(1),(0,Ie.K)(n=>this.router.navigate(["/svc-unavailable"],{queryParams:{svcName:"notification",routerPath:`/${i.url.split("/")[1]}`}})),(0,Te.z)(()=>(0,ae.of)(!0)))}static#e=this.\u0275fac=function(i){return new(i||o)(e.LFG(d.F0),e.LFG(D.T))};static#t=this.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const Se=[{path:"",component:k,canActivate:[oe.a,X],canActivateChild:[X],children:[{path:"",redirectTo:"notification-center",pathMatch:"full"},{path:"notification-center",component:x,children:[{path:"",component:z}]},{path:"subscription-center",component:w,children:[{path:"",redirectTo:"subscription-list",pathMatch:"full"},{path:"subscription-list",component:H},{path:"add-subscription",component:V},{path:"edit-subscription",component:_e}]}]}];let le=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(Se),d.Bz]})}return o})(),de=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#n=this.\u0275inj=e.cJS({imports:[v.ez,I.u5,le]})}return o})()}}]);