"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[10],{4010:(E_,F,d)=>{d.r(F),d.d(F,{MetadataModule:()=>We});var i=d(8583),a=d(3092),C=d(9502),_=d(476);let V=(()=>{class E{constructor(){}ngOnInit(){}}return E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-metadata"]],decls:14,vars:0,consts:function(){let o,e,t;return o="\u8BBE\u5907\u670D\u52A1",e="\u8BBE\u5907",t="\u8BBE\u5907\u5143\u4FE1\u606F",[[1,"card"],[1,"card-header"],[1,"nav","nav-tabs","card-header-tabs","font-weight-bold"],[1,"nav-item"],["routerLink","./device-service-list","routerLinkActive","active",1,"nav-link"],o,["routerLink","./device-center","routerLinkActive","active",1,"nav-link"],e,["routerLink","./device-profile-center","routerLinkActive","active",1,"nav-link"],t,[1,"card-body"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"ul",2),_.TgZ(3,"li",3),_.TgZ(4,"a",4),_.SDv(5,5),_.qZA(),_.qZA(),_.TgZ(6,"li",3),_.TgZ(7,"a",6),_.SDv(8,7),_.qZA(),_.qZA(),_.TgZ(9,"li",3),_.TgZ(10,"a",8),_.SDv(11,9),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(12,"div",10),_._UZ(13,"router-outlet"),_.qZA(),_.qZA())},directives:[C.yS,C.Od,C.lC],styles:[".active-link[_ngcontent-%COMP%]{color:#922c48;background-color:#922c4866!important}"]}),E})();var R=d(2437),Z=d(7822);function A(E,o){if(1&E&&(_.TgZ(0,"p"),_._uU(1),_.qZA()),2&E){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.description)}}function u(E,o){1&E&&(_.TgZ(0,"p",20),_._uU(1,"no description."),_.qZA())}function P(E,o){if(1&E&&(_.TgZ(0,"span",21),_._uU(1),_.qZA()),2&E){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.adminState)}}function h(E,o){if(1&E&&(_.TgZ(0,"span",22),_._uU(1),_.qZA()),2&E){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.adminState)}}function W(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"a",23),_.NdJ("click",function(){_.CHM(e);const n=_.oxw().$implicit;return _.oxw().associatedDevicesSkip(n.name)}),_._UZ(1,"i",24),_.TgZ(2,"span"),_.SDv(3,25),_.qZA(),_._uU(4),_.qZA()}if(2&E){const e=_.oxw().$implicit,t=_.oxw();_.xp6(4),_.hij("\xa0 ",t.associatedDevices.get(e.name)," ")}}function e_(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"li",3),_.TgZ(1,"div",4),_.TgZ(2,"div",5),_._UZ(3,"i",6),_.qZA(),_.TgZ(4,"div",7),_.TgZ(5,"div",8),_.TgZ(6,"h5",9),_._uU(7),_.qZA(),_.qZA(),_.YNc(8,A,2,1,"p",10),_.YNc(9,u,2,0,"ng-template",null,11,_.W1O),_.TgZ(11,"div"),_.TgZ(12,"span",12),_._uU(13),_.qZA(),_.TgZ(14,"span",13),_.YNc(15,P,2,1,"span",14),_.YNc(16,h,2,1,"span",15),_.qZA(),_.YNc(17,W,5,1,"a",16),_.TgZ(18,"span",17),_.NdJ("click",function(){const c=_.CHM(e).$implicit;return _.oxw().edit(c)}),_._UZ(19,"i",18),_.TgZ(20,"span"),_.SDv(21,19),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=o.$implicit,t=_.MAs(10),n=_.oxw();_.xp6(7),_.Oqu(e.name),_.xp6(1),_.Q6J("ngIf",e.description)("ngIfElse",t),_.xp6(5),_.hij("Port ",n.getSvcPort(e.baseAddress),""),_.xp6(1),_.Q6J("ngSwitch",e.adminState),_.xp6(1),_.Q6J("ngSwitchCase","UNLOCKED"),_.xp6(2),_.Q6J("ngIf",n.associatedDevices.size)}}function S(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div",26),_.TgZ(1,"div",27),_._UZ(2,"i",28),_.TgZ(3,"span"),_.SDv(4,29),_.qZA(),_.TgZ(5,"span",30),_._uU(6),_.qZA(),_.TgZ(7,"button",31),_.NdJ("click",function(){return _.CHM(e),_.oxw().updateSvc()}),_.SDv(8,32),_.qZA(),_.qZA(),_.TgZ(9,"div",33),_.TgZ(10,"form"),_.TgZ(11,"div",34),_.TgZ(12,"label",35),_.SDv(13,36),_.qZA(),_.TgZ(14,"div",37),_.TgZ(15,"input",38),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().deviceSvcSelected.description=n}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(16,"div",34),_.TgZ(17,"label",39),_.SDv(18,40),_.qZA(),_.TgZ(19,"div",37),_.TgZ(20,"select",41),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().deviceSvcSelected.adminState=n}),_.TgZ(21,"option",42),_._uU(22,"UNLOCKED"),_.qZA(),_.TgZ(23,"option",43),_._uU(24,"LOCKED"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=_.oxw();_.xp6(6),_.Oqu(e.deviceSvcSelected.name),_.xp6(9),_.Q6J("ngModel",e.deviceSvcSelected.description),_.xp6(5),_.Q6J("ngModel",e.deviceSvcSelected.adminState)}}let G=(()=>{class E{constructor(e,t,n,c){this.metaSvc=e,this.msgSvc=t,this.router=n,this.route=c,this.deviceServiceList=[],this.associatedDevices=new Map}ngOnInit(){this.metaSvc.allDeviceServices().subscribe(e=>{this.deviceServiceList=e.services,this.deviceServiceList.forEach(t=>{this.metaSvc.findDevicesByServiceName(0,20,t.name).subscribe(n=>{this.associatedDevices.set(t.name,n.devices.length>20?"20+":String(n.devices.length))})})})}getSvcPort(e){return new URL(e).port}edit(e){this.deviceSvcSelected=e}updateSvc(){this.metaSvc.updateDeviceService(this.deviceSvcSelected).subscribe(()=>{var e;this.msgSvc.success("update device service",`name: ${null===(e=this.deviceSvcSelected)||void 0===e?void 0:e.name}`),this.deviceSvcSelected=void 0})}associatedDevicesSkip(e){this.router.navigate(["../device-center"],{queryParams:{svcName:e},relativeTo:this.route})}}return E.\u0275fac=function(e){return new(e||E)(_.Y36(R.D),_.Y36(Z.e),_.Y36(C.F0),_.Y36(C.gz))},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-device-service-media-list"]],decls:3,vars:2,consts:function(){let o,e,t,n,c,s;return o="\u8BBE\u7F6E",e="\u5173\u8054\u8BBE\u5907",t="\u7F16\u8F91",n="\u4FDD\u5B58",c="\u63CF\u8FF0",s="\u7BA1\u7406\u72B6\u6001",[[1,"list-group","p-0"],["class","list-group-item list-group-item-action list-group-item-light",4,"ngFor","ngForOf"],["class","card mt-3",4,"ngIf"],[1,"list-group-item","list-group-item-action","list-group-item-light"],[1,"media"],[1,"align-self-center","mr-3"],[1,"fa","fa-tags","fa-2x","text-secondary"],[1,"media-body"],[1,"mt-0","mb-1"],[1,"d-inline","mr-3","align-middle","text-dark"],[4,"ngIf","ngIfElse"],["nodesc",""],[1,"badge","badge-info","mr-3"],[3,"ngSwitch"],["class","badge badge-success mr-3",4,"ngSwitchCase"],["class","badge badge-danger mr-3",4,"ngSwitchDefault"],["class","badge badge-primary","role","button",3,"click",4,"ngIf"],["role","button",1,"badge","badge-secondary","float-right",3,"click"],[1,"fa","fa-cog","mr-1"],o,[1,"my-1"],[1,"badge","badge-success","mr-3"],[1,"badge","badge-danger","mr-3"],["role","button",1,"badge","badge-primary",3,"click"],[1,"fa","fa-sitemap","mr-1"],e,[1,"card","mt-3"],[1,"card-header"],[1,"fa","fa-edit","mr-1","text-danger"],t,[1,"ml-1"],[1,"btn","btn-success","btn-sm","float-right",3,"click"],n,[1,"card-body"],[1,"form-group","row"],["for","deviceDesc",1,"col-md-2","col-form-label"],c,[1,"col-md-10"],["type","text","name","deviceSvcDescription",1,"form-control",3,"ngModel","ngModelChange"],["for","adminState",1,"col-md-2","col-form-label"],s,["name","deviceSvcAdminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"]]},template:function(e,t){1&e&&(_.TgZ(0,"ul",0),_.YNc(1,e_,22,7,"li",1),_.qZA(),_.YNc(2,S,25,3,"div",2)),2&e&&(_.xp6(1),_.Q6J("ngForOf",t.deviceServiceList),_.xp6(1),_.Q6J("ngIf",t.deviceSvcSelected))},directives:[i.sg,i.O5,i.RF,i.n9,i.ED,a._Y,a.JL,a.F,a.Fj,a.JJ,a.On,a.EJ,a.YN,a.Kr],styles:[""]}),E})(),l=(()=>{class E{constructor(){}ngOnInit(){}}return E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-device-center"]],decls:1,vars:0,template:function(e,t){1&e&&_._UZ(0,"router-outlet")},directives:[C.lC],styles:[""]}),E})();var r=d(7982);function D(E,o){1&E&&_._UZ(0,"div")}function L(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"li",20),_.NdJ("click",function(){const c=_.CHM(e).$implicit;return _.oxw(2).selectCmd(c)}),_._uU(1),_.qZA()}if(2&E){const e=o.$implicit,t=_.oxw(2);_.ekj("list-group-item-info",(null==t.selectedCmd?null:t.selectedCmd.name)===e.name),_.xp6(1),_.Oqu(e.name)}}function b(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"button",34),_.NdJ("click",function(){return _.CHM(e),_.oxw(3).issueGetCmd()}),_._uU(1,"try"),_.qZA()}}function x(E,o){1&E&&_._UZ(0,"div")}function q(E,o){if(1&E&&(_.TgZ(0,"span",41),_._uU(1),_.qZA()),2&E){const e=_.oxw(4);_.xp6(1),_.hij(" ",e.cmdGetResponse,"")}}function J(E,o){if(1&E&&(_.TgZ(0,"pre",42),_._uU(1),_.qZA()),2&E){const e=_.oxw(4);_.xp6(1),_.Oqu(e.cmdGetResponseRaw)}}function y(E,o){if(1&E&&(_.TgZ(0,"div"),_.TgZ(1,"span",35),_.SDv(2,36),_.qZA(),_.YNc(3,q,2,1,"span",37),_.qZA(),_.TgZ(4,"div",38),_.TgZ(5,"span",35),_.SDv(6,39),_.qZA(),_.YNc(7,J,2,1,"pre",40),_.qZA()),2&E){const e=_.oxw(3);_.xp6(3),_.Q6J("ngIf",e.cmdGetResponse),_.xp6(4),_.Q6J("ngIf",e.cmdGetResponseRaw)}}function Y(E,o){1&E&&(_.TgZ(0,"h6",43),_._UZ(1,"i",44),_.TgZ(2,"span"),_.SDv(3,45),_.qZA(),_.qZA())}function B(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"button",34),_.NdJ("click",function(){return _.CHM(e),_.oxw(3).issueSetCmd()}),_._uU(1,"try"),_.qZA()}}function w(E,o){1&E&&_._UZ(0,"div")}function K(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div"),_.TgZ(1,"label",56),_._uU(2),_.qZA(),_.TgZ(3,"select",57),_.NdJ("ngModelChange",function(n){_.CHM(e);const c=_.oxw().index;return _.oxw(6).parameterBearerList[c].value=n}),_.TgZ(4,"option",58),_._uU(5,"false"),_.qZA(),_.TgZ(6,"option",58),_._uU(7,"true"),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=_.oxw(),t=e.$implicit,n=e.index,c=_.oxw(6);_.xp6(1),_.s9C("for",t.resourceName),_.xp6(1),_.hij(" ",t.resourceName," "),_.xp6(1),_.s9C("id",t.resourceName),_.s9C("name",t.resourceName),_.Q6J("ngModel",c.parameterBearerList[n].value),_.xp6(1),_.Q6J("ngValue",!1),_.xp6(2),_.Q6J("ngValue",!0)}}function k(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"label",56),_._uU(1),_.qZA(),_.TgZ(2,"input",59),_.NdJ("ngModelChange",function(n){_.CHM(e);const c=_.oxw().index;return _.oxw(6).parameterBearerList[c].value=n}),_.qZA()}if(2&E){const e=_.oxw(),t=e.$implicit,n=e.index,c=_.oxw(6);_.s9C("for",t.resourceName),_.xp6(1),_.Oqu(t.resourceName),_.xp6(1),_.s9C("id",t.resourceName),_.s9C("name",t.resourceName),_.MGl("placeholder","valueType: ",t.valueType,""),_.Q6J("ngModel",c.parameterBearerList[n].value)}}function z(E,o){if(1&E&&(_.TgZ(0,"div",53),_.YNc(1,K,8,7,"div",54),_.YNc(2,k,3,6,"ng-template",null,55,_.W1O),_.qZA()),2&E){const e=o.$implicit,t=_.MAs(3);_.xp6(1),_.Q6J("ngIf","Bool"==e.valueType)("ngIfElse",t)}}function Q(E,o){if(1&E&&(_.TgZ(0,"div",51),_.YNc(1,z,4,2,"div",52),_.qZA()),2&E){const e=_.oxw(5);_.xp6(1),_.Q6J("ngForOf",e.selectedCmdSetParams)}}function H(E,o){if(1&E&&(_.TgZ(0,"div",12),_.TgZ(1,"div",4),_.SDv(2,49),_.qZA(),_.TgZ(3,"div",9),_.YNc(4,Q,2,1,"div",50),_.qZA(),_.qZA()),2&E){const e=_.oxw(4);_.xp6(4),_.Q6J("ngIf",e.selectedCmd)}}function m(E,o){if(1&E&&(_.TgZ(0,"span",41),_._uU(1),_.qZA()),2&E){const e=_.oxw(4);_.xp6(1),_.Oqu(e.cmdSetResponse)}}function u_(E,o){if(1&E&&(_.TgZ(0,"pre",42),_._uU(1),_.qZA()),2&E){const e=_.oxw(4);_.xp6(1),_.Oqu(e.cmdSetResponseRaw)}}function M_(E,o){if(1&E&&(_.YNc(0,H,5,1,"div",46),_.TgZ(1,"div"),_.TgZ(2,"div"),_.TgZ(3,"span",35),_.SDv(4,47),_.qZA(),_.YNc(5,m,2,1,"span",37),_.qZA(),_.TgZ(6,"div",38),_.TgZ(7,"span",35),_.SDv(8,48),_.qZA(),_.YNc(9,u_,2,1,"pre",40),_.qZA(),_.qZA()),2&E){const e=_.oxw(3);_.Q6J("ngIf",e.selectedCmdSetParams),_.xp6(5),_.Q6J("ngIf",e.cmdSetResponse),_.xp6(4),_.Q6J("ngIf",e.cmdSetResponseRaw)}}function f_(E,o){1&E&&(_.TgZ(0,"h6",43),_._UZ(1,"i",44),_.TgZ(2,"span"),_.SDv(3,60),_.qZA(),_.qZA())}function m_(E,o){if(1&E&&(_.TgZ(0,"div",21),_.TgZ(1,"div",4),_.TgZ(2,"span",22),_._UZ(3,"i",23),_._uU(4),_.qZA(),_.TgZ(5,"span"),_.SDv(6,24),_.qZA(),_.qZA(),_.TgZ(7,"div",25),_.TgZ(8,"div",10),_.TgZ(9,"div",26),_.TgZ(10,"div",12),_.TgZ(11,"div",4),_._uU(12," Get "),_.YNc(13,b,2,0,"button",27),_.qZA(),_.TgZ(14,"div",28),_.YNc(15,x,1,0,"div",0),_.YNc(16,y,8,2,"ng-template",null,29,_.W1O),_.YNc(18,Y,4,0,"ng-template",null,30,_.W1O),_.qZA(),_.qZA(),_.qZA(),_.TgZ(20,"div",31),_.TgZ(21,"div",21),_.TgZ(22,"div",4),_._uU(23," Set "),_.YNc(24,B,2,0,"button",27),_.qZA(),_.TgZ(25,"div",9),_.YNc(26,w,1,0,"div",0),_.YNc(27,M_,10,3,"ng-template",null,32,_.W1O),_.YNc(29,f_,4,0,"ng-template",null,33,_.W1O),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&E){const e=_.MAs(17),t=_.MAs(19),n=_.MAs(28),c=_.MAs(30),s=_.oxw(2);_.xp6(4),_.hij(" ",s.selectedCmd.name," method:"),_.xp6(9),_.Q6J("ngIf",s.selectedCmd.get),_.xp6(2),_.Q6J("ngIf",s.selectedCmd.get)("ngIfThen",e)("ngIfElse",t),_.xp6(9),_.Q6J("ngIf",s.selectedCmd.set),_.xp6(2),_.Q6J("ngIf",s.selectedCmd.set)("ngIfThen",n)("ngIfElse",c)}}function U_(E,o){if(1&E&&(_.TgZ(0,"div",3),_.TgZ(1,"div",4),_.TgZ(2,"span",5),_._UZ(3,"i",6),_.qZA(),_.TgZ(4,"span",7),_._uU(5),_.qZA(),_.TgZ(6,"span"),_.SDv(7,8),_.qZA(),_.qZA(),_.TgZ(8,"div",9),_.TgZ(9,"div",10),_.TgZ(10,"div",11),_.TgZ(11,"div",12),_.TgZ(12,"div",13),_.SDv(13,14),_.qZA(),_.TgZ(14,"div",15),_.TgZ(15,"ul",16),_.YNc(16,L,2,3,"li",17),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(17,"div",18),_.YNc(18,m_,31,9,"div",19),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&E){const e=_.oxw();_.xp6(5),_.Oqu(e.associatedCmdDeviceName),_.xp6(11),_.Q6J("ngForOf",e.deviceCoreCommand),_.xp6(2),_.Q6J("ngIf",e.selectedCmd)}}function v_(E,o){if(1&E&&(_.TgZ(0,"div",3),_.TgZ(1,"div",4),_.TgZ(2,"span",5),_._UZ(3,"i",6),_.qZA(),_.TgZ(4,"span",7),_._uU(5),_.qZA(),_.TgZ(6,"span"),_.SDv(7,61),_.qZA(),_.qZA(),_.TgZ(8,"div",62),_.TgZ(9,"h5",43),_._UZ(10,"i",63),_.TgZ(11,"span"),_.SDv(12,64),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&E){const e=_.oxw();_.xp6(5),_.Oqu(e.associatedCmdDeviceName)}}let P_=(()=>{class E{constructor(e,t){this.cmdSvc=e,this.metadataSvc=t,this.selectedCmd={},this.selectedCmdSetParams=[],this.parameterBearerList=[]}ngOnInit(){}ngOnChanges(){!this.deviceName||(this.resetResponse(),this.cmdSvc.findDeviceAssociatedCommnadsByDeviceName(this.deviceName).subscribe(e=>{this.associatedCmdDeviceName=e.deviceCoreCommand.deviceName,this.deviceCoreCommand=e.deviceCoreCommand.coreCommands,this.deviceCoreCommand&&0!==this.deviceCoreCommand.length&&(this.selectedCmd=this.deviceCoreCommand[0],this.selectedCmdSetParams=this.selectedCmd.parameters,this.setParameterBearerList(),this.getAssociatedDeviceProfile(e.deviceCoreCommand.profileName))}))}getAssociatedDeviceProfile(e){this.metadataSvc.findProfileByName(e).subscribe(t=>this.associateDeviceProfile=t.profile)}selectCmd(e){this.selectedCmd=e,this.selectedCmdSetParams=this.selectedCmd.parameters,this.resetResponse(),this.setParameterBearerList()}setParameterBearerList(){this.parameterBearerList=[],this.selectedCmdSetParams.forEach(e=>{this.parameterBearerList.push({key:e.resourceName,value:""})})}resetResponse(){this.cmdGetResponse="",this.cmdGetResponseRaw="",this.cmdSetResponse="",this.cmdSetResponseRaw="",this.cmdBinaryResponse=!0,this.cmdBinaryResponseURL=""}isBinaryResource(){let e=!1;return this.associateDeviceProfile.deviceResources.forEach(t=>{t.name!==this.selectedCmd.name||"Binary"!==t.properties.valueType||(e=!0)}),e||(this.associateDeviceProfile.deviceCommands.forEach(t=>{t.name===this.selectedCmd.name&&t.resourceOperations.forEach(n=>{this.associateDeviceProfile.deviceResources.forEach(c=>{n.deviceResource!==c.name||"Binary"!==c.properties.valueType||(e=!0)})})}),e)}issueGetCmd(){this.cmdSvc.issueGetCmd(this.associatedCmdDeviceName,this.selectedCmd.name).subscribe(e=>{if(this.cmdGetResponseRaw=JSON.stringify(e.event.readings,null,3),this.isBinaryResource())return void(this.cmdGetResponse="Binary resource is not supported for preview");let t=[];e.event.readings.forEach(n=>{t.push(n.value)}),this.cmdGetResponse=t.join(",")})}issueGetCmdOfBinaryResource(){this.cmdSvc.issueGetBinaryCmd(this.associatedCmdDeviceName,this.selectedCmd.name).subscribe(e=>{let t=CBOR.decode(e);"image/jpeg"===t.mediaType||"image/jpg"===t.mediaType||"image/png"===t.mediaType?(this.cmdBinaryResponse=t.binaryValue,this.cmdBinaryResponseURL=URL.createObjectURL(this.cmdBinaryResponse)):this.cmdBinaryResponse="only image binary is supported"})}issueSetCmd(){var e;let t={};this.parameterBearerList.forEach(n=>{t[n.key]=n.value}),this.cmdSvc.issueSetCmd(this.associatedCmdDeviceName,null===(e=this.selectedCmd)||void 0===e?void 0:e.name,t).subscribe(n=>{this.cmdSetResponseRaw=JSON.stringify(n,null,3),this.cmdSetResponse=n.message})}}return E.\u0275fac=function(e){return new(e||E)(_.Y36(r.V),_.Y36(R.D))},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-device-command-viewer"]],inputs:{deviceName:"deviceName"},features:[_.TTD],decls:5,vars:3,consts:function(){let o,e,t,n,c,s,I,M,O,g,N,p;return o="\u76F8\u5173\u547D\u4EE4",e=" \u547D\u4EE4\u5217\u8868 ",t="Get \u548C Set",n="\u54CD\u5E94\uFF1A",c="\u539F\u59CB\u54CD\u5E94\uFF1A",s="\u6CA1\u6709Get\u65B9\u6CD5",I="\u54CD\u5E94\uFF1A",M="\u539F\u59CB\u54CD\u5E94\uFF1A",O="\u53C2\u6570\u8BBE\u7F6E",g="\u6CA1\u6709Set\u65B9\u6CD5",N="\u76F8\u5173\u547D\u4EE4",p="\u6CA1\u6709\u76F8\u5173\u547D\u4EE4",[[4,"ngIf","ngIfThen","ngIfElse"],["hasAssociatedCommand",""],["noAssociatedCommand",""],[1,"card","mt-3"],[1,"card-header"],[1,"badge","badge-danger","text-light"],[1,"fa","fa-terminal","font-weight-bolder"],[1,"text-primary","mx-2","font-weight-bold"],o,[1,"card-body"],[1,"row"],[1,"col-md-2","col-lg-2"],[1,"card","mb-2"],[1,"card-header","font-weight-bold"],e,[1,"card-body","p-0"],[1,"list-group","list-group-flush"],["role","button","class","list-group-item list-group-item-action",3,"list-group-item-info","click",4,"ngFor","ngForOf"],[1,"col-md-10","col-lg-10"],["class","card",4,"ngIf"],["role","button",1,"list-group-item","list-group-item-action",3,"click"],[1,"card"],[1,"text-primary","font-weight-bold","mr-2"],[1,"fa","fa-thumb-tack","text-danger","mr-1"],t,[1,"card-body","px-2"],[1,"col-md-5","col-lg-5"],["class","btn btn-primary btn-sm float-right",3,"click",4,"ngIf"],[1,"card-body","overflow-auto"],["hasGetMethod",""],["noGetMethod",""],[1,"col-md-7","col-lg-7"],["hasSetMethod",""],["noSetMethod",""],[1,"btn","btn-primary","btn-sm","float-right",3,"click"],[1,"badge","badge-info"],n,["class","ml-2 text-primary",4,"ngIf"],[1,"mt-3"],c,["class","mt-2 bg-secondary p-2 text-light rounded",4,"ngIf"],[1,"ml-2","text-primary"],[1,"mt-2","bg-secondary","p-2","text-light","rounded"],[1,"text-warning"],[1,"fa","fa-warning","mr-1"],s,["class","card mb-2",4,"ngIf"],I,M,O,["class","d-flex flex-column bd-highlight",4,"ngIf"],[1,"d-flex","flex-column","bd-highlight"],["class","form p-2 bd-highlight",4,"ngFor","ngForOf"],[1,"form","p-2","bd-highlight"],[4,"ngIf","ngIfElse"],["valueTypeIsNotBool",""],[3,"for"],[1,"custom-select","custom-select-sm",3,"id","name","ngModel","ngModelChange"],[3,"ngValue"],[1,"form-control","form-control-sm",3,"id","name","ngModel","placeholder","ngModelChange"],g,N,[1,"card-body","text-center"],[1,"fa","fa-warning"],p]},template:function(e,t){if(1&e&&(_.YNc(0,D,1,0,"div",0),_.YNc(1,U_,19,3,"ng-template",null,1,_.W1O),_.YNc(3,v_,13,1,"ng-template",null,2,_.W1O)),2&e){const n=_.MAs(2),c=_.MAs(4);_.Q6J("ngIf",t.deviceCoreCommand)("ngIfThen",n)("ngIfElse",c)}},directives:[i.O5,i.sg,a.EJ,a.JJ,a.On,a.YN,a.Kr,a.Fj],styles:[""]}),E})();function N_(E,o){if(1&E&&(_.TgZ(0,"span"),_.TgZ(1,"span",67),_.SDv(2,68),_.qZA(),_.TgZ(3,"span",69),_._uU(4),_.qZA(),_.TgZ(5,"span"),_.SDv(6,70),_.qZA(),_.qZA()),2&E){const e=_.oxw();_.xp6(4),_.Oqu(e.associatedSvcName)}}function G_(E,o){if(1&E&&(_.TgZ(0,"span"),_.TgZ(1,"span",67),_.SDv(2,71),_.qZA(),_.TgZ(3,"span",69),_._uU(4),_.qZA(),_.TgZ(5,"span"),_.SDv(6,72),_.qZA(),_.qZA()),2&E){const e=_.oxw();_.xp6(4),_.Oqu(e.associatedProfileName)}}function L_(E,o){1&E&&(_.TgZ(0,"span"),_.SDv(1,73),_.qZA())}function h_(E,o){if(1&E&&(_.TgZ(0,"span",85),_._uU(1),_.qZA()),2&E){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.adminState)}}function Z_(E,o){if(1&E&&(_.TgZ(0,"span",86),_._uU(1),_.qZA()),2&E){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.adminState)}}function X_(E,o){if(1&E&&(_.TgZ(0,"span",85),_._uU(1),_.qZA()),2&E){const e=_.oxw().$implicit;_.xp6(1),_.hij(" ",e.operatingState,"")}}function F_(E,o){if(1&E&&(_.TgZ(0,"span",86),_._uU(1),_.qZA()),2&E){const e=_.oxw().$implicit;_.xp6(1),_.hij(" ",e.operatingState,"")}}function V_(E,o){if(1&E&&(_.TgZ(0,"span",86),_._uU(1),_.qZA()),2&E){const e=_.oxw().$implicit;_.xp6(1),_.hij(" ",e.operatingState,"")}}const b_=function(E){return{profileName:E}};function $_(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"tr"),_.TgZ(1,"td"),_.TgZ(2,"input",23),_.NdJ("click",function(n){const s=_.CHM(e).$implicit;return _.oxw().selectOne(n,s)}),_.qZA(),_.qZA(),_.TgZ(3,"td",74),_._uU(4),_.qZA(),_.TgZ(5,"td",74),_._uU(6),_.qZA(),_.TgZ(7,"td"),_._uU(8),_.qZA(),_.TgZ(9,"td"),_._uU(10),_.qZA(),_.TgZ(11,"td"),_.TgZ(12,"span",75),_.YNc(13,h_,2,1,"span",76),_.YNc(14,Z_,2,1,"span",77),_.qZA(),_.qZA(),_.TgZ(15,"td",78),_.TgZ(16,"span",75),_.YNc(17,X_,2,1,"span",76),_.YNc(18,F_,2,1,"span",79),_.YNc(19,V_,2,1,"span",77),_.qZA(),_.qZA(),_.TgZ(20,"td",78),_.TgZ(21,"span",80),_.NdJ("click",function(){const c=_.CHM(e).$implicit,s=_.oxw();return s.setSpecialFeatureViewer(c,s.FEATURE_COMMAND)}),_._UZ(22,"i",81),_.qZA(),_.qZA(),_.TgZ(23,"td",78),_.TgZ(24,"span",80),_.NdJ("click",function(){const c=_.CHM(e).$implicit,s=_.oxw();return s.setSpecialFeatureViewer(c,s.FEATURE_AUTOEVENT)}),_._UZ(25,"i",82),_.qZA(),_.qZA(),_.TgZ(26,"td"),_.TgZ(27,"a",83),_._uU(28),_.qZA(),_.qZA(),_.TgZ(29,"td"),_.TgZ(30,"a",84),_._uU(31),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=o.$implicit,t=_.oxw();_.ekj("table-active",t.isChecked(e.id)||t.specialFeatureAssociatedDeviceName===e.name),_.xp6(2),_.Q6J("checked",t.isChecked(e.id)),_.xp6(2),_.Oqu(e.id),_.xp6(2),_.Oqu(e.name),_.xp6(2),_.Oqu(e.description),_.xp6(2),_.Oqu(e.labels),_.xp6(2),_.Q6J("ngSwitch",e.adminState),_.xp6(1),_.Q6J("ngSwitchCase","UNLOCKED"),_.xp6(3),_.Q6J("ngSwitch",e.operatingState),_.xp6(1),_.Q6J("ngSwitchCase","UP"),_.xp6(1),_.Q6J("ngSwitchCase","DOWN"),_.xp6(3),_.ekj("badge-danger",t.specialFeatureName===t.FEATURE_COMMAND&&t.specialFeatureAssociatedDeviceName===e.name),_.xp6(3),_.ekj("badge-danger",t.specialFeatureName===t.FEATURE_AUTOEVENT&&t.specialFeatureAssociatedDeviceName===e.name),_.xp6(3),_.Q6J("queryParams",_.VKq(19,b_,e.profileName)),_.xp6(1),_.Oqu(e.profileName),_.xp6(3),_.Oqu(e.serviceName)}}function W_(E,o){if(1&E&&(_.TgZ(0,"tr"),_.TgZ(1,"td"),_._uU(2),_.qZA(),_.TgZ(3,"td"),_.TgZ(4,"span",99),_._uU(5),_.qZA(),_.qZA(),_.TgZ(6,"td"),_.TgZ(7,"span",100),_._uU(8),_.qZA(),_.qZA(),_.qZA()),2&E){const e=o.$implicit;_.xp6(2),_.Oqu(e.sourceName),_.xp6(3),_.Oqu(e.interval),_.xp6(3),_.Oqu(e.onChange)}}function x_(E,o){if(1&E&&(_.TgZ(0,"div"),_.TgZ(1,"div",89),_.TgZ(2,"div",90),_.TgZ(3,"span",91),_._UZ(4,"i",82),_.qZA(),_.TgZ(5,"span",92),_._uU(6),_.qZA(),_.TgZ(7,"span"),_.SDv(8,93),_.qZA(),_.qZA(),_.TgZ(9,"div",94),_.TgZ(10,"div",19),_.TgZ(11,"table",20),_.TgZ(12,"thead",21),_.TgZ(13,"th",22),_.SDv(14,95),_.qZA(),_.TgZ(15,"th",22),_.SDv(16,96),_.qZA(),_.TgZ(17,"th",22),_.SDv(18,97),_.qZA(),_.qZA(),_.TgZ(19,"tbody"),_.YNc(20,W_,9,3,"tr",98),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&E){const e=_.oxw(2);_.xp6(6),_.hij(" ",e.specialFeatureAssociatedDeviceName,""),_.xp6(14),_.Q6J("ngForOf",e.autoEvents)}}function q_(E,o){if(1&E&&(_.TgZ(0,"div",89),_.TgZ(1,"div",90),_.TgZ(2,"span",91),_._UZ(3,"i",82),_.qZA(),_.TgZ(4,"span",92),_._uU(5),_.qZA(),_.TgZ(6,"span"),_.SDv(7,101),_.qZA(),_.qZA(),_.TgZ(8,"div",102),_.TgZ(9,"h5",103),_._UZ(10,"i",58),_.TgZ(11,"span"),_.SDv(12,104),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&E){const e=_.oxw(2);_.xp6(5),_.hij(" ",e.specialFeatureAssociatedDeviceName,"")}}function J_(E,o){if(1&E&&(_.TgZ(0,"div"),_.YNc(1,x_,21,2,"div",87),_.YNc(2,q_,13,1,"ng-template",null,88,_.W1O),_.qZA()),2&E){const e=_.MAs(3),t=_.oxw();_.xp6(1),_.Q6J("ngIf",t.autoEvents)("ngIfElse",e)}}function y_(E,o){if(1&E&&(_.TgZ(0,"div"),_._UZ(1,"app-device-command-viewer",105),_.qZA()),2&E){const e=_.oxw();_.xp6(1),_.Q6J("deviceName",e.specialFeatureAssociatedDeviceName)}}let Y_=(()=>{class E{constructor(e,t,n,c){this.metaSvc=e,this.msgSvc=t,this.route=n,this.router=c,this.toolbars=!0,this.enableSelectAll=!0,this.deviceList=[],this.associatedSvcName="",this.associatedProfileName="",this.selectedDevice=[],this.FEATURE_AUTOEVENT="autoevent",this.FEATURE_COMMAND="command",this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.route.queryParams.subscribe(e=>e.svcName?(this.associatedSvcName=e.svcName,void this.getDeviceListByAssociatedSvc(this.associatedSvcName)):e.profileName?(this.associatedProfileName=e.profileName,void this.getDeviceListByAssociatedProfile(this.associatedProfileName)):(this.associatedSvcName="",this.associatedProfileName="",void this.getDeviceListPagination()))}renderPopoverComponent(){setTimeout(()=>{$('[data-toggle="popover"]').popover({trigger:"hover"})},250)}getDeviceList(){""===this.associatedSvcName?""===this.associatedProfileName?this.getDeviceListPagination():this.getDeviceListByAssociatedProfile(this.associatedSvcName):this.getDeviceListByAssociatedSvc(this.associatedSvcName)}getDeviceListByAssociatedSvc(e){this.metaSvc.findDevicesByServiceName(this.pageOffset,this.pageLimit,e).subscribe(t=>this.deviceList=t.devices)}getDeviceListByAssociatedProfile(e){this.metaSvc.findDevicesByProfileName(this.pageOffset,this.pageLimit,e).subscribe(t=>this.deviceList=t.devices)}getDeviceListPagination(){this.metaSvc.allDevicesPagination(this.pageOffset,this.pageLimit).subscribe(e=>{this.deviceList=e.devices})}refresh(){this.associatedProfileName="",this.associatedSvcName="",this.metaSvc.allDevicesPagination(0,this.pageLimit).subscribe(e=>{this.deviceList=e.devices,this.msgSvc.success("refresh"),this.resetPagination()})}edit(){this.router.navigate(["../edit-device"],{relativeTo:this.route,queryParams:{deviceName:this.selectedDevice[0].name}})}deleteConfirm(){$("#deleteConfirmDialog").modal("show")}delete(){this.selectedDevice.forEach((e,t)=>{this.metaSvc.deleteOneDeviceByName(e.name).subscribe(()=>{this.selectedDevice.splice(t,1),this.deviceList.forEach((n,c)=>{if(n.id===e.id)return this.deviceList.splice(c,1),void this.msgSvc.success("remove device ",` Name: ${n.name}`)})})}),this.specialFeatureName=void 0,$("#deleteConfirmDialog").modal("hide")}setSpecialFeatureViewer(e,t){switch(this.specialFeatureAssociatedDeviceName=e.name,this.specialFeatureName=t,this.specialFeatureName){case this.FEATURE_AUTOEVENT:this.autoEvents=e.autoEvents}}isCheckedAll(){let e=!0;return this.deviceList&&0===this.deviceList.length&&(e=!1),this.deviceList.forEach(t=>{-1===this.selectedDevice.findIndex(n=>n.name===t.name)&&(e=!1)}),e}selectAll(e){this.deviceList.forEach(e.target.checked?n=>{-1===this.selectedDevice.findIndex(c=>c.name===n.name)&&this.selectedDevice.push(n)}:n=>{this.selectedDevice.forEach((c,s)=>{c.name===n.name&&this.selectedDevice.splice(s,1)})})}isChecked(e){return this.selectedDevice.findIndex(t=>t.id===e)>=0}selectOne(e,t){e.target.checked?this.selectedDevice.push(t):this.selectedDevice.forEach((c,s)=>{c.name===t.name&&this.selectedDevice.splice(s,1)})}onPageSelected(){this.resetPagination(),this.getDeviceList()}prePage(){this.setPagination(-1),this.getDeviceList()}nextPage(){this.setPagination(1),this.getDeviceList()}setPagination(e){1===e?this.pagination+=1:-1===e&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit}resetPagination(){this.pagination=1,this.pageOffset=(this.pagination-1)*this.pageLimit}}return E.\u0275fac=function(e){return new(e||E)(_.Y36(R.D),_.Y36(Z.e),_.Y36(C.gz),_.Y36(C.F0))},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-device-list"]],inputs:{toolbars:"toolbars",enableSelectAll:"enableSelectAll"},decls:98,vars:12,consts:function(){let o,e,t,n,c,s,I,M,O,g,N,p,f,X,U,v,c_,s_,a_,l_,r_,T_,d_,I_,C_,D_,O_,A_,S_,g_,R_,p_;return o="\u5237\u65B0",e="\u6DFB\u52A0",t="\u7F16\u8F91",n="\u5220\u9664",c="ID",s="\u540D\u5B57",I="\u63CF\u8FF0",M="\u6807\u7B7E",O="\u7BA1\u7406\u72B6\u6001",g="\u64CD\u4F5C\u72B6\u6001",N="\u547D\u4EE4",p="\u81EA\u52A8\u91C7\u96C6",f="\u76F8\u5173\u8BBE\u5907\u5143\u4FE1\u606F",X="\u76F8\u5173\u8BBE\u5907\u670D\u52A1",U="\u6BCF\u9875\u6761\u76EE",v="\u4E0A\u4E00\u9875",c_="\u4E0B\u4E00\u9875",s_="\u8B66\u544A",a_="\u6570\u636E\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\uFF01\uFF01\uFF01\u786E\u5B9A\u8981\u6267\u884C\u5220\u9664\u64CD\u4F5C\u5417\uFF1F",l_="\u53D6\u6D88",r_="\u786E\u8BA4",T_="\u8BBE\u5907\u670D\u52A1",d_="\u76F8\u5173\u8BBE\u5907\u5217\u8868",I_="\u8BBE\u5907\u5143\u4FE1\u606F",C_="\u76F8\u5173\u8BBE\u5907\u5217\u8868",D_="\u8BBE\u5907\u5217\u8868",O_="\u76F8\u5173\u81EA\u52A8\u91C7\u96C6",A_="\u8D44\u6E90",S_="\u5355\u4F4D\u95F4\u9694",g_="Onchange",R_="\u76F8\u5173\u81EA\u52A8\u91C7\u96C6",p_="\u65E0\u76F8\u5173\u81EA\u52A8\u91C7\u96C6",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-list","text-danger","mr-2"],[4,"ngIf"],[1,"card-body","p-0","position-relative"],[1,"bg-light","px-2","py-2"],["role","group",1,"btn-group","btn-group-sm"],["data-testid","device-list-refresh-btn",1,"btn","btn-primary",3,"click"],[1,"fa","fa-refresh","mr-1"],o,["type","button","routerLink","../add-device",1,"btn","btn-info"],[1,"fa","fa-plus","mr-1"],e,["type","button",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-edit","mr-1"],t,["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash","mr-1"],n,[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],["type","checkbox","role","button",3,"checked","click"],c,s,I,M,O,g,N,p,f,X,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],U,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],v,[1,"page-item"],c_,[1,"fa","fa-angle-double-right","ml-1"],["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],s_,[1,"modal-body"],a_,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],l_,["type","button",1,"btn","btn-danger",3,"click"],r_,[1,"mr-1"],T_,[1,"text-danger","mr-1"],d_,I_,C_,D_,[1,"user-select-all"],[3,"ngSwitch"],["class","badge badge-success",4,"ngSwitchCase"],["class","badge badge-danger",4,"ngSwitchDefault"],[1,"text-center"],["class","badge badge-danger",4,"ngSwitchCase"],["role","button",1,"badge","badge-primary","text-light",3,"click"],[1,"fa","fa-terminal","font-weight-bolder"],[1,"fa","fa-calendar-check-o","font-weight-bolder"],["routerLink","../../device-profile-center",3,"queryParams"],["routerLink","../../device-service-list"],[1,"badge","badge-success"],[1,"badge","badge-danger"],[4,"ngIf","ngIfElse"],["noAutoEvents",""],[1,"card","mt-3"],[1,"card-header"],[1,"badge","badge-danger","text-light"],[1,"text-primary","mx-2","font-weight-bold"],O_,[1,"card-body","p-0"],A_,S_,g_,[4,"ngFor","ngForOf"],[1,"badge","badge-secondary","badge-pill"],[1,""],R_,[1,"card-body","text-center"],[1,"text-warning"],p_,[3,"deviceName"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._UZ(2,"i",2),_.YNc(3,N_,7,1,"span",3),_.YNc(4,G_,7,1,"span",3),_.YNc(5,L_,2,0,"span",3),_.qZA(),_.TgZ(6,"div",4),_.TgZ(7,"div",5),_.TgZ(8,"div",6),_.TgZ(9,"button",7),_.NdJ("click",function(){return t.refresh()}),_.TgZ(10,"span"),_._UZ(11,"i",8),_.TgZ(12,"span"),_.SDv(13,9),_.qZA(),_.qZA(),_.qZA(),_.TgZ(14,"button",10),_.TgZ(15,"span"),_._UZ(16,"i",11),_.TgZ(17,"span"),_.SDv(18,12),_.qZA(),_.qZA(),_.qZA(),_.TgZ(19,"button",13),_.NdJ("click",function(){return t.edit()}),_.TgZ(20,"span"),_._UZ(21,"i",14),_.TgZ(22,"span"),_.SDv(23,15),_.qZA(),_.qZA(),_.qZA(),_.TgZ(24,"button",16),_.NdJ("click",function(){return t.deleteConfirm()}),_.TgZ(25,"span"),_._UZ(26,"i",17),_.TgZ(27,"span"),_.SDv(28,18),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(29,"div",19),_.TgZ(30,"table",20),_.TgZ(31,"thead",21),_.TgZ(32,"tr"),_.TgZ(33,"th",22),_.TgZ(34,"input",23),_.NdJ("click",function(c){return t.selectAll(c)}),_.qZA(),_.qZA(),_.TgZ(35,"th",22),_.SDv(36,24),_.qZA(),_.TgZ(37,"th",22),_.SDv(38,25),_.qZA(),_.TgZ(39,"th",22),_.SDv(40,26),_.qZA(),_.TgZ(41,"th",22),_.SDv(42,27),_.qZA(),_.TgZ(43,"th",22),_.SDv(44,28),_.qZA(),_.TgZ(45,"th",22),_.SDv(46,29),_.qZA(),_.TgZ(47,"th",22),_.SDv(48,30),_.qZA(),_.TgZ(49,"th",22),_.SDv(50,31),_.qZA(),_.TgZ(51,"th",22),_.SDv(52,32),_.qZA(),_.TgZ(53,"th",22),_.SDv(54,33),_.qZA(),_.qZA(),_.qZA(),_.TgZ(55,"tbody"),_.YNc(56,$_,32,21,"tr",34),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(57,"div",35),_.TgZ(58,"nav",36),_.TgZ(59,"ul",37),_.TgZ(60,"li",38),_.TgZ(61,"span",39),_.SDv(62,40),_.qZA(),_.qZA(),_.TgZ(63,"li",41),_.TgZ(64,"select",42),_.NdJ("ngModelChange",function(c){return t.pageLimit=c})("ngModelChange",function(){return t.onPageSelected()}),_.TgZ(65,"option",43),_._uU(66,"5"),_.qZA(),_.TgZ(67,"option",44),_._uU(68,"10"),_.qZA(),_.TgZ(69,"option",45),_._uU(70,"20"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(71,"li",46),_.TgZ(72,"button",47),_.NdJ("click",function(){return t.prePage()}),_._UZ(73,"i",48),_.TgZ(74,"span"),_.SDv(75,49),_.qZA(),_.qZA(),_.qZA(),_.TgZ(76,"li",50),_.TgZ(77,"button",47),_.NdJ("click",function(){return t.nextPage()}),_.TgZ(78,"span"),_.SDv(79,51),_.qZA(),_._UZ(80,"i",52),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.YNc(81,J_,4,2,"div",3),_.YNc(82,y_,2,1,"div",3),_.TgZ(83,"div",53),_.TgZ(84,"div",54),_.TgZ(85,"div",55),_.TgZ(86,"div",56),_.TgZ(87,"h5",57),_._UZ(88,"i",58),_.TgZ(89,"span"),_.SDv(90,59),_.qZA(),_.qZA(),_.qZA(),_.TgZ(91,"div",60),_.SDv(92,61),_.qZA(),_.TgZ(93,"div",62),_.TgZ(94,"button",63),_.SDv(95,64),_.qZA(),_.TgZ(96,"button",65),_.NdJ("click",function(){return t.delete()}),_.SDv(97,66),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&e&&(_.xp6(3),_.Q6J("ngIf",""!==t.associatedSvcName),_.xp6(1),_.Q6J("ngIf",""!==t.associatedProfileName),_.xp6(1),_.Q6J("ngIf",""===t.associatedProfileName&&""===t.associatedSvcName),_.xp6(14),_.Q6J("disabled",1!==t.selectedDevice.length),_.xp6(5),_.Q6J("disabled",0===t.selectedDevice.length),_.xp6(10),_.Q6J("checked",t.isCheckedAll()),_.xp6(22),_.Q6J("ngForOf",t.deviceList),_.xp6(8),_.Q6J("ngModel",t.pageLimit),_.xp6(8),_.Q6J("disabled",1===t.pagination),_.xp6(5),_.Q6J("disabled",t.pageLimit>t.deviceList.length),_.xp6(4),_.Q6J("ngIf",t.specialFeatureName===t.FEATURE_AUTOEVENT),_.xp6(1),_.Q6J("ngIf",t.specialFeatureName===t.FEATURE_COMMAND))},directives:[i.O5,C.rH,i.sg,a.EJ,a.JJ,a.On,a.YN,a.Kr,i.RF,i.n9,i.ED,C.yS,P_],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),E})();class B_{constructor(){this.Schema="",this.Host="",this.Port="",this.User="",this.Password="",this.ClientId="",this.CommandTopic=""}}class w_{constructor(){this.Address="",this.Port="",this.UnitID="",this.Timeout="",this.IdleTimeout=""}}class K_{constructor(){this.Address="",this.UnitID="",this.BaudRate="",this.DataBits="",this.StopBits="",this.Parity="",this.Timeout="",this.IdleTimeout=""}}class k_{constructor(){this.Address="",this.Port=""}}class z_{constructor(){this.Address="",this.Port="",this.MACAddress=""}}class Q_{constructor(){this.host="",this.port=""}}function H_(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div",10),_.TgZ(1,"span",11),_.NdJ("click",function(){_.CHM(e);const n=_.oxw(2);return n.changeProtocolTemplateMode(n.TEMPLATE_BUILT_IN)}),_._UZ(2,"i",12),_.TgZ(3,"span"),_.SDv(4,13),_.qZA(),_.qZA(),_.TgZ(5,"span",14),_.NdJ("click",function(){_.CHM(e);const n=_.oxw(2);return n.changeProtocolTemplateMode(n.TEMPLATE_CUSTOM)}),_._UZ(6,"i",12),_.TgZ(7,"span"),_.SDv(8,15),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=_.oxw(2);_.xp6(1),_.ekj("badge-primary",e.protocolTemplateMode===e.TEMPLATE_BUILT_IN)("badge-secondary",e.protocolTemplateMode!==e.TEMPLATE_BUILT_IN),_.xp6(1),_.ekj("fa-check-square",e.protocolTemplateMode===e.TEMPLATE_BUILT_IN),_.xp6(3),_.ekj("badge-primary",e.protocolTemplateMode===e.TEMPLATE_CUSTOM)("badge-secondary",e.protocolTemplateMode!==e.TEMPLATE_CUSTOM),_.xp6(1),_.ekj("fa-check-square",e.protocolTemplateMode===e.TEMPLATE_CUSTOM)}}function j_(E,o){1&E&&_._UZ(0,"div")}function _e(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div"),_.TgZ(1,"form",34),_.TgZ(2,"div",35),_.TgZ(3,"div",36),_.TgZ(4,"span",37),_.SDv(5,38),_.qZA(),_.qZA(),_._UZ(6,"input",39),_.qZA(),_.TgZ(7,"div",40),_._UZ(8,"i",41),_.qZA(),_.TgZ(9,"div",35),_.TgZ(10,"div",36),_.TgZ(11,"span",37),_.SDv(12,42),_.qZA(),_.qZA(),_.TgZ(13,"input",43),_.NdJ("ngModelChange",function(n){const s=_.CHM(e).$implicit;return _.oxw(4).builtinProtocolTemplateSelected[s]=n}),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=o.$implicit,t=_.oxw(4);_.xp6(6),_.Q6J("value",e),_.xp6(7),_.Q6J("ngModel",t.builtinProtocolTemplateSelected[e])}}function ee(E,o){if(1&E&&(_.TgZ(0,"div"),_.YNc(1,_e,14,2,"div",33),_.qZA()),2&E){const e=_.oxw(3);_.xp6(1),_.Q6J("ngForOf",e.builtinProtocolTemplateProperties)}}function te(E,o){1&E&&(_.TgZ(0,"h5",48),_._UZ(1,"i",49),_.TgZ(2,"span"),_.SDv(3,50),_.qZA(),_.qZA())}function Ee(E,o){if(1&E&&(_.TgZ(0,"div"),_._UZ(1,"span",44),_.TgZ(2,"span",45),_.SDv(3,46),_.qZA(),_.qZA(),_.YNc(4,te,4,0,"h5",47)),2&E){const e=_.oxw(3);_.xp6(4),_.Q6J("ngIf",0===e.builtinProtocolTemplateProperties.length&&e.builtinProtocolName)}}function ie(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div",16),_.TgZ(1,"div",17),_.TgZ(2,"form"),_.TgZ(3,"div",18),_.TgZ(4,"label"),_.SDv(5,19),_.qZA(),_.TgZ(6,"select",20),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw(2).builtinProtocolName=n})("ngModelChange",function(){return _.CHM(e),_.oxw(2).onSelectBuiltinProtocolTemplate()}),_.TgZ(7,"option",21),_._uU(8,"device-mqtt"),_.qZA(),_.TgZ(9,"option",22),_._uU(10,"device-rest"),_.qZA(),_.TgZ(11,"option",23),_._uU(12,"device-virtual"),_.qZA(),_.TgZ(13,"option",24),_._uU(14,"device-modbus-tcp"),_.qZA(),_.TgZ(15,"option",25),_._uU(16,"device-modbus-rtu"),_.qZA(),_.TgZ(17,"option",26),_._uU(18,"device-onvif-camera"),_.qZA(),_.TgZ(19,"option",27),_._uU(20,"device-rfid-llrp"),_.qZA(),_.qZA(),_.TgZ(21,"div",28),_.TgZ(22,"small"),_.SDv(23,29),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(24,"div",30),_.YNc(25,ee,2,1,"div",31),_.YNc(26,Ee,5,1,"ng-template",null,32,_.W1O),_.qZA(),_.qZA()}if(2&E){const e=_.MAs(27),t=_.oxw(2);_.xp6(6),_.ekj("is-invalid",!t.builtinProtocolName)("is-valid",t.builtinProtocolName),_.Q6J("ngModel",t.builtinProtocolName),_.xp6(19),_.Q6J("ngIf",0!==t.builtinProtocolTemplateProperties.length)("ngIfElse",e)}}function ne(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div"),_.TgZ(1,"form",34),_.TgZ(2,"div",35),_.TgZ(3,"div",36),_.TgZ(4,"span",37),_.SDv(5,60),_.qZA(),_.qZA(),_.TgZ(6,"input",61),_.NdJ("ngModelChange",function(n){return _.CHM(e).$implicit.propertyName=n}),_.qZA(),_.qZA(),_.TgZ(7,"div",40),_._UZ(8,"i",41),_.qZA(),_.TgZ(9,"div",35),_.TgZ(10,"div",36),_.TgZ(11,"span",37),_.SDv(12,62),_.qZA(),_.qZA(),_.TgZ(13,"input",63),_.NdJ("ngModelChange",function(n){return _.CHM(e).$implicit.propertyValue=n}),_.qZA(),_.qZA(),_.TgZ(14,"div",64),_.TgZ(15,"button",65),_.NdJ("click",function(){const c=_.CHM(e).$implicit;return _.oxw(3).removeCustomProtocolProperty(c)}),_._UZ(16,"i",66),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=o.$implicit;_.xp6(6),_.Q6J("ngModel",e.propertyName),_.xp6(7),_.Q6J("ngModel",e.propertyValue)}}function oe(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div",16),_.TgZ(1,"div",51),_.TgZ(2,"div",18),_.TgZ(3,"label"),_.SDv(4,52),_.qZA(),_.TgZ(5,"input",53),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw(2).customProtocolName=n})("ngModelChange",function(){return _.CHM(e),_.oxw(2).onCustomProtocolNameChange()}),_.qZA(),_.TgZ(6,"div",28),_.TgZ(7,"small"),_.SDv(8,54),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(9,"div",55),_.TgZ(10,"div"),_.TgZ(11,"p",56),_._UZ(12,"span",57),_.TgZ(13,"span",58),_.NdJ("click",function(){return _.CHM(e),_.oxw(2).addCustomProtocolProperty()}),_.SDv(14,59),_.qZA(),_.qZA(),_.qZA(),_.YNc(15,ne,17,2,"div",33),_.qZA(),_.qZA()}if(2&E){const e=_.oxw(2);_.xp6(5),_.ekj("is-invalid",!e.customProtocolName)("is-valid",e.customProtocolName),_.Q6J("ngModel",e.customProtocolName),_.xp6(10),_.Q6J("ngForOf",e.customProtocolPropertyBearer)}}function ce(E,o){if(1&E&&(_.TgZ(0,"div",0),_.TgZ(1,"div",4),_.YNc(2,H_,9,12,"div",6),_.YNc(3,j_,1,0,"div",7),_.YNc(4,ie,28,7,"ng-template",null,8,_.W1O),_.YNc(6,oe,16,6,"ng-template",null,9,_.W1O),_.qZA(),_.qZA()),2&E){const e=_.MAs(5),t=_.MAs(7),n=_.oxw();_.xp6(2),_.Q6J("ngIf",n.mode===n.MODE_ADD),_.xp6(1),_.Q6J("ngIf",n.protocolTemplateMode===n.TEMPLATE_CUSTOM)("ngIfThen",t)("ngIfElse",e)}}let j=(()=>{class E{constructor(){this.MODE_ADD="add",this.MODE_EDIT="edit",this.deviceProtocols={},this.isValid=!1,this.isValidChange=new _.vpe,this.TEMPLATE_CUSTOM="custom",this.TEMPLATE_BUILT_IN="built-in",this.customProtocolPropertyBearer=[],this.builtinProtocolTemplateProperties=[]}ngOnInit(){if(this.mode){if(this.mode==this.MODE_EDIT)return this.protocolTemplateMode=this.TEMPLATE_CUSTOM,this.extractProtocolName(),this.customProtocolName=this.protocolName?this.protocolName:"",void this.setCustomProtocolPropertysBearer();this.mode==this.MODE_ADD&&(this.protocolTemplateMode=this.TEMPLATE_BUILT_IN),this.validate()}}extractProtocolName(){!this.deviceProtocols||0===Object.keys(this.deviceProtocols).length||(this.protocolName=Object.keys(this.deviceProtocols)[0])}onSelectBuiltinProtocolTemplate(){switch(this.validate(),this.builtinProtocolName){case"mqtt":this.builtinProtocolTemplateSelected=new B_;break;case"modbus-tcp":this.builtinProtocolTemplateSelected=new w_;break;case"modbus-rtu":this.builtinProtocolTemplateSelected=new K_;break;case"other":this.builtinProtocolTemplateSelected=new k_;break;case"other-rest":this.builtinProtocolTemplateSelected={};break;case"Onvif":this.builtinProtocolTemplateSelected=new z_;break;case"tcp":this.builtinProtocolTemplateSelected=new Q_;break;default:this.builtinProtocolTemplateSelected={}}this.builtinProtocolTemplateProperties=Object.keys(this.builtinProtocolTemplateSelected)}changeProtocolTemplateMode(e){this.protocolTemplateMode=e,this.validate()}onCustomProtocolNameChange(){this.validate()}setCustomProtocolPropertysBearer(){if(this.customProtocolName)for(const[e,t]of Object.entries(this.deviceProtocols[this.customProtocolName]))this.customProtocolPropertyBearer.push({propertyName:e,propertyValue:t})}addCustomProtocolProperty(){this.customProtocolPropertyBearer.push({propertyName:"",propertyValue:""})}removeCustomProtocolProperty(e){this.customProtocolPropertyBearer.splice(this.customProtocolPropertyBearer.indexOf(e),1)}getDeviceProtocols(){if(this.deviceProtocols={},this.protocolTemplateMode===this.TEMPLATE_BUILT_IN)this.deviceProtocols[this.builtinProtocolName]=Object.assign({},this.builtinProtocolTemplateSelected);else{let e={};this.customProtocolPropertyBearer.forEach(t=>{e[t.propertyName]=t.propertyValue}),this.deviceProtocols[this.customProtocolName]=e}return this.deviceProtocols}validate(){switch(this.isValid=!0,this.protocolTemplateMode){case this.TEMPLATE_BUILT_IN:this.builtinProtocolName||(this.isValid=!1);break;default:this.customProtocolName||(this.isValid=!1)}this.isValidChange.emit(this.isValid)}}return E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-device-protocol"]],inputs:{mode:"mode",deviceProtocols:"deviceProtocols",isValid:"isValid"},outputs:{isValidChange:"isValidChange"},decls:7,vars:1,consts:function(){let o,e,t,n,c,s,I,M,O,g,N,p,f,X;return o="\u8BBE\u5907\u534F\u8BAE",e="\u53EF\u5229\u7528\u7684\u534F\u8BAE\u6A21\u677F",t="\u81EA\u5B9A\u4E49\u534F\u8BAE\u6A21\u677F",n="\u534F\u8BAE\u540D\u5B57",c="\u534F\u8BAE\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",s="PropertyName",I="PropertyVaule",M=" all built-in protocol templates refer to the device service released by edgex, such as device-virtual, device-rest, device-mqtt, device-modbus ",O="\u8BE5\u8BBE\u5907\u670D\u52A1\u4E0D\u9700\u8981\u8BBE\u7F6E\u901A\u4FE1\u534F\u8BAE",g="\u534F\u8BAE\u540D\u5B57",N="\u534F\u8BAE\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",p="\u6DFB\u52A0\u534F\u8BAE\u5C5E\u6027",f="PropertyName",X="PropertyValue",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-tags","fa-lg","text-danger","mr-1"],o,[1,"card-body"],["class","card",4,"ngIf"],["class","mb-2",4,"ngIf"],[4,"ngIf","ngIfThen","ngIfElse"],["builtinProtocolTemplate",""],["customProtocolTemplate",""],[1,"mb-2"],["role","button",1,"user-select-none","badge","font-weight-bold","mr-3",3,"click"],[1,"fa","fa-square-o","mr-1"],e,["role","button",1,"user-select-none","badge","font-weight-bold",3,"click"],t,[1,"row","border","border-secondary","p-2","rounded-lg","mx-1"],[1,"col-md-2","border-right","border-info"],[1,"form-group"],n,["type","text","name","builtinProtocolName","required","",1,"custom-select",3,"ngModel","ngModelChange"],["value","mqtt"],["value","other-rest"],["value","other"],["value","modbus-tcp"],["value","modbus-rtu"],["value","Onvif"],["value","tcp"],[1,"invalid-feedback"],c,[1,"col-md-10"],[4,"ngIf","ngIfElse"],["noBuiltinProperties",""],[4,"ngFor","ngForOf"],[1,"form-inline","mb-1"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],s,["type","text","disabled","",1,"form-control",2,"width","300px",3,"value"],[1,"form-group","mx-2"],[1,"fa","fa-long-arrow-right"],I,["type","text","name","property",1,"form-control",2,"width","300px",3,"ngModel","ngModelChange"],[1,"fa","fa-info-circle","fa-lg","text-success","font-weight-bold","mr-1"],[1,"text-muted"],M,["class","text-warning",4,"ngIf"],[1,"text-warning"],[1,"fa","fa-warning","mr-1"],O,[1,"col-md-2","col-lg-2","border-right","border-secondary"],g,["type","text","name","customProtocolName",1,"form-control",3,"ngModel","ngModelChange"],N,[1,"col-md-10","col-lg-10"],[1,"badge","badge-secondary","font-weight-bold"],[1,"fa","fa-plus-circle","mr-2"],["role","button",1,"user-select-none",3,"click"],p,f,["type","text","name","propertyName",1,"form-control",2,"width","300px",3,"ngModel","ngModelChange"],X,["type","text","name","PropertyValue",1,"form-control",2,"width","300px",3,"ngModel","ngModelChange"],[1,"input-group","ml-2"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._UZ(2,"i",2),_.TgZ(3,"span"),_.SDv(4,3),_.qZA(),_.qZA(),_.TgZ(5,"div",4),_.YNc(6,ce,8,4,"div",5),_.qZA(),_.qZA()),2&e&&(_.xp6(6),_.Q6J("ngIf",t.mode))},directives:[i.O5,a._Y,a.JL,a.F,a.EJ,a.Q7,a.JJ,a.On,a.YN,a.Kr,i.sg,a.Fj],styles:[""]}),E})();var __=d(4889);function se(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"tr"),_.TgZ(1,"td"),_.TgZ(2,"input",35),_.NdJ("click",function(n){const s=_.CHM(e).$implicit;return _.oxw().selectOneSvc(n,s.name)}),_.qZA(),_.qZA(),_.TgZ(3,"td"),_._uU(4),_.qZA(),_.TgZ(5,"td"),_._uU(6),_.qZA(),_.TgZ(7,"td"),_._uU(8),_.qZA(),_.TgZ(9,"td"),_._uU(10),_.qZA(),_.TgZ(11,"td"),_._uU(12),_.qZA(),_.TgZ(13,"td"),_._uU(14),_.ALo(15,"date"),_.qZA(),_.TgZ(16,"td"),_._uU(17),_.ALo(18,"date"),_.qZA(),_.qZA()}if(2&E){const e=o.$implicit,t=_.oxw();_.ekj("table-active",t.isSvcChecked(e.name)),_.xp6(2),_.Q6J("checked",t.isSvcChecked(e.name)),_.xp6(2),_.Oqu(e.id),_.xp6(2),_.Oqu(e.name),_.xp6(2),_.Oqu(e.description),_.xp6(2),_.Oqu(e.labels),_.xp6(2),_.Oqu(e.adminState),_.xp6(2),_.Oqu(_.xi3(15,10,e.created,"yyyy-MM-dd hh:mm:ss")),_.xp6(3),_.Oqu(_.xi3(18,13,e.modified,"yyyy-MM-dd hh:mm:ss"))}}let i_=(()=>{class E{constructor(e){this.metaSvc=e,this.singleDeviceSvcSelectedEvent=new _.vpe,this.deviceServiceList=[],this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.findAllDeviceSvcPagination()}findAllDeviceSvcPagination(){this.metaSvc.findAllDeviceServicesPagination(this.pageOffset,this.pageLimit).subscribe(e=>{this.deviceServiceList=e.services})}onSingleDeviceSvcSelectedEmitter(){this.singleDeviceSvcSelectedEvent.emit(this.deviceSvcSelected)}isSvcChecked(e){var t;return(null===(t=this.deviceSvcSelected)||void 0===t?void 0:t.name)===e}selectOneSvc(e,t){let c=this;e.target.checked?this.deviceServiceList.forEach(function(s){s.name===t&&(c.deviceSvcSelected=s)}):this.deviceSvcSelected=void 0,this.onSingleDeviceSvcSelectedEmitter()}onPageSelected(){this.resetPagination(),this.setPagination(),this.findAllDeviceSvcPagination()}prePage(){this.setPagination(-1),this.findAllDeviceSvcPagination()}nextPage(){this.setPagination(1),this.findAllDeviceSvcPagination()}setPagination(e){1===e?this.pagination+=1:-1===e&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit}resetPagination(){this.pagination=1}}return E.\u0275fac=function(e){return new(e||E)(_.Y36(R.D))},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-device-service-list"]],inputs:{deviceSvcSelected:"deviceSvcSelected"},outputs:{singleDeviceSvcSelectedEvent:"singleDeviceSvcSelectedEvent"},decls:52,vars:4,consts:function(){let o,e,t,n,c,s,I,M,O,g,N;return o="\u8BBE\u5907\u670D\u52A1\u5217\u8868",e="ID",t="\u540D\u5B57",n="\u63CF\u8FF0",c="\u6807\u7B7E",s="\u7BA1\u7406\u72B6\u6001",I="\u521B\u5EFA\u65F6\u95F4",M="\u4FEE\u6539\u65F6\u95F4",O="\u6BCF\u9875\u6761\u76EE",g="\u4E0A\u4E00\u9875",N="\u4E0B\u4E00\u9875",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-list","mr-2","text-danger"],o,[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],e,t,n,c,s,I,M,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],O,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],g,[1,"page-item"],N,[1,"fa","fa-angle-double-right","ml-1"],["type","checkbox","role","button",3,"checked","click"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._UZ(2,"i",2),_.TgZ(3,"span"),_.SDv(4,3),_.qZA(),_.qZA(),_.TgZ(5,"div",4),_.TgZ(6,"div",5),_.TgZ(7,"table",6),_.TgZ(8,"thead",7),_.TgZ(9,"tr"),_.TgZ(10,"th",8),_._uU(11,"#"),_.qZA(),_.TgZ(12,"th",8),_.SDv(13,9),_.qZA(),_.TgZ(14,"th",8),_.SDv(15,10),_.qZA(),_.TgZ(16,"th",8),_.SDv(17,11),_.qZA(),_.TgZ(18,"th",8),_.SDv(19,12),_.qZA(),_.TgZ(20,"th",8),_.SDv(21,13),_.qZA(),_.TgZ(22,"th",8),_.SDv(23,14),_.qZA(),_.TgZ(24,"th",8),_.SDv(25,15),_.qZA(),_.qZA(),_.qZA(),_.TgZ(26,"tbody"),_.YNc(27,se,19,16,"tr",16),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(28,"div",17),_.TgZ(29,"nav",18),_.TgZ(30,"ul",19),_.TgZ(31,"li",20),_.TgZ(32,"span",21),_.SDv(33,22),_.qZA(),_.qZA(),_.TgZ(34,"li",23),_.TgZ(35,"select",24),_.NdJ("ngModelChange",function(c){return t.pageLimit=c})("ngModelChange",function(){return t.onPageSelected()}),_.TgZ(36,"option",25),_._uU(37,"5"),_.qZA(),_.TgZ(38,"option",26),_._uU(39,"10"),_.qZA(),_.TgZ(40,"option",27),_._uU(41,"20"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(42,"li",28),_.TgZ(43,"button",29),_.NdJ("click",function(){return t.prePage()}),_._UZ(44,"i",30),_.TgZ(45,"span"),_.SDv(46,31),_.qZA(),_.qZA(),_.qZA(),_.TgZ(47,"li",32),_.TgZ(48,"button",29),_.NdJ("click",function(){return t.nextPage()}),_.TgZ(49,"span"),_.SDv(50,33),_.qZA(),_._UZ(51,"i",34),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&e&&(_.xp6(27),_.Q6J("ngForOf",t.deviceServiceList),_.xp6(8),_.Q6J("ngModel",t.pageLimit),_.xp6(8),_.Q6J("disabled",1===t.pagination),_.xp6(5),_.Q6J("disabled",t.pageLimit>t.deviceServiceList.length))},directives:[i.sg,a.EJ,a.JJ,a.On,a.YN,a.Kr],pipes:[i.uU],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),E})();var t_=d(2822);function ae(E,o){if(1&E&&(_.TgZ(0,"option",37),_._uU(1),_.qZA()),2&E){const e=o.$implicit;_.s9C("value",e),_.xp6(1),_.Oqu(e)}}function le(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div",10),_.TgZ(1,"div",4),_.TgZ(2,"form"),_.TgZ(3,"div",11),_.TgZ(4,"label",12),_.SDv(5,13),_.qZA(),_.TgZ(6,"div",14),_.TgZ(7,"div",15),_.TgZ(8,"input",16),_.NdJ("ngModelChange",function(n){return _.CHM(e).$implicit.interval=n})("ngModelChange",function(){return _.CHM(e),_.oxw().onValueChange()}),_.qZA(),_.TgZ(9,"div",17),_.TgZ(10,"select",18),_.NdJ("ngModelChange",function(n){return _.CHM(e).$implicit.unit=n})("ngModelChange",function(){return _.CHM(e),_.oxw().onValueChange()}),_.TgZ(11,"option",19),_._uU(12,"millisecond"),_.qZA(),_.TgZ(13,"option",20),_._uU(14,"second"),_.qZA(),_.TgZ(15,"option",21),_._uU(16,"minute"),_.qZA(),_.TgZ(17,"option",22),_._uU(18,"hour"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(19,"div",23),_.SDv(20,24),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(21,"div",25),_.TgZ(22,"label",12),_.SDv(23,26),_.qZA(),_.TgZ(24,"div",14),_.TgZ(25,"select",27),_.NdJ("ngModelChange",function(n){return _.CHM(e).$implicit.onChange=n})("ngModelChange",function(){return _.CHM(e),_.oxw().onValueChange()}),_.TgZ(26,"option",28),_._uU(27,"true"),_.qZA(),_.TgZ(28,"option",29),_._uU(29,"false"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(30,"div",25),_.TgZ(31,"label",12),_.SDv(32,30),_.qZA(),_.TgZ(33,"div",14),_.TgZ(34,"select",31),_.NdJ("ngModelChange",function(n){return _.CHM(e).$implicit.resource=n})("ngModelChange",function(){return _.CHM(e),_.oxw().onValueChange()}),_.YNc(35,ae,2,2,"option",32),_.qZA(),_.TgZ(36,"div",23),_.SDv(37,33),_.qZA(),_.qZA(),_.qZA(),_.TgZ(38,"button",34),_.NdJ("click",function(){const c=_.CHM(e).$implicit;return _.oxw().removeAutoEvent(c)}),_._UZ(39,"i",35),_.TgZ(40,"span"),_.SDv(41,36),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=o.$implicit,t=_.oxw();_.xp6(8),_.ekj("is-invalid",!t.eventIntervalNumType(e.interval))("is-valid",t.eventIntervalNumType(e.interval)),_.Q6J("ngModel",e.interval),_.xp6(2),_.Q6J("ngModel",e.unit),_.xp6(15),_.Q6J("ngModel",e.onChange),_.xp6(9),_.ekj("is-invalid",""===e.resource)("is-valid",""!==e.resource),_.Q6J("ngModel",e.resource),_.xp6(1),_.Q6J("ngForOf",t.autoEventResourceNameSet)}}let n_=(()=>{class E{constructor(){this.autoEvents=[],this.autoEventsChange=new _.vpe,this.isValid=!1,this.isValidChange=new _.vpe,this.autoEventDecoratorBearer=[],this.autoEventResourceNameSet=[]}ngOnInit(){}ngOnChanges(){this.resetAutoEventDecoratorBearer(),this.setAutoEventDecorator(this.autoEvents),this.setupAutoEventResourceNameSet(this.deviceProfile),this.resumeOriginalAutoEvents()}onValueChange(){this.resumeOriginalAutoEvents()}resetAutoEventDecoratorBearer(){this.autoEventDecoratorBearer.splice(0,this.autoEventDecoratorBearer.length)}addAutoEvent(){this.autoEventDecoratorBearer.push({interval:"",onChange:!1,resource:"",unit:"ms"}),this.resumeOriginalAutoEvents()}removeAutoEvent(e){this.autoEventDecoratorBearer.splice(this.autoEventDecoratorBearer.indexOf(e),1),this.resumeOriginalAutoEvents()}setupAutoEventResourceNameSet(e){!e||(this.autoEventResourceNameSet.splice(0,this.autoEventResourceNameSet.length),e.deviceResources.forEach((t,n)=>{this.autoEventResourceNameSet.push(t.name)}),e.deviceCommands.forEach((t,n)=>{this.autoEventResourceNameSet.push(t.name)}))}eventIntervalNumType(e){return!isNaN(e)&&parseFloat(e)===parseInt(e)}setAutoEventDecorator(e){!e||e.forEach(t=>{let n=0;-1!==t.interval.indexOf("ms")?n=t.interval.indexOf("ms"):-1!==t.interval.indexOf("s")?n=t.interval.indexOf("s"):-1!==t.interval.indexOf("m")?n=t.interval.indexOf("m"):-1!==t.interval.indexOf("h")&&(n=t.interval.indexOf("h")),this.autoEventDecoratorBearer.push({interval:t.interval.slice(0,n),onChange:!!t.onChange&&t.onChange,resource:t.sourceName,unit:t.interval.substring(n)})})}resumeOriginalAutoEvents(){this.autoEvents?this.autoEvents.splice(0,this.autoEvents.length):this.autoEvents=[],this.autoEventDecoratorBearer.forEach(e=>{this.autoEvents.push({interval:`${e.interval}${e.unit}`,onChange:!!e.onChange,sourceName:e.resource})}),this.validate(),this.autoEventsChange.emit(this.autoEvents)}validate(){this.isValid=!0,0!==this.autoEventDecoratorBearer.length&&this.autoEventDecoratorBearer.forEach(e=>{this.eventIntervalNumType(e.interval)&&""!==e.resource||(this.isValid=!1)}),this.isValidChange.emit(this.isValid)}}return E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-device-auto-event"]],inputs:{autoEvents:"autoEvents",deviceProfile:"deviceProfile",isValid:"isValid"},outputs:{autoEventsChange:"autoEventsChange",isValidChange:"isValidChange"},features:[_.TTD],decls:11,vars:1,consts:function(){let o,e,t,n,c,s,I,M;return o="\u81EA\u52A8\u91C7\u96C6",e="\u6DFB\u52A0\u66F4\u591A\u81EA\u52A8\u91C7\u96C6\u4E8B\u4EF6",t="\u5355\u4F4D\u95F4\u9694",n=" can only be a pure integer number ",c="onchange",s="\u8BBE\u5907\u8D44\u6E90",I=" resource can't be empty ",M="\u5220\u9664",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-tags","fa-lg","text-danger","mr-1"],o,[1,"card-body"],[1,"badge","badge-secondary","font-weight-bold"],[1,"fa","fa-plus-circle","mr-2"],["role","button",1,"user-select-none",3,"click"],e,["class","card mb-3",4,"ngFor","ngForOf"],[1,"card","mb-3"],[1,"form-group","row","has-validation"],[1,"col-md-2","col-form-label"],t,[1,"col-md-10"],[1,"input-group","mb-3",2,"width","250px"],["type","text","name","interval","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],["name","eventIntervalUnit","required","",1,"custom-select",3,"ngModel","ngModelChange"],["value","ms"],["value","s"],["value","m"],["value","h"],[1,"invalid-feedback"],n,[1,"form-group","row"],c,["name","onchange",1,"custom-select",2,"width","250px",3,"ngModel","ngModelChange"],["value","true"],["value","false"],s,["name","resource","required","",1,"custom-select",2,"width","250px",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],I,[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash","mr-1"],M,[3,"value"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._UZ(2,"i",2),_.TgZ(3,"span"),_.SDv(4,3),_.qZA(),_.qZA(),_.TgZ(5,"div",4),_.TgZ(6,"p",5),_._UZ(7,"span",6),_.TgZ(8,"span",7),_.NdJ("click",function(){return t.addAutoEvent()}),_.SDv(9,8),_.qZA(),_.qZA(),_.YNc(10,le,42,13,"div",9),_.qZA(),_.qZA()),2&e&&(_.xp6(10),_.Q6J("ngForOf",t.autoEventDecoratorBearer))},directives:[i.sg,a._Y,a.JL,a.F,a.Fj,a.Q7,a.JJ,a.On,a.EJ,a.YN,a.Kr],styles:[""]}),E})();function re(E,o){1&E&&_._UZ(0,"i",33)}function Te(E,o){1&E&&_._UZ(0,"i",33)}function de(E,o){1&E&&_._UZ(0,"i",33)}function Ie(E,o){1&E&&_._UZ(0,"i",33)}function Ce(E,o){1&E&&_._UZ(0,"i",33)}function De(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"button",34),_.NdJ("click",function(){return _.CHM(e),_.oxw().previous()}),_._UZ(1,"i",35),_.TgZ(2,"span"),_.SDv(3,36),_.qZA(),_.qZA()}}function Oe(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"button",37),_.NdJ("click",function(){return _.CHM(e),_.oxw().next()}),_.TgZ(1,"span"),_.SDv(2,38),_.qZA(),_._UZ(3,"i",39),_.qZA()}if(2&E){const e=_.oxw();_.Q6J("disabled",e.stepStateLock())}}function Ae(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"button",40),_.NdJ("click",function(){return _.CHM(e),_.oxw().submit()}),_._UZ(1,"i",41),_.TgZ(2,"span"),_.SDv(3,42),_.qZA(),_.qZA()}if(2&E){const e=_.oxw();_.Q6J("disabled",e.stepStateLock())}}function Se(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div",43),_.TgZ(1,"app-device-service-list",44),_.NdJ("singleDeviceSvcSelectedEvent",function(n){return _.CHM(e),_.oxw().onSingleDeviceSvcSelected(n)}),_.qZA(),_.qZA()}if(2&E){const e=_.oxw();_.xp6(1),_.Q6J("deviceSvcSelected",e.selectedSvc)}}function ge(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div",43),_.TgZ(1,"app-device-profile-list",45),_.NdJ("singleProfileSelectedEvent",function(n){return _.CHM(e),_.oxw().onSingleProfileSelected(n)}),_.qZA(),_.qZA()}if(2&E){const e=_.oxw();_.xp6(1),_.Q6J("singleProfileSelected",e.selectedProfile)("enableSelectAll",!1)("toolbars",!1)("associatedDeviceColumn",!1)}}function Re(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"form",46),_.TgZ(1,"div",47),_.TgZ(2,"label",48),_.SDv(3,49),_.qZA(),_.TgZ(4,"div",50),_.TgZ(5,"input",51),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().newDevice.name=n}),_.qZA(),_.TgZ(6,"div",52),_.TgZ(7,"small"),_.SDv(8,53),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(9,"div",54),_.TgZ(10,"label",55),_.SDv(11,56),_.qZA(),_.TgZ(12,"div",50),_.TgZ(13,"input",57),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().newDevice.description=n}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(14,"div",54),_.TgZ(15,"label",58),_.SDv(16,59),_.qZA(),_.TgZ(17,"div",50),_.TgZ(18,"input",60),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().deviceLabels=n}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(19,"div",54),_.TgZ(20,"label",61),_.SDv(21,62),_.qZA(),_.TgZ(22,"div",50),_.TgZ(23,"select",63),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().newDevice.adminState=n}),_.TgZ(24,"option",64),_._uU(25,"UNLOCKED"),_.qZA(),_.TgZ(26,"option",65),_._uU(27,"LOCKED"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=_.oxw();_.xp6(5),_.ekj("is-invalid",!e.newDevice.name)("is-valid",e.newDevice.name),_.Q6J("ngModel",e.newDevice.name),_.xp6(8),_.Q6J("ngModel",e.newDevice.description),_.xp6(5),_.Q6J("ngModel",e.deviceLabels),_.xp6(5),_.Q6J("ngModel",e.newDevice.adminState)}}function pe(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div",30),_.TgZ(1,"div",1),_.TgZ(2,"span",66),_.SDv(3,67),_.qZA(),_.qZA(),_.TgZ(4,"div",31),_.TgZ(5,"app-device-auto-event",68),_.NdJ("autoEventsChange",function(n){return _.CHM(e),_.oxw().newDevice.autoEvents=n})("isValidChange",function(n){return _.CHM(e),_.oxw().isAutoEventsValid=n}),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=_.oxw();_.xp6(5),_.Q6J("deviceProfile",e.selectedProfile)("autoEvents",e.newDevice.autoEvents)("isValid",e.isAutoEventsValid)}}let ue=(()=>{class E{constructor(e,t,n,c,s){this.metaSvc=e,this.msgSvc=t,this.errorSvc=n,this.router=c,this.route=s,this.deviceLabels="",this.currentStep=0,this.selectedClass="text-white rounded px-2 bg-success  font-weight-bold",this.noSelectedClass="text-white rounded px-2 bg-secondary  font-weight-bold",this.isProtocolValid=!1,this.isAutoEventsValid=!1,this.newDevice={adminState:"UNLOCKED",operatingState:"UP"}}ngOnInit(){}onSingleProfileSelected(e){this.selectedProfile=e}onSingleDeviceSvcSelected(e){this.selectedSvc=e}stepStateLock(){switch(this.currentStep){case 0:return void 0===this.selectedSvc;case 1:return void 0===this.selectedProfile;case 2:return!this.newDevice.name;case 3:return!this.isAutoEventsValid;case 4:return!this.isProtocolValid;default:return!1}}next(){this.currentStep+=1}previous(){this.currentStep=this.currentStep-1}submit(){var e,t,n;this.newDevice.labels=null===(e=this.deviceLabels)||void 0===e?void 0:e.split(","),this.newDevice.serviceName=null===(t=this.selectedSvc)||void 0===t?void 0:t.name,this.newDevice.profileName=null===(n=this.selectedProfile)||void 0===n?void 0:n.name,this.newDevice.protocols=this.deviceProtocols.getDeviceProtocols(),this.metaSvc.addDevice(this.newDevice).subscribe(c=>{this.errorSvc.handleErrorForV2API(c)||(this.msgSvc.success("Add device",`name: ${this.newDevice.name}`),this.router.navigate(["../device-list"],{relativeTo:this.route}))})}}return E.\u0275fac=function(e){return new(e||E)(_.Y36(R.D),_.Y36(Z.e),_.Y36(__.T),_.Y36(C.F0),_.Y36(C.gz))},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-add-device"]],viewQuery:function(e,t){if(1&e&&_.Gf(j,5),2&e){let n;_.iGM(n=_.CRH())&&(t.deviceProtocols=n.first)}},decls:54,vars:22,consts:function(){let o,e,t,n,c,s,I,M,O,g,N,p,f,X,U;return o="\u8BBE\u5907\u6DFB\u52A0\u5411\u5BFC",e="\u9009\u62E9\u8BBE\u5907\u670D\u52A1",t="\u9009\u62E9\u8BBE\u5907\u5143\u4FE1\u606F",n="\u8BBE\u5907\u4FE1\u606F",c="\u521B\u5EFA\u81EA\u52A8\u4E8B\u4EF6",s="\u521B\u5EFA\u8BBE\u5907\u901A\u4FE1\u534F\u8BAE",I="\u4E0A\u4E00\u9875",M="\u4E0B\u4E00\u9875",O="\u63D0\u4EA4",g="\u540D\u5B57",N="\u8BBE\u5907\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",p="\u63CF\u8FF0",f="\u6807\u7B7E",X="\u7BA1\u7406\u72B6\u6001",U=" this step is optional, you can skip it then set it later in edit mode.",[[1,"card"],[1,"card-header"],[1,"font-weight-bold"],[1,"fa","fa-lightbulb-o","fa-lg","mr-2","text-danger"],[1,"text-secondary"],o,[1,"card-header","py-2"],["aria-label","breadcrumb",1,"mb-0","p-0"],[1,"breadcrumb","p-1","mb-0","bg-light"],[1,"breadcrumb-item"],[3,"ngClass"],e,["class","fa fa-check ml-1",4,"ngIf"],t,n,c,[1,"breadcrumb-item","active"],s,[1,"card-header","py-1"],["class","btn btn-info btn-sm",3,"click",4,"ngIf"],["class","btn btn-primary btn-sm float-right",3,"disabled","click",4,"ngIf","ngIfElse"],["stepDone",""],[1,"card-body","p-0"],[3,"ngSwitch"],[3,"ngSwitchCase"],["SelectDeviceService",""],["SelectDeviceProfile",""],["DevicePrimary",""],["CreateAutoEvent",""],["CreateDeviceProtocol",""],[1,"card","border-0"],[1,"card-body"],[3,"mode","isValid","isValidChange"],[1,"fa","fa-check","ml-1"],[1,"btn","btn-info","btn-sm",3,"click"],[1,"fa","fa-long-arrow-left","mr-1"],I,[1,"btn","btn-primary","btn-sm","float-right",3,"disabled","click"],M,[1,"fa","fa-long-arrow-right","ml-1"],[1,"btn","btn-success","btn-sm","ml-4","float-right",3,"disabled","click"],[1,"fa","fa-save","mr-1"],O,[1,"p-2"],[3,"deviceSvcSelected","singleDeviceSvcSelectedEvent"],[3,"singleProfileSelected","enableSelectAll","toolbars","associatedDeviceColumn","singleProfileSelectedEvent"],[1,"px-5","py-4"],[1,"form-group","row","has-validation"],["for","deviceName","required","",1,"col-md-2","col-form-label"],g,[1,"col-md-10"],["type","text","id","validationDeviceNameFeedback","name","deviceName",1,"form-control",3,"ngModel","ngModelChange"],["id","validationDeviceNameFeedback",1,"invalid-feedback"],N,[1,"form-group","row"],["for","deviceDesc",1,"col-md-2","col-form-label"],p,["type","text","name","deviceDescription",1,"form-control",3,"ngModel","ngModelChange"],["for","deviceLabels",1,"col-md-2","col-form-label"],f,["type","text","name","deviceLabels","placeholder","Multiple Labels are separated by commas: label1,label2,label3",1,"form-control",3,"ngModel","ngModelChange"],["for","adminState",1,"col-md-2","col-form-label"],X,["name","deviceAdminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"],[1,"fa","fa-info-circle","text-warning","font-weight-bold"],U,[3,"deviceProfile","autoEvents","isValid","autoEventsChange","isValidChange"]]},template:function(e,t){if(1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"span",2),_._UZ(3,"span",3),_.TgZ(4,"span",4),_.SDv(5,5),_.qZA(),_.qZA(),_.qZA(),_.TgZ(6,"div",6),_.TgZ(7,"nav",7),_.TgZ(8,"ol",8),_.TgZ(9,"li",9),_.TgZ(10,"span",10),_.TgZ(11,"span"),_.SDv(12,11),_.qZA(),_.YNc(13,re,1,0,"i",12),_.qZA(),_.qZA(),_.TgZ(14,"li",9),_.TgZ(15,"span",10),_.TgZ(16,"span"),_.SDv(17,13),_.qZA(),_.YNc(18,Te,1,0,"i",12),_.qZA(),_.qZA(),_.TgZ(19,"li",9),_.TgZ(20,"span",10),_.TgZ(21,"span"),_.SDv(22,14),_.qZA(),_.YNc(23,de,1,0,"i",12),_.qZA(),_.qZA(),_.TgZ(24,"li",9),_.TgZ(25,"span",10),_.TgZ(26,"span"),_.SDv(27,15),_.qZA(),_.YNc(28,Ie,1,0,"i",12),_.qZA(),_.qZA(),_.TgZ(29,"li",16),_.TgZ(30,"span",10),_.TgZ(31,"span"),_.SDv(32,17),_.qZA(),_.YNc(33,Ce,1,0,"i",12),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(34,"div",18),_.YNc(35,De,4,0,"button",19),_.YNc(36,Oe,4,1,"button",20),_.YNc(37,Ae,4,1,"ng-template",null,21,_.W1O),_.qZA(),_.TgZ(39,"div",22),_.TgZ(40,"div",23),_.YNc(41,Se,2,1,"ng-template",24,25,_.W1O),_.YNc(43,ge,2,4,"ng-template",24,26,_.W1O),_.YNc(45,Re,28,8,"ng-template",24,27,_.W1O),_.YNc(47,pe,6,3,"ng-template",24,28,_.W1O),_.TgZ(49,"div",null,29),_.TgZ(51,"div",30),_.TgZ(52,"div",31),_.TgZ(53,"app-device-protocol",32),_.NdJ("isValidChange",function(c){return t.isProtocolValid=c}),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&e){const n=_.MAs(38);_.xp6(10),_.Q6J("ngClass",t.currentStep>=0?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=1),_.xp6(2),_.Q6J("ngClass",t.currentStep>=1?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=2),_.xp6(2),_.Q6J("ngClass",t.currentStep>=2?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=3),_.xp6(2),_.Q6J("ngClass",t.currentStep>=3?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=4),_.xp6(2),_.Q6J("ngClass",t.currentStep>=4?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=5),_.xp6(2),_.Q6J("ngIf",t.currentStep),_.xp6(1),_.Q6J("ngIf",4>t.currentStep)("ngIfElse",n),_.xp6(4),_.Q6J("ngSwitch",t.currentStep),_.xp6(1),_.Q6J("ngSwitchCase",0),_.xp6(2),_.Q6J("ngSwitchCase",1),_.xp6(2),_.Q6J("ngSwitchCase",2),_.xp6(2),_.Q6J("ngSwitchCase",3),_.xp6(2),_.Udp("display",4===t.currentStep?"":"none"),_.xp6(4),_.Q6J("mode","add")("isValid",t.isProtocolValid)}},directives:[i.mk,i.O5,i.RF,i.n9,j,i_,t_.f,a._Y,a.JL,a.F,a.Fj,a.JJ,a.On,a.EJ,a.YN,a.Kr,n_],styles:['.breadcrumb[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] + li[_ngcontent-%COMP%]:before{color:inherit;font-weight:inherit;content:">>";padding:0 5px}.btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}']}),E})();function Me(E,o){if(1&E){const e=_.EpF();_.TgZ(0,"div",1),_.TgZ(1,"div",2),_._UZ(2,"i",3),_.TgZ(3,"span",4),_.SDv(4,5),_.qZA(),_.TgZ(5,"span",6),_._uU(6),_.qZA(),_.TgZ(7,"button",7),_.NdJ("click",function(){return _.CHM(e),_.oxw().save()}),_.TgZ(8,"span"),_._UZ(9,"i",8),_.TgZ(10,"span"),_.SDv(11,9),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(12,"div",10),_.TgZ(13,"div",11),_.TgZ(14,"div",2),_._UZ(15,"i",12),_.TgZ(16,"span"),_.SDv(17,13),_.qZA(),_.qZA(),_.TgZ(18,"div",10),_.TgZ(19,"form"),_.TgZ(20,"div",14),_.TgZ(21,"label",15),_.SDv(22,16),_.qZA(),_.TgZ(23,"div",17),_.TgZ(24,"input",18),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().device.name=n}),_.qZA(),_.TgZ(25,"div",19),_.SDv(26,20),_.qZA(),_.qZA(),_.qZA(),_.TgZ(27,"div",14),_.TgZ(28,"label",15),_.SDv(29,21),_.qZA(),_.TgZ(30,"div",17),_.TgZ(31,"input",22),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().device.description=n}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(32,"div",14),_.TgZ(33,"label",15),_.SDv(34,23),_.qZA(),_.TgZ(35,"div",17),_.TgZ(36,"input",24),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().deviceLabels=n}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(37,"div",14),_.TgZ(38,"label",25),_.SDv(39,26),_.qZA(),_.TgZ(40,"div",17),_.TgZ(41,"select",27),_.NdJ("ngModelChange",function(n){return _.CHM(e),_.oxw().device.adminState=n}),_.TgZ(42,"option",28),_._uU(43,"UNLOCKED"),_.qZA(),_.TgZ(44,"option",29),_._uU(45,"LOCKED"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(46,"div",14),_.TgZ(47,"label",30),_.SDv(48,31),_.qZA(),_.TgZ(49,"div",17),_._UZ(50,"input",32),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(51,"div",33),_.TgZ(52,"app-device-service-list",34),_.NdJ("singleDeviceSvcSelectedEvent",function(n){return _.CHM(e),_.oxw().onSingleDeviceSvcSelected(n)}),_.qZA(),_.qZA(),_.TgZ(53,"div",33),_.TgZ(54,"app-device-profile-list",35),_.NdJ("singleProfileSelectedEvent",function(n){return _.CHM(e),_.oxw().onSingleProfileSelected(n)}),_.qZA(),_.qZA(),_.TgZ(55,"div",33),_.TgZ(56,"app-device-protocol",36),_.NdJ("isValidChange",function(n){return _.CHM(e),_.oxw().isProtocolValid=n}),_.qZA(),_.qZA(),_.TgZ(57,"div",33),_.TgZ(58,"app-device-auto-event",37),_.NdJ("autoEventsChange",function(n){return _.CHM(e),_.oxw().device.autoEvents=n})("isValidChange",function(n){return _.CHM(e),_.oxw().isAutoEventsValid=n}),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&E){const e=_.oxw();_.xp6(6),_.Oqu(e.device.name),_.xp6(1),_.Q6J("disabled",e.validateBeforeSave()),_.xp6(17),_.ekj("is-invalid",""===e.device.name),_.Q6J("ngModel",e.device.name),_.xp6(7),_.Q6J("ngModel",e.device.description),_.xp6(5),_.Q6J("ngModel",e.deviceLabels),_.xp6(5),_.Q6J("ngModel",e.device.adminState),_.xp6(9),_.Q6J("value",e.device.operatingState),_.xp6(2),_.Q6J("deviceSvcSelected",e.selectedSvc),_.xp6(2),_.Q6J("enableSelectAll",!1)("toolbars",!1)("singleProfileSelected",e.selectedProfile)("associatedDeviceColumn",!1),_.xp6(2),_.Q6J("mode","edit")("deviceProtocols",e.device.protocols)("isValid",e.isProtocolValid),_.xp6(2),_.Q6J("deviceProfile",e.selectedProfile)("autoEvents",e.device.autoEvents)("isValid",e.isAutoEventsValid)}}let fe=(()=>{class E{constructor(e,t,n,c,s){this.router=e,this.route=t,this.metaSvc=n,this.msgSvc=c,this.errorSvc=s,this.isProtocolValid=!0,this.isAutoEventsValid=!0}ngOnInit(){this.route.queryParams.subscribe(e=>{!e.deviceName||this.metaSvc.findDeviceByName(e.deviceName).subscribe(n=>{var c;this.device=n.device,this.deviceLabels=null===(c=this.device.labels)||void 0===c?void 0:c.join(","),this.setDefaultDeviceSvcSelected(this.device.serviceName),this.setDefaultDeviceProfileSelected(this.device.profileName)})})}onSingleProfileSelected(e){this.selectedProfile=e}onSingleDeviceSvcSelected(e){this.selectedSvc=e}setDefaultDeviceSvcSelected(e){this.metaSvc.findDevcieServiceByName(e).subscribe(t=>{this.selectedSvc=t.service})}setDefaultDeviceProfileSelected(e){this.metaSvc.findProfileByName(e).subscribe(t=>{this.selectedProfile=t.profile})}validateBeforeSave(){return""===this.device.name||!this.isAutoEventsValid||!this.isProtocolValid}save(){var e,t,n;this.device.labels=null===(e=this.deviceLabels)||void 0===e?void 0:e.split(","),this.device.serviceName=null===(t=this.selectedSvc)||void 0===t?void 0:t.name,this.device.profileName=null===(n=this.selectedProfile)||void 0===n?void 0:n.name,this.device.protocols=this.deviceProtocols.getDeviceProtocols(),this.metaSvc.updateDevice(this.device).subscribe(c=>{var s;this.errorSvc.handleErrorForV2API(c)||(this.msgSvc.success("update device",`name: ${null===(s=this.device)||void 0===s?void 0:s.name}`),this.router.navigate(["../device-list"],{relativeTo:this.route}))})}}return E.\u0275fac=function(e){return new(e||E)(_.Y36(C.F0),_.Y36(C.gz),_.Y36(R.D),_.Y36(Z.e),_.Y36(__.T))},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-edit-device"]],viewQuery:function(e,t){if(1&e&&_.Gf(j,5),2&e){let n;_.iGM(n=_.CRH())&&(t.deviceProtocols=n.first)}},decls:1,vars:1,consts:function(){let o,e,t,n,c,s,I,M,O;return o="\u7F16\u8F91\u8BBE\u5907",e="\u4FDD\u5B58",t="\u8BBE\u5907\u57FA\u672C\u4FE1\u606F",n="\u8BBE\u5907\u540D\u5B57",c="\u8BBE\u5907\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A\uFF01",s="\u63CF\u8FF0",I="\u6807\u7B7E",M="\u7BA1\u7406\u72B6\u6001",O="\u64CD\u4F5C\u72B6\u6001",[["class","card",4,"ngIf"],[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-edit","text-danger","fa-lg"],[1,"mx-2"],o,[1,"text-primary"],["type","button",1,"btn","btn-success","btn-sm","float-right",3,"disabled","click"],[1,"fa","fa-save","mr-1"],e,[1,"card-body"],[1,"card","mb-3"],[1,"fa","fa-tags","fa-lg","text-danger","mr-1"],t,[1,"form-group","row"],[1,"col-md-2","col-form-label"],n,[1,"col-md-10"],["type","text","name","name","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"invalid-feedback"],c,s,["type","text","name","description",1,"form-control",3,"ngModel","ngModelChange"],I,["type","text","name","labels",1,"form-control",3,"ngModel","ngModelChange"],["for","adminState",1,"col-md-2","col-form-label"],M,["name","adminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"],["for","operatingState",1,"col-md-2","col-form-label"],O,["type","text","name","operatingState","disabled","",1,"form-control",3,"value"],[1,"mb-3"],[3,"deviceSvcSelected","singleDeviceSvcSelectedEvent"],[3,"enableSelectAll","toolbars","singleProfileSelected","associatedDeviceColumn","singleProfileSelectedEvent"],[3,"mode","deviceProtocols","isValid","isValidChange"],[3,"deviceProfile","autoEvents","isValid","autoEventsChange","isValidChange"]]},template:function(e,t){1&e&&_.YNc(0,Me,59,20,"div",0),2&e&&_.Q6J("ngIf",t.device)},directives:[i.O5,a._Y,a.JL,a.F,a.Fj,a.Q7,a.JJ,a.On,a.EJ,a.YN,a.Kr,i_,t_.f,j,n_],styles:["input[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}.btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),E})(),me=(()=>{class E{constructor(){}ngOnInit(){}}return E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-device-profile-center"]],decls:1,vars:0,template:function(e,t){1&e&&_._UZ(0,"router-outlet")},directives:[C.lC],styles:[""]}),E})(),Ue=(()=>{class E{constructor(e,t,n,c,s){this.metaSvc=e,this.msgSvc=t,this.errSvc=n,this.router=c,this.route=s}ngOnInit(){this.renderYamlSource()}renderYamlSource(){let e=document.getElementById("editor");this.codeMirrorEditor=CodeMirror.fromTextArea(e,{mode:"yaml",theme:"gruvbox-dark",foldGutter:!0,smartIndent:!0,showCursorWhenSelecting:!0,lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],autofocus:!0,matchBrackets:!0,autoCloseBrackets:!0,styleActiveLine:!0,cursorHeight:.85,autocorrect:!0}),this.codeMirrorEditor.setSize("auto","600px"),this.codeMirrorEditor.on("drop",(t,n)=>{var c;this.yamlFile=null===(c=n.dataTransfer)||void 0===c?void 0:c.files[0]}),this.codeMirrorEditor.on("paste",(t,n)=>{})}submit(){this.profileYamlSource=this.codeMirrorEditor.getValue(),this.metaSvc.addProfileYamlByNameViaUIBackend(this.profileYamlSource).subscribe(e=>{this.errSvc.handleErrorForV2API(e)||(this.msgSvc.success("Add profile"),this.router.navigate(["../device-profile-list"],{relativeTo:this.route}))})}}return E.\u0275fac=function(e){return new(e||E)(_.Y36(R.D),_.Y36(Z.e),_.Y36(__.T),_.Y36(C.F0),_.Y36(C.gz))},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-add-profile"]],decls:15,vars:0,consts:function(){let o,e,t;return o="\u6DFB\u52A0\u8BBE\u5907\u5143\u4FE1\u606F",e="\u62D6\u62FD\u529F\u80FD\u5DF2\u5F00\u542F",t="\u63D0\u4EA4",[[1,"card"],[1,"card-header"],[1,"text-danger","font-weight-bold","fa","fa-code","mr-2"],[1,"mr-3","font-weight-bold"],o,[1,"fa","fa-info-circle","text-success","font-weight-bold"],e,[1,"float-right"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save","mr-1"],t,[1,"card-body","p-0"],["id","editor","name","editor"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"span"),_._UZ(3,"span",2),_.TgZ(4,"span",3),_.SDv(5,4),_.qZA(),_.TgZ(6,"span",5),_.SDv(7,6),_.qZA(),_.qZA(),_.TgZ(8,"span",7),_.TgZ(9,"button",8),_.NdJ("click",function(){return t.submit()}),_._UZ(10,"i",9),_.TgZ(11,"span"),_.SDv(12,10),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(13,"div",11),_._UZ(14,"textarea",12),_.qZA(),_.qZA())},styles:[""]}),E})(),ve=(()=>{class E{constructor(e,t,n,c,s){this.metaSvc=e,this.msgSvc=t,this.errSvc=n,this.router=c,this.route=s}ngOnInit(){this.renderYamlSource(),this.route.queryParams.subscribe(e=>{e.profileName&&(this.profileName=e.profileName,this.metaSvc.findProfileYamlByNameViaUIBackend(e.profileName).subscribe(t=>{this.codeMirrorEditor.setValue(t),this.codeMirrorEditor.refresh()}))})}update(){this.codeMirrorEditor.refresh(),this.metaSvc.updateProfileYamlContentViaUIBackend(this.codeMirrorEditor.getValue()).subscribe(e=>{this.errSvc.handleErrorForV2API(e)||(this.msgSvc.success("Update profile",`name: ${this.profileName}`),this.router.navigate(["../device-profile-list"],{relativeTo:this.route}))})}renderYamlSource(){let e=document.getElementById("editor-edit");this.codeMirrorEditor=CodeMirror.fromTextArea(e,{mode:"yaml",theme:"gruvbox-dark",foldGutter:!0,smartIndent:!0,showCursorWhenSelecting:!0,lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],autofocus:!0,matchBrackets:!0,autoCloseBrackets:!0,styleActiveLine:!0,cursorHeight:.85,autocorrect:!0}),this.codeMirrorEditor.setSize("auto","600px")}ngOnDestroy(){this.codeMirrorEditor=null}}return E.\u0275fac=function(e){return new(e||E)(_.Y36(R.D),_.Y36(Z.e),_.Y36(__.T),_.Y36(C.F0),_.Y36(C.gz))},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-edit-profile"]],decls:13,vars:1,consts:function(){let o;return o="\u4FDD\u5B58",[[1,"card"],[1,"card-header"],[1,"text-danger","fa","fa-edit","mr-2"],[1,"float-right"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save","mr-1"],o,[1,"card-body","p-0"],["id","editor-edit","name","editor"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"span"),_._UZ(3,"span",2),_._uU(4),_.qZA(),_.TgZ(5,"span",3),_.TgZ(6,"button",4),_.NdJ("click",function(){return t.update()}),_.TgZ(7,"span"),_._UZ(8,"i",5),_.TgZ(9,"span"),_.SDv(10,6),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(11,"div",7),_._UZ(12,"textarea",8),_.qZA(),_.qZA()),2&e&&(_.xp6(4),_.hij("",t.profileName," "))},styles:[""]}),E})(),Pe=(()=>{class E{constructor(){}ngOnInit(){}}return E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-provision-watcher-center"]],decls:2,vars:0,template:function(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1,"provision-watcher-center works!"),_.qZA())},styles:[""]}),E})(),Ne=(()=>{class E{constructor(){}ngOnInit(){}}return E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-provision-watcher-list"]],decls:2,vars:0,template:function(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1,"provision-watcher-list works!"),_.qZA())},styles:[""]}),E})(),Ge=(()=>{class E{constructor(){}ngOnInit(){}}return E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-add-provision-watcher"]],decls:2,vars:0,template:function(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1,"add-provision-watcher works!"),_.qZA())},styles:[""]}),E})(),Le=(()=>{class E{constructor(){}ngOnInit(){}}return E.\u0275fac=function(e){return new(e||E)},E.\u0275cmp=_.Xpm({type:E,selectors:[["app-edit-provision-watcher"]],decls:2,vars:0,template:function(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1,"edit-provision-watcher works!"),_.qZA())},styles:[""]}),E})();var he=d(8253),Ze=d(1964),Xe=d(4294),Fe=d(5894),Ve=d(7216);let o_=(()=>{class E{constructor(e,t){this.router=e,this.metadataSvc=t}canActivate(e,t){return this.checkAvailable(e,t)}canActivateChild(e,t){return this.canActivate(e,t)}checkAvailable(e,t){return this.metadataSvc.ping().pipe((0,Xe.q)(1),(0,Fe.K)(n=>this.router.navigate(["/svc-unavailable"],{queryParams:{svcName:"metadata",routerPath:`/${t.url.split("/")[1]}`}})),(0,Ve.z)(()=>(0,Ze.of)(!0)))}}return E.\u0275fac=function(e){return new(e||E)(_.LFG(C.F0),_.LFG(R.D))},E.\u0275prov=_.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})();const be=[{path:"",component:V,canActivate:[he.a,o_],canActivateChild:[o_],children:[{path:"",redirectTo:"device-service-list",pathMatch:"full"},{path:"device-service-list",component:G},{path:"device-center",component:l,children:[{path:"",redirectTo:"device-list",pathMatch:"full"},{path:"device-list",component:Y_},{path:"add-device",component:ue},{path:"edit-device",component:fe}]},{path:"device-profile-center",component:me,children:[{path:"",redirectTo:"device-profile-list",pathMatch:"full"},{path:"device-profile-list",component:t_.f},{path:"edit-profile",component:ve},{path:"add-profile",component:Ue}]},{path:"provision-watcher-center",component:Pe,children:[{path:"",redirectTo:"provision-watcher-list",pathMatch:"full"},{path:"provision-watcher-list",component:Ne},{path:"edit-provision-watcher",component:Le},{path:"add-provision-watcher",component:Ge}]}]}];let $e=(()=>{class E{}return E.\u0275fac=function(e){return new(e||E)},E.\u0275mod=_.oAB({type:E}),E.\u0275inj=_.cJS({imports:[[C.Bz.forChild(be)],C.Bz]}),E})(),We=(()=>{class E{}return E.\u0275fac=function(e){return new(e||E)},E.\u0275mod=_.oAB({type:E}),E.\u0275inj=_.cJS({imports:[[i.ez,a.u5,$e,a.UX]]}),E})()},2822:(E_,F,d)=>{d.d(F,{f:()=>e_});var i=d(476),a=d(2437),C=d(7822),_=d(9502),V=d(8583),R=d(3092);function Z(S,G){if(1&S){const l=i.EpF();i.TgZ(0,"div",50),i.TgZ(1,"div",51),i.TgZ(2,"button",52),i.NdJ("click",function(){return i.CHM(l),i.oxw().refresh()}),i.TgZ(3,"span"),i._UZ(4,"i",53),i.TgZ(5,"span"),i.SDv(6,54),i.qZA(),i.qZA(),i.qZA(),i.TgZ(7,"button",55),i.TgZ(8,"span"),i._UZ(9,"i",56),i.TgZ(10,"span"),i.SDv(11,57),i.qZA(),i.qZA(),i.qZA(),i.TgZ(12,"button",58),i.NdJ("click",function(){return i.CHM(l),i.oxw().edit()}),i.TgZ(13,"span"),i._UZ(14,"i",59),i.TgZ(15,"span"),i.SDv(16,60),i.qZA(),i.qZA(),i.qZA(),i.TgZ(17,"button",61),i.NdJ("click",function(){return i.CHM(l),i.oxw().deleteConfirm()}),i.TgZ(18,"span"),i._UZ(19,"i",62),i.TgZ(20,"span"),i.SDv(21,63),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA()}if(2&S){const l=i.oxw();i.xp6(12),i.Q6J("disabled",1!==l.multiProfilesSelected.length),i.xp6(5),i.Q6J("disabled",0===l.multiProfilesSelected.length)}}function A(S,G){if(1&S){const l=i.EpF();i.TgZ(0,"input",64),i.NdJ("click",function(D){return i.CHM(l),i.oxw().selectAll(D)}),i.qZA()}if(2&S){const l=i.oxw();i.Q6J("checked",l.isCheckedAll())}}function u(S,G){1&S&&(i.TgZ(0,"th",9),i.SDv(1,65),i.qZA())}const P=function(S){return{profileName:S}};function h(S,G){if(1&S&&(i.TgZ(0,"td",69),i.TgZ(1,"a",70),i._UZ(2,"i",71),i.qZA(),i.qZA()),2&S){const l=i.oxw().$implicit;i.xp6(1),i.Q6J("queryParams",i.VKq(1,P,l.name))}}function W(S,G){if(1&S){const l=i.EpF();i.TgZ(0,"tr"),i.TgZ(1,"td"),i.TgZ(2,"input",66),i.NdJ("click",function(D){const b=i.CHM(l).$implicit;return i.oxw().selectOne(D,b.name)}),i.qZA(),i.qZA(),i.TgZ(3,"td",67),i._uU(4),i.qZA(),i.TgZ(5,"td",67),i._uU(6),i.qZA(),i.TgZ(7,"td"),i._uU(8),i.qZA(),i.YNc(9,h,3,3,"td",68),i.TgZ(10,"td"),i._uU(11),i.qZA(),i.TgZ(12,"td"),i._uU(13),i.qZA(),i.TgZ(14,"td"),i._uU(15),i.qZA(),i.qZA()}if(2&S){const l=G.$implicit,r=i.oxw();i.ekj("table-active",r.isChecked(l.name)),i.xp6(2),i.s9C("value",l.name),i.Q6J("checked",r.isChecked(l.name)),i.xp6(2),i.Oqu(l.id),i.xp6(2),i.Oqu(l.name),i.xp6(2),i.Oqu(l.description),i.xp6(1),i.Q6J("ngIf",r.associatedDeviceColumn),i.xp6(2),i.Oqu(l.labels),i.xp6(2),i.Oqu(l.manufacturer),i.xp6(2),i.Oqu(l.model)}}let e_=(()=>{class S{constructor(l,r,D,L){this.metaSvc=l,this.msgSvc=r,this.route=D,this.router=L,this.associatedDeviceColumn=!0,this.toolbars=!0,this.enableSelectAll=!0,this.singleProfileSelectedEvent=new i.vpe,this.multipleProfileSelectedEvent=new i.vpe,this.profileList=[],this.multiProfilesSelected=[],this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.route.queryParams.subscribe(l=>{l.profileName?this.metaSvc.findProfileByName(l.profileName).subscribe(r=>{this.profileList=[],this.profileList.push(r.profile)}):this.findAllDeviceProfilesPagination()})}findAllDeviceProfilesPagination(){this.metaSvc.allDeviceProfolesPagination(this.pageOffset,this.pageLimit).subscribe(l=>{this.profileList=l.profiles})}onSingleProfileSelectedEmitter(){this.singleProfileSelectedEvent.emit(this.singleProfileSelected)}onMultipleProfileSelectedEmitter(){this.multipleProfileSelectedEvent.emit(this.multiProfilesSelected)}refresh(){this.metaSvc.allDeviceProfolesPagination(0,this.pageLimit).subscribe(l=>{this.profileList=l.profiles,this.msgSvc.success("refresh"),this.pagination=1,this.resetCheckbox()})}onPageSelected(){this.resetPagination(),this.setPagination(),this.findAllDeviceProfilesPagination()}prePage(){this.setPagination(-1),this.metaSvc.allDeviceProfolesPagination(this.pageOffset,this.pageLimit).subscribe(l=>{this.profileList=l.profiles})}nextPage(){this.setPagination(1),this.metaSvc.allDeviceProfolesPagination(this.pageOffset,this.pageLimit).subscribe(l=>{this.profileList=l.profiles})}setPageLimit(l){this.pageLimit=l}setPagination(l){1===l?this.pagination+=1:-1===l&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit,this.resetCheckbox()}resetPagination(){this.pagination=1,this.resetCheckbox()}resetCheckbox(){}edit(){this.router.navigate(["../edit-profile"],{relativeTo:this.route,queryParams:{profileName:this.multiProfilesSelected[0]}})}deleteConfirm(){$("#deleteConfirmDialog").modal("show")}delete(){this.multiProfilesSelected.forEach(l=>{this.metaSvc.deleteProfileByName(l).subscribe(()=>{this.multiProfilesSelected=[],this.profileList.forEach((r,D)=>{r.name==l&&(this.profileList.splice(D,1),this.msgSvc.success("delete",`  Name: ${r.name}`))})})}),$("#deleteConfirmDialog").modal("hide")}isSingleProfileChecked(l){var r;return(null===(r=this.singleProfileSelected)||void 0===r?void 0:r.name)===l}selectSingleProfile(l,r){l.target.checked?this.profileList.forEach(L=>{L.name===r&&(this.singleProfileSelected=L)}):this.singleProfileSelected=void 0,this.onSingleProfileSelectedEmitter()}isCheckedAll(){let l=!0;return this.profileList&&0===this.profileList.length&&(l=!1),this.profileList.forEach(r=>{-1===this.multiProfilesSelected.indexOf(r.name)&&(l=!1)}),l}selectAll(l){this.profileList.forEach(l.target.checked?D=>{this.multiProfilesSelected.includes(D.name)||this.multiProfilesSelected.push(D.name)}:D=>{this.multiProfilesSelected.includes(D.name)&&this.multiProfilesSelected.splice(this.multiProfilesSelected.indexOf(D.name),1)}),this.onMultipleProfileSelectedEmitter()}isChecked(l){return this.enableSelectAll?this.multiProfilesSelected.includes(l):this.isSingleProfileChecked(l)}selectOne(l,r){this.enableSelectAll?(l.target.checked?this.multiProfilesSelected.push(r):this.multiProfilesSelected.splice(this.multiProfilesSelected.indexOf(r),1),this.onMultipleProfileSelectedEmitter()):this.selectSingleProfile(l,r)}}return S.\u0275fac=function(l){return new(l||S)(i.Y36(a.D),i.Y36(C.e),i.Y36(_.gz),i.Y36(_.F0))},S.\u0275cmp=i.Xpm({type:S,selectors:[["app-device-profile-list"]],inputs:{associatedDeviceColumn:"associatedDeviceColumn",toolbars:"toolbars",enableSelectAll:"enableSelectAll",multiProfilesSelected:"multiProfilesSelected",singleProfileSelected:"singleProfileSelected"},outputs:{singleProfileSelectedEvent:"singleProfileSelectedEvent",multipleProfileSelectedEvent:"multipleProfileSelectedEvent"},decls:67,vars:7,consts:function(){let G,l,r,D,L,b,x,q,J,y,Y,B,w,K,k,z,Q,H;return G="\u8BBE\u5907\u5143\u4FE1\u606F\u5217\u8868",l="\u540D\u5B57",r="\u63CF\u8FF0",D="\u6807\u7B7E",L="\u7EF4\u62A4\u8005",b="\u6A21\u5F0F",x="\u6BCF\u9875\u6761\u76EE",q="\u4E0A\u4E00\u9875",J="\u4E0B\u4E00\u9875",y="\u8B66\u544A",Y="\u6570\u636E\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\uFF01\uFF01\uFF01\u786E\u5B9A\u8981\u6267\u884C\u5220\u9664\u64CD\u4F5C\u5417\uFF1F",B="\u53D6\u6D88",w="\u786E\u8BA4",K="\u5237\u65B0",k="\u6DFB\u52A0",z="\u7F16\u8F91",Q="\u5220\u9664",H="\u76F8\u5173\u8BBE\u5907",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-list","text-danger","mr-2"],G,[1,"card-body","p-0"],["class","bg-light px-2 py-2",4,"ngIf"],[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],["type","checkbox",3,"checked","click",4,"ngIf"],l,r,["scope","col",4,"ngIf"],D,L,b,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],x,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],q,[1,"page-item"],J,[1,"fa","fa-angle-double-right","ml-1"],["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],y,[1,"modal-body"],Y,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],B,["type","button",1,"btn","btn-danger",3,"click"],w,[1,"bg-light","px-2","py-2"],["role","group",1,"btn-group","btn-group-sm"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-refresh","mr-1"],K,["type","button","routerLink","../add-profile",1,"btn","btn-info"],[1,"fa","fa-plus","mr-1"],k,["type","button","data-toggle","tooltip","data-placement","top","title","only one should be selected",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-edit","mr-1"],z,["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash","mr-1"],Q,["type","checkbox",3,"checked","click"],H,["type","checkbox",3,"value","checked","click"],[1,"user-select-all"],["class","text-center",4,"ngIf"],[1,"text-center"],["routerLink","../../device-center",1,"badge","badge-pill","badge-primary",3,"queryParams"],[1,"fa","fa-sitemap"]]},template:function(l,r){1&l&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i._UZ(2,"i",2),i.TgZ(3,"span"),i.SDv(4,3),i.qZA(),i.qZA(),i.TgZ(5,"div",4),i.YNc(6,Z,22,2,"div",5),i.TgZ(7,"div",6),i.TgZ(8,"table",7),i.TgZ(9,"thead",8),i.TgZ(10,"tr"),i.TgZ(11,"th",9),i.YNc(12,A,1,1,"input",10),i.qZA(),i.TgZ(13,"th",9),i._uU(14,"ID"),i.qZA(),i.TgZ(15,"th",9),i.SDv(16,11),i.qZA(),i.TgZ(17,"th",9),i.SDv(18,12),i.qZA(),i.YNc(19,u,2,0,"th",13),i.TgZ(20,"th",9),i.SDv(21,14),i.qZA(),i.TgZ(22,"th",9),i.SDv(23,15),i.qZA(),i.TgZ(24,"th",9),i.SDv(25,16),i.qZA(),i.qZA(),i.qZA(),i.TgZ(26,"tbody"),i.YNc(27,W,16,11,"tr",17),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(28,"div",18),i.TgZ(29,"nav",19),i.TgZ(30,"ul",20),i.TgZ(31,"li",21),i.TgZ(32,"span",22),i.SDv(33,23),i.qZA(),i.qZA(),i.TgZ(34,"li",24),i.TgZ(35,"select",25),i.NdJ("ngModelChange",function(L){return r.pageLimit=L})("ngModelChange",function(){return r.onPageSelected()}),i.TgZ(36,"option",26),i._uU(37,"5"),i.qZA(),i.TgZ(38,"option",27),i._uU(39,"10"),i.qZA(),i.TgZ(40,"option",28),i._uU(41,"20"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(42,"li",29),i.TgZ(43,"button",30),i.NdJ("click",function(){return r.prePage()}),i._UZ(44,"i",31),i.TgZ(45,"span"),i.SDv(46,32),i.qZA(),i.qZA(),i.qZA(),i.TgZ(47,"li",33),i.TgZ(48,"button",30),i.NdJ("click",function(){return r.nextPage()}),i.TgZ(49,"span"),i.SDv(50,34),i.qZA(),i._UZ(51,"i",35),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(52,"div",36),i.TgZ(53,"div",37),i.TgZ(54,"div",38),i.TgZ(55,"div",39),i.TgZ(56,"h5",40),i._UZ(57,"i",41),i.TgZ(58,"span"),i.SDv(59,42),i.qZA(),i.qZA(),i.qZA(),i.TgZ(60,"div",43),i.SDv(61,44),i.qZA(),i.TgZ(62,"div",45),i.TgZ(63,"button",46),i.SDv(64,47),i.qZA(),i.TgZ(65,"button",48),i.NdJ("click",function(){return r.delete()}),i.SDv(66,49),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&l&&(i.xp6(6),i.Q6J("ngIf",r.toolbars),i.xp6(6),i.Q6J("ngIf",r.enableSelectAll),i.xp6(7),i.Q6J("ngIf",r.associatedDeviceColumn),i.xp6(8),i.Q6J("ngForOf",r.profileList),i.xp6(8),i.Q6J("ngModel",r.pageLimit),i.xp6(8),i.Q6J("disabled",1===r.pagination),i.xp6(5),i.Q6J("disabled",r.pageLimit>r.profileList.length))},directives:[V.O5,V.sg,R.EJ,R.JJ,R.On,R.YN,R.Kr,_.rH,_.yS],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),S})()},7982:(E_,F,d)=>{d.d(F,{V:()=>V});var i=d(1841),a=d(5894),C=d(476),_=d(4889);let V=(()=>{class R{constructor(A,u){this.http=A,this.errorSvc=u,this.endpoint="/core-command",this.version="/api/v2",this.urlPrefix=`${this.endpoint}${this.version}`,this.endpointHealthUrl="/ping",this.versionUrl="/version",this.configUrl="/config",this.deviceCoreCommandListUrl=`${this.urlPrefix}/device/all`,this.commandsByDeviceIdUrl=`${this.urlPrefix}/device/`,this.commandsByDeviceNameUrl=`${this.urlPrefix}/device/name/`,this.issueCmdByDeviceNameAndCmdNameUrl=`${this.urlPrefix}/device/name/`,this.httpPostOrPutJSONOptions={headers:new i.WM({"Content-type":"application/json"})}}getConfig(){return this.http.get(`${this.urlPrefix}${this.configUrl}`).pipe((0,a.K)(u=>this.errorSvc.handleError(u)))}findCommnadsByDeviceId(A){return this.http.get(`${this.commandsByDeviceIdUrl}${A}`).pipe((0,a.K)(P=>this.errorSvc.handleError(P)))}allDeviceCoreCommandsPagination(A,u){return this.http.get(`${this.deviceCoreCommandListUrl}?offset=${A}&limit=${u}`).pipe((0,a.K)(h=>this.errorSvc.handleError(h)))}findDeviceAssociatedCommnadsByDeviceName(A){return this.http.get(`${this.commandsByDeviceNameUrl}${A}`).pipe((0,a.K)(P=>this.errorSvc.handleError(P)))}findAllDeviceCommnads(){return this.http.get(`${this.urlPrefix}/device`).pipe((0,a.K)(u=>this.errorSvc.handleError(u)))}issueGetBinaryCmd(A,u){return this.http.request("GET",`${this.commandsByDeviceIdUrl}${A}/command/${u}`,{responseType:"arraybuffer"}).pipe((0,a.K)(h=>this.errorSvc.handleError(h)))}issueGetCmd(A,u){return this.http.get(`${this.issueCmdByDeviceNameAndCmdNameUrl}${A}/${u}?ds-pushevent=true&ds-returnevent=true`).pipe((0,a.K)(h=>this.errorSvc.handleError(h)))}issueSetCmd(A,u,P){return this.http.put(`${this.issueCmdByDeviceNameAndCmdNameUrl}${A}/${u}`,JSON.stringify(P),this.httpPostOrPutJSONOptions).pipe((0,a.K)(W=>this.errorSvc.handleError(W)))}}return R.\u0275fac=function(A){return new(A||R)(C.LFG(i.eN),C.LFG(_.T))},R.\u0275prov=C.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})()}}]);