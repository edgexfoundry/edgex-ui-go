"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[10],{4010:(ie,q,T)=>{T.r(q),T.d(q,{MetadataModule:()=>Gt});var n=T(8583),l=T(3092),C=T(9502),e=T(476);let y=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-metadata"]],decls:14,vars:0,consts:function(){let c,t,_;return c="\u8BBE\u5907\u670D\u52A1",t="\u8BBE\u5907",_="\u8BBE\u5907\u5143\u4FE1\u606F",[[1,"card"],[1,"card-header"],[1,"nav","nav-tabs","card-header-tabs","font-weight-bold"],[1,"nav-item"],["routerLink","./device-service-list","routerLinkActive","active",1,"nav-link"],c,["routerLink","./device-center","routerLinkActive","active",1,"nav-link"],t,["routerLink","./device-profile-center","routerLinkActive","active",1,"nav-link"],_,[1,"card-body"]]},template:function(t,_){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"ul",2),e.TgZ(3,"li",3),e.TgZ(4,"a",4),e.SDv(5,5),e.qZA(),e.qZA(),e.TgZ(6,"li",3),e.TgZ(7,"a",6),e.SDv(8,7),e.qZA(),e.qZA(),e.TgZ(9,"li",3),e.TgZ(10,"a",8),e.SDv(11,9),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",10),e._UZ(13,"router-outlet"),e.qZA(),e.qZA())},directives:[C.yS,C.Od,C.lC],styles:[".active-link[_ngcontent-%COMP%]{color:#922c48;background-color:#922c4866!important}"]}),i})();var D=T(2437),b=T(7822);function u(i,c){if(1&i&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.description)}}function S(i,c){1&i&&(e.TgZ(0,"p",20),e._uU(1,"no description."),e.qZA())}function Z(i,c){if(1&i&&(e.TgZ(0,"span",21),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.adminState)}}function R(i,c){if(1&i&&(e.TgZ(0,"span",22),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.adminState)}}function G(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"a",23),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().associatedDevicesSkip(o.name)}),e._UZ(1,"i",24),e.TgZ(2,"span"),e.SDv(3,25),e.qZA(),e._uU(4),e.qZA()}if(2&i){const t=e.oxw().$implicit,_=e.oxw();e.xp6(4),e.hij("\xa0 ",_.associatedDevices.get(t.name)," ")}}function te(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"li",3),e.TgZ(1,"div",4),e.TgZ(2,"div",5),e._UZ(3,"i",6),e.qZA(),e.TgZ(4,"div",7),e.TgZ(5,"div",8),e.TgZ(6,"h5",9),e._uU(7),e.qZA(),e.qZA(),e.YNc(8,u,2,1,"p",10),e.YNc(9,S,2,0,"ng-template",null,11,e.W1O),e.TgZ(11,"div"),e.TgZ(12,"span",12),e._uU(13),e.qZA(),e.TgZ(14,"span",13),e.YNc(15,Z,2,1,"span",14),e.YNc(16,R,2,1,"span",15),e.qZA(),e.YNc(17,G,5,1,"a",16),e.TgZ(18,"span",17),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().edit(s)}),e._UZ(19,"i",18),e.TgZ(20,"span"),e.SDv(21,19),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=c.$implicit,_=e.MAs(10),o=e.oxw();e.xp6(7),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",t.description)("ngIfElse",_),e.xp6(5),e.hij("Port ",o.getSvcPort(t.baseAddress),""),e.xp6(1),e.Q6J("ngSwitch",t.adminState),e.xp6(1),e.Q6J("ngSwitchCase","UNLOCKED"),e.xp6(2),e.Q6J("ngIf",o.associatedDevices.size)}}function f(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",26),e.TgZ(1,"div",27),e._UZ(2,"i",28),e.TgZ(3,"span"),e.SDv(4,29),e.qZA(),e.TgZ(5,"span",30),e._uU(6),e.qZA(),e.TgZ(7,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateSvc()}),e.SDv(8,32),e.qZA(),e.qZA(),e.TgZ(9,"div",33),e.TgZ(10,"form"),e.TgZ(11,"div",34),e.TgZ(12,"label",35),e.SDv(13,36),e.qZA(),e.TgZ(14,"div",37),e.TgZ(15,"input",38),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().deviceSvcSelected.description=o}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(16,"div",34),e.TgZ(17,"label",39),e.SDv(18,40),e.qZA(),e.TgZ(19,"div",37),e.TgZ(20,"select",41),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().deviceSvcSelected.adminState=o}),e.TgZ(21,"option",42),e._uU(22,"UNLOCKED"),e.qZA(),e.TgZ(23,"option",43),e._uU(24,"LOCKED"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(6),e.Oqu(t.deviceSvcSelected.name),e.xp6(9),e.Q6J("ngModel",t.deviceSvcSelected.description),e.xp6(5),e.Q6J("ngModel",t.deviceSvcSelected.adminState)}}let V=(()=>{class i{constructor(t,_,o,s){this.metaSvc=t,this.msgSvc=_,this.router=o,this.route=s,this.deviceServiceList=[],this.associatedDevices=new Map}ngOnInit(){this.metaSvc.allDeviceServices().subscribe(t=>{this.deviceServiceList=t.services,this.deviceServiceList.forEach(_=>{this.metaSvc.findDevicesByServiceName(0,20,_.name).subscribe(o=>{this.associatedDevices.set(_.name,o.devices.length>20?"20+":String(o.devices.length))})})})}getSvcPort(t){return new URL(t).port}edit(t){this.deviceSvcSelected=t}updateSvc(){this.metaSvc.updateDeviceService(this.deviceSvcSelected).subscribe(()=>{var t;this.msgSvc.success("update device service",`name: ${null===(t=this.deviceSvcSelected)||void 0===t?void 0:t.name}`),this.deviceSvcSelected=void 0})}associatedDevicesSkip(t){this.router.navigate(["../device-center"],{queryParams:{svcName:t},relativeTo:this.route})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.D),e.Y36(b.e),e.Y36(C.F0),e.Y36(C.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-device-service-media-list"]],decls:3,vars:2,consts:function(){let c,t,_,o,s,a;return c="\u8BBE\u7F6E",t="\u5173\u8054\u8BBE\u5907",_="\u7F16\u8F91",o="\u4FDD\u5B58",s="\u63CF\u8FF0",a="\u7BA1\u7406\u72B6\u6001",[[1,"list-group","p-0"],["class","list-group-item list-group-item-action list-group-item-light",4,"ngFor","ngForOf"],["class","card mt-3",4,"ngIf"],[1,"list-group-item","list-group-item-action","list-group-item-light"],[1,"media"],[1,"align-self-center","mr-3"],[1,"fa","fa-tags","fa-2x","text-secondary"],[1,"media-body"],[1,"mt-0","mb-1"],[1,"d-inline","mr-3","align-middle","text-dark"],[4,"ngIf","ngIfElse"],["nodesc",""],[1,"badge","badge-info","mr-3"],[3,"ngSwitch"],["class","badge badge-success mr-3",4,"ngSwitchCase"],["class","badge badge-danger mr-3",4,"ngSwitchDefault"],["class","badge badge-primary","role","button",3,"click",4,"ngIf"],["role","button",1,"badge","badge-secondary","float-right",3,"click"],[1,"fa","fa-cog","mr-1"],c,[1,"my-1"],[1,"badge","badge-success","mr-3"],[1,"badge","badge-danger","mr-3"],["role","button",1,"badge","badge-primary",3,"click"],[1,"fa","fa-sitemap","mr-1"],t,[1,"card","mt-3"],[1,"card-header"],[1,"fa","fa-edit","mr-1","text-danger"],_,[1,"ml-1"],[1,"btn","btn-success","btn-sm","float-right",3,"click"],o,[1,"card-body"],[1,"form-group","row"],["for","deviceDesc",1,"col-md-2","col-form-label"],s,[1,"col-md-10"],["type","text","name","deviceSvcDescription",1,"form-control",3,"ngModel","ngModelChange"],["for","adminState",1,"col-md-2","col-form-label"],a,["name","deviceSvcAdminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"]]},template:function(t,_){1&t&&(e.TgZ(0,"ul",0),e.YNc(1,te,22,7,"li",1),e.qZA(),e.YNc(2,f,25,3,"div",2)),2&t&&(e.xp6(1),e.Q6J("ngForOf",_.deviceServiceList),e.xp6(1),e.Q6J("ngIf",_.deviceSvcSelected))},directives:[n.sg,n.O5,n.RF,n.n9,n.ED,l._Y,l.JL,l.F,l.Fj,l.JJ,l.On,l.EJ,l.YN,l.Kr],styles:[""]}),i})(),r=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-device-center"]],decls:1,vars:0,template:function(t,_){1&t&&e._UZ(0,"router-outlet")},directives:[C.lC],styles:[""]}),i})();var E=T(7982);function A(i,c){1&i&&e._UZ(0,"div")}function L(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"li",20),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(2).selectCmd(s)}),e._uU(1),e.qZA()}if(2&i){const t=c.$implicit,_=e.oxw(2);e.ekj("list-group-item-info",(null==_.selectedCmd?null:_.selectedCmd.name)===t.name),e.xp6(1),e.Oqu(t.name)}}function w(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).issueGetCmd()}),e._uU(1,"try"),e.qZA()}}function X(i,c){1&i&&e._UZ(0,"div")}function U(i,c){if(1&i&&(e.TgZ(0,"span",41),e._uU(1),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.hij(" ",t.cmdGetResponse,"")}}function F(i,c){if(1&i&&(e.TgZ(0,"pre",42),e._uU(1),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Oqu(t.cmdGetResponseRaw)}}function k(i,c){if(1&i&&(e.TgZ(0,"div"),e.TgZ(1,"span",35),e.SDv(2,36),e.qZA(),e.YNc(3,U,2,1,"span",37),e.qZA(),e.TgZ(4,"div",38),e.TgZ(5,"span",35),e.SDv(6,39),e.qZA(),e.YNc(7,F,2,1,"pre",40),e.qZA()),2&i){const t=e.oxw(3);e.xp6(3),e.Q6J("ngIf",t.cmdGetResponse),e.xp6(4),e.Q6J("ngIf",t.cmdGetResponseRaw)}}function J(i,c){1&i&&(e.TgZ(0,"h6",43),e._UZ(1,"i",44),e.TgZ(2,"span"),e.SDv(3,45),e.qZA(),e.qZA())}function z(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).issueSetCmd()}),e._uU(1,"try"),e.qZA()}}function Y(i,c){1&i&&e._UZ(0,"div")}function Q(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"label",56),e._uU(2),e.qZA(),e.TgZ(3,"select",57),e.NdJ("ngModelChange",function(o){e.CHM(t);const s=e.oxw().index;return e.oxw(6).parameterBearerList[s].value=o}),e.TgZ(4,"option",58),e._uU(5,"false"),e.qZA(),e.TgZ(6,"option",58),e._uU(7,"true"),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw(),_=t.$implicit,o=t.index,s=e.oxw(6);e.xp6(1),e.s9C("for",_.resourceName),e.xp6(1),e.hij(" ",_.resourceName," "),e.xp6(1),e.s9C("id",_.resourceName),e.s9C("name",_.resourceName),e.Q6J("ngModel",s.parameterBearerList[o].value),e.xp6(1),e.Q6J("ngValue",!1),e.xp6(2),e.Q6J("ngValue",!0)}}function B(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"label",56),e._uU(1),e.qZA(),e.TgZ(2,"input",59),e.NdJ("ngModelChange",function(o){e.CHM(t);const s=e.oxw().index;return e.oxw(6).parameterBearerList[s].value=o}),e.qZA()}if(2&i){const t=e.oxw(),_=t.$implicit,o=t.index,s=e.oxw(6);e.s9C("for",_.resourceName),e.xp6(1),e.Oqu(_.resourceName),e.xp6(1),e.s9C("id",_.resourceName),e.s9C("name",_.resourceName),e.MGl("placeholder","valueType: ",_.valueType,""),e.Q6J("ngModel",s.parameterBearerList[o].value)}}function W(i,c){if(1&i&&(e.TgZ(0,"div",53),e.YNc(1,Q,8,7,"div",54),e.YNc(2,B,3,6,"ng-template",null,55,e.W1O),e.qZA()),2&i){const t=c.$implicit,_=e.MAs(3);e.xp6(1),e.Q6J("ngIf","Bool"==t.valueType)("ngIfElse",_)}}function H(i,c){if(1&i&&(e.TgZ(0,"div",51),e.YNc(1,W,4,2,"div",52),e.qZA()),2&i){const t=e.oxw(5);e.xp6(1),e.Q6J("ngForOf",t.selectedCmdSetParams)}}function j(i,c){if(1&i&&(e.TgZ(0,"div",12),e.TgZ(1,"div",4),e.SDv(2,49),e.qZA(),e.TgZ(3,"div",9),e.YNc(4,H,2,1,"div",50),e.qZA(),e.qZA()),2&i){const t=e.oxw(4);e.xp6(4),e.Q6J("ngIf",t.selectedCmd)}}function P(i,c){if(1&i&&(e.TgZ(0,"span",41),e._uU(1),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Oqu(t.cmdSetResponse)}}function Se(i,c){if(1&i&&(e.TgZ(0,"pre",42),e._uU(1),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Oqu(t.cmdSetResponseRaw)}}function Ie(i,c){if(1&i&&(e.YNc(0,j,5,1,"div",46),e.TgZ(1,"div"),e.TgZ(2,"div"),e.TgZ(3,"span",35),e.SDv(4,47),e.qZA(),e.YNc(5,P,2,1,"span",37),e.qZA(),e.TgZ(6,"div",38),e.TgZ(7,"span",35),e.SDv(8,48),e.qZA(),e.YNc(9,Se,2,1,"pre",40),e.qZA(),e.qZA()),2&i){const t=e.oxw(3);e.Q6J("ngIf",t.selectedCmdSetParams),e.xp6(5),e.Q6J("ngIf",t.cmdSetResponse),e.xp6(4),e.Q6J("ngIf",t.cmdSetResponseRaw)}}function Me(i,c){1&i&&(e.TgZ(0,"h6",43),e._UZ(1,"i",44),e.TgZ(2,"span"),e.SDv(3,60),e.qZA(),e.qZA())}function Pe(i,c){if(1&i&&(e.TgZ(0,"div",21),e.TgZ(1,"div",4),e.TgZ(2,"span",22),e._UZ(3,"i",23),e._uU(4),e.qZA(),e.TgZ(5,"span"),e.SDv(6,24),e.qZA(),e.qZA(),e.TgZ(7,"div",25),e.TgZ(8,"div",10),e.TgZ(9,"div",26),e.TgZ(10,"div",12),e.TgZ(11,"div",4),e._uU(12," Get "),e.YNc(13,w,2,0,"button",27),e.qZA(),e.TgZ(14,"div",28),e.YNc(15,X,1,0,"div",0),e.YNc(16,k,8,2,"ng-template",null,29,e.W1O),e.YNc(18,J,4,0,"ng-template",null,30,e.W1O),e.qZA(),e.qZA(),e.qZA(),e.TgZ(20,"div",31),e.TgZ(21,"div",21),e.TgZ(22,"div",4),e._uU(23," Set "),e.YNc(24,z,2,0,"button",27),e.qZA(),e.TgZ(25,"div",9),e.YNc(26,Y,1,0,"div",0),e.YNc(27,Ie,10,3,"ng-template",null,32,e.W1O),e.YNc(29,Me,4,0,"ng-template",null,33,e.W1O),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.MAs(17),_=e.MAs(19),o=e.MAs(28),s=e.MAs(30),a=e.oxw(2);e.xp6(4),e.hij(" ",a.selectedCmd.name," method:"),e.xp6(9),e.Q6J("ngIf",a.selectedCmd.get),e.xp6(2),e.Q6J("ngIf",a.selectedCmd.get)("ngIfThen",t)("ngIfElse",_),e.xp6(9),e.Q6J("ngIf",a.selectedCmd.set),e.xp6(2),e.Q6J("ngIf",a.selectedCmd.set)("ngIfThen",o)("ngIfElse",s)}}function he(i,c){if(1&i&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e.TgZ(2,"span",5),e._UZ(3,"i",6),e.qZA(),e.TgZ(4,"span",7),e._uU(5),e.qZA(),e.TgZ(6,"span"),e.SDv(7,8),e.qZA(),e.qZA(),e.TgZ(8,"div",9),e.TgZ(9,"div",10),e.TgZ(10,"div",11),e.TgZ(11,"div",12),e.TgZ(12,"div",13),e.SDv(13,14),e.qZA(),e.TgZ(14,"div",15),e.TgZ(15,"ul",16),e.YNc(16,L,2,3,"li",17),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",18),e.YNc(18,Pe,31,9,"div",19),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(5),e.Oqu(t.associatedCmdDeviceName),e.xp6(11),e.Q6J("ngForOf",t.deviceCoreCommand),e.xp6(2),e.Q6J("ngIf",t.selectedCmd)}}function Ne(i,c){if(1&i&&(e.TgZ(0,"div",3),e.TgZ(1,"div",4),e.TgZ(2,"span",5),e._UZ(3,"i",6),e.qZA(),e.TgZ(4,"span",7),e._uU(5),e.qZA(),e.TgZ(6,"span"),e.SDv(7,61),e.qZA(),e.qZA(),e.TgZ(8,"div",62),e.TgZ(9,"h5",43),e._UZ(10,"i",63),e.TgZ(11,"span"),e.SDv(12,64),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(5),e.Oqu(t.associatedCmdDeviceName)}}let Ze=(()=>{class i{constructor(t,_){this.cmdSvc=t,this.metadataSvc=_,this.selectedCmd={},this.selectedCmdSetParams=[],this.parameterBearerList=[]}ngOnInit(){}ngOnChanges(){!this.deviceName||(this.resetResponse(),this.cmdSvc.findDeviceAssociatedCommnadsByDeviceName(this.deviceName).subscribe(t=>{this.associatedCmdDeviceName=t.deviceCoreCommand.deviceName,this.deviceCoreCommand=t.deviceCoreCommand.coreCommands,this.deviceCoreCommand&&0!==this.deviceCoreCommand.length&&(this.selectedCmd=this.deviceCoreCommand[0],this.selectedCmdSetParams=this.selectedCmd.parameters,this.setParameterBearerList(),this.getAssociatedDeviceProfile(t.deviceCoreCommand.profileName))}))}getAssociatedDeviceProfile(t){this.metadataSvc.findProfileByName(t).subscribe(_=>this.associateDeviceProfile=_.profile)}selectCmd(t){this.selectedCmd=t,this.selectedCmdSetParams=this.selectedCmd.parameters,this.resetResponse(),this.setParameterBearerList()}setParameterBearerList(){this.parameterBearerList=[],this.selectedCmdSetParams.forEach(t=>{this.parameterBearerList.push({key:t.resourceName,value:""})})}resetResponse(){this.cmdGetResponse="",this.cmdGetResponseRaw="",this.cmdSetResponse="",this.cmdSetResponseRaw="",this.cmdBinaryResponse=!0,this.cmdBinaryResponseURL=""}isBinaryResource(){let t=!1;return this.associateDeviceProfile.deviceResources.forEach(_=>{_.name!==this.selectedCmd.name||"Binary"!==_.properties.valueType||(t=!0)}),t||(this.associateDeviceProfile.deviceCommands.forEach(_=>{_.name===this.selectedCmd.name&&_.resourceOperations.forEach(o=>{this.associateDeviceProfile.deviceResources.forEach(s=>{o.deviceResource!==s.name||"Binary"!==s.properties.valueType||(t=!0)})})}),t)}issueGetCmd(){this.cmdSvc.issueGetCmd(this.associatedCmdDeviceName,this.selectedCmd.name).subscribe(t=>{if(this.cmdGetResponseRaw=JSON.stringify(t.event.readings,null,3),this.isBinaryResource())return void(this.cmdGetResponse="Binary resource is not supported for preview");let _=[];t.event.readings.forEach(o=>{_.push(o.value)}),this.cmdGetResponse=_.join(",")})}issueGetCmdOfBinaryResource(){this.cmdSvc.issueGetBinaryCmd(this.associatedCmdDeviceName,this.selectedCmd.name).subscribe(t=>{let _=CBOR.decode(t);"image/jpeg"===_.mediaType||"image/jpg"===_.mediaType||"image/png"===_.mediaType?(this.cmdBinaryResponse=_.binaryValue,this.cmdBinaryResponseURL=URL.createObjectURL(this.cmdBinaryResponse)):this.cmdBinaryResponse="only image binary is supported"})}issueSetCmd(){var t;let _={};this.parameterBearerList.forEach(o=>{_[o.key]=o.value}),this.cmdSvc.issueSetCmd(this.associatedCmdDeviceName,null===(t=this.selectedCmd)||void 0===t?void 0:t.name,_).subscribe(o=>{this.cmdSetResponseRaw=JSON.stringify(o,null,3),this.cmdSetResponse=o.message})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(E.V),e.Y36(D.D))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-device-command-viewer"]],inputs:{deviceName:"deviceName"},features:[e.TTD],decls:5,vars:3,consts:function(){let c,t,_,o,s,a,g,I,p,m,O,v;return c="\u76F8\u5173\u547D\u4EE4",t=" \u547D\u4EE4\u5217\u8868 ",_="Get \u548C Set",o="\u54CD\u5E94\uFF1A",s="\u539F\u59CB\u54CD\u5E94\uFF1A",a="\u6CA1\u6709Get\u65B9\u6CD5",g="\u54CD\u5E94\uFF1A",I="\u539F\u59CB\u54CD\u5E94\uFF1A",p="\u53C2\u6570\u8BBE\u7F6E",m="\u6CA1\u6709Set\u65B9\u6CD5",O="\u76F8\u5173\u547D\u4EE4",v="\u6CA1\u6709\u76F8\u5173\u547D\u4EE4",[[4,"ngIf","ngIfThen","ngIfElse"],["hasAssociatedCommand",""],["noAssociatedCommand",""],[1,"card","mt-3"],[1,"card-header"],[1,"badge","badge-danger","text-light"],[1,"fa","fa-terminal","font-weight-bolder"],[1,"text-primary","mx-2","font-weight-bold"],c,[1,"card-body"],[1,"row"],[1,"col-md-2","col-lg-2"],[1,"card","mb-2"],[1,"card-header","font-weight-bold"],t,[1,"card-body","p-0"],[1,"list-group","list-group-flush"],["role","button","class","list-group-item list-group-item-action",3,"list-group-item-info","click",4,"ngFor","ngForOf"],[1,"col-md-10","col-lg-10"],["class","card",4,"ngIf"],["role","button",1,"list-group-item","list-group-item-action",3,"click"],[1,"card"],[1,"text-primary","font-weight-bold","mr-2"],[1,"fa","fa-thumb-tack","text-danger","mr-1"],_,[1,"card-body","px-2"],[1,"col-md-5","col-lg-5"],["class","btn btn-primary btn-sm float-right",3,"click",4,"ngIf"],[1,"card-body","overflow-auto"],["hasGetMethod",""],["noGetMethod",""],[1,"col-md-7","col-lg-7"],["hasSetMethod",""],["noSetMethod",""],[1,"btn","btn-primary","btn-sm","float-right",3,"click"],[1,"badge","badge-info"],o,["class","ml-2 text-primary",4,"ngIf"],[1,"mt-3"],s,["class","mt-2 bg-secondary p-2 text-light rounded",4,"ngIf"],[1,"ml-2","text-primary"],[1,"mt-2","bg-secondary","p-2","text-light","rounded"],[1,"text-warning"],[1,"fa","fa-warning","mr-1"],a,["class","card mb-2",4,"ngIf"],g,I,p,["class","d-flex flex-column bd-highlight",4,"ngIf"],[1,"d-flex","flex-column","bd-highlight"],["class","form p-2 bd-highlight",4,"ngFor","ngForOf"],[1,"form","p-2","bd-highlight"],[4,"ngIf","ngIfElse"],["valueTypeIsNotBool",""],[3,"for"],[1,"custom-select","custom-select-sm",3,"id","name","ngModel","ngModelChange"],[3,"ngValue"],[1,"form-control","form-control-sm",3,"id","name","ngModel","placeholder","ngModelChange"],m,O,[1,"card-body","text-center"],[1,"fa","fa-warning"],v]},template:function(t,_){if(1&t&&(e.YNc(0,A,1,0,"div",0),e.YNc(1,he,19,3,"ng-template",null,1,e.W1O),e.YNc(3,Ne,13,1,"ng-template",null,2,e.W1O)),2&t){const o=e.MAs(2),s=e.MAs(4);e.Q6J("ngIf",_.deviceCoreCommand)("ngIfThen",o)("ngIfElse",s)}},directives:[n.O5,n.sg,l.EJ,l.JJ,l.On,l.YN,l.Kr,l.Fj],styles:[""]}),i})();function Oe(i,c){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"span",67),e.SDv(2,68),e.qZA(),e.TgZ(3,"span",69),e._uU(4),e.qZA(),e.TgZ(5,"span"),e.SDv(6,70),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(4),e.Oqu(t.associatedSvcName)}}function Ve(i,c){if(1&i&&(e.TgZ(0,"span"),e.TgZ(1,"span",67),e.SDv(2,71),e.qZA(),e.TgZ(3,"span",69),e._uU(4),e.qZA(),e.TgZ(5,"span"),e.SDv(6,72),e.qZA(),e.qZA()),2&i){const t=e.oxw();e.xp6(4),e.Oqu(t.associatedProfileName)}}function Le(i,c){1&i&&(e.TgZ(0,"span"),e.SDv(1,73),e.qZA())}function Re(i,c){if(1&i&&(e.TgZ(0,"span",85),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.adminState)}}function be(i,c){if(1&i&&(e.TgZ(0,"span",86),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.adminState)}}function $e(i,c){if(1&i&&(e.TgZ(0,"span",85),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.operatingState,"")}}function xe(i,c){if(1&i&&(e.TgZ(0,"span",86),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.operatingState,"")}}function qe(i,c){if(1&i&&(e.TgZ(0,"span",86),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.operatingState,"")}}const ye=function(i){return{profileName:i}};function we(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"input",23),e.NdJ("click",function(o){const a=e.CHM(t).$implicit;return e.oxw().selectOne(o,a)}),e.qZA(),e.qZA(),e.TgZ(3,"td",74),e._uU(4),e.qZA(),e.TgZ(5,"td",74),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e.TgZ(12,"span",75),e.YNc(13,Re,2,1,"span",76),e.YNc(14,be,2,1,"span",77),e.qZA(),e.qZA(),e.TgZ(15,"td",78),e.TgZ(16,"span",75),e.YNc(17,$e,2,1,"span",76),e.YNc(18,xe,2,1,"span",79),e.YNc(19,qe,2,1,"span",77),e.qZA(),e.qZA(),e.TgZ(20,"td",78),e.TgZ(21,"span",80),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw();return a.setSpecialFeatureViewer(s,a.FEATURE_COMMAND)}),e._UZ(22,"i",81),e.qZA(),e.qZA(),e.TgZ(23,"td",78),e.TgZ(24,"span",80),e.NdJ("click",function(){const s=e.CHM(t).$implicit,a=e.oxw();return a.setSpecialFeatureViewer(s,a.FEATURE_AUTOEVENT)}),e._UZ(25,"i",82),e.qZA(),e.qZA(),e.TgZ(26,"td"),e.TgZ(27,"a",83),e._uU(28),e.qZA(),e.qZA(),e.TgZ(29,"td"),e.TgZ(30,"a",84),e._uU(31),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=c.$implicit,_=e.oxw();e.ekj("table-active",_.isChecked(t.id)||_.specialFeatureAssociatedDeviceName===t.name),e.xp6(2),e.Q6J("checked",_.isChecked(t.id)),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(t.labels),e.xp6(2),e.Q6J("ngSwitch",t.adminState),e.xp6(1),e.Q6J("ngSwitchCase","UNLOCKED"),e.xp6(3),e.Q6J("ngSwitch",t.operatingState),e.xp6(1),e.Q6J("ngSwitchCase","UP"),e.xp6(1),e.Q6J("ngSwitchCase","DOWN"),e.xp6(3),e.ekj("badge-danger",_.specialFeatureName===_.FEATURE_COMMAND&&_.specialFeatureAssociatedDeviceName===t.name),e.xp6(3),e.ekj("badge-danger",_.specialFeatureName===_.FEATURE_AUTOEVENT&&_.specialFeatureAssociatedDeviceName===t.name),e.xp6(3),e.Q6J("queryParams",e.VKq(19,ye,t.profileName)),e.xp6(1),e.Oqu(t.profileName),e.xp6(3),e.Oqu(t.serviceName)}}function Ge(i,c){if(1&i&&(e.TgZ(0,"tr"),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e.TgZ(4,"span",99),e._uU(5),e.qZA(),e.qZA(),e.TgZ(6,"td"),e.TgZ(7,"span",100),e._uU(8),e.qZA(),e.qZA(),e.qZA()),2&i){const t=c.$implicit;e.xp6(2),e.Oqu(t.sourceName),e.xp6(3),e.Oqu(t.interval),e.xp6(3),e.Oqu(t.onChange)}}function Xe(i,c){if(1&i&&(e.TgZ(0,"div"),e.TgZ(1,"div",89),e.TgZ(2,"div",90),e.TgZ(3,"span",91),e._UZ(4,"i",82),e.qZA(),e.TgZ(5,"span",92),e._uU(6),e.qZA(),e.TgZ(7,"span"),e.SDv(8,93),e.qZA(),e.qZA(),e.TgZ(9,"div",94),e.TgZ(10,"div",19),e.TgZ(11,"table",20),e.TgZ(12,"thead",21),e.TgZ(13,"th",22),e.SDv(14,95),e.qZA(),e.TgZ(15,"th",22),e.SDv(16,96),e.qZA(),e.TgZ(17,"th",22),e.SDv(18,97),e.qZA(),e.qZA(),e.TgZ(19,"tbody"),e.YNc(20,Ge,9,3,"tr",98),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw(2);e.xp6(6),e.hij(" ",t.specialFeatureAssociatedDeviceName,""),e.xp6(14),e.Q6J("ngForOf",t.autoEvents)}}function Ue(i,c){if(1&i&&(e.TgZ(0,"div",89),e.TgZ(1,"div",90),e.TgZ(2,"span",91),e._UZ(3,"i",82),e.qZA(),e.TgZ(4,"span",92),e._uU(5),e.qZA(),e.TgZ(6,"span"),e.SDv(7,101),e.qZA(),e.qZA(),e.TgZ(8,"div",102),e.TgZ(9,"h5",103),e._UZ(10,"i",58),e.TgZ(11,"span"),e.SDv(12,104),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&i){const t=e.oxw(2);e.xp6(5),e.hij(" ",t.specialFeatureAssociatedDeviceName,"")}}function Fe(i,c){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Xe,21,2,"div",87),e.YNc(2,Ue,13,1,"ng-template",null,88,e.W1O),e.qZA()),2&i){const t=e.MAs(3),_=e.oxw();e.xp6(1),e.Q6J("ngIf",_.autoEvents)("ngIfElse",t)}}function ke(i,c){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"app-device-command-viewer",105),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("deviceName",t.specialFeatureAssociatedDeviceName)}}let Je=(()=>{class i{constructor(t,_,o,s){this.metaSvc=t,this.msgSvc=_,this.route=o,this.router=s,this.toolbars=!0,this.enableSelectAll=!0,this.deviceList=[],this.associatedSvcName="",this.associatedProfileName="",this.selectedDevice=[],this.FEATURE_AUTOEVENT="autoevent",this.FEATURE_COMMAND="command",this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.route.queryParams.subscribe(t=>t.svcName?(this.associatedSvcName=t.svcName,void this.getDeviceListByAssociatedSvc(this.associatedSvcName)):t.profileName?(this.associatedProfileName=t.profileName,void this.getDeviceListByAssociatedProfile(this.associatedProfileName)):(this.associatedSvcName="",this.associatedProfileName="",void this.getDeviceListPagination()))}renderPopoverComponent(){setTimeout(()=>{$('[data-toggle="popover"]').popover({trigger:"hover"})},250)}getDeviceList(){""===this.associatedSvcName?""===this.associatedProfileName?this.getDeviceListPagination():this.getDeviceListByAssociatedProfile(this.associatedSvcName):this.getDeviceListByAssociatedSvc(this.associatedSvcName)}getDeviceListByAssociatedSvc(t){this.metaSvc.findDevicesByServiceName(this.pageOffset,this.pageLimit,t).subscribe(_=>this.deviceList=_.devices)}getDeviceListByAssociatedProfile(t){this.metaSvc.findDevicesByProfileName(this.pageOffset,this.pageLimit,t).subscribe(_=>this.deviceList=_.devices)}getDeviceListPagination(){this.metaSvc.allDevicesPagination(this.pageOffset,this.pageLimit).subscribe(t=>{this.deviceList=t.devices})}refresh(){this.associatedProfileName="",this.associatedSvcName="",this.metaSvc.allDevicesPagination(0,this.pageLimit).subscribe(t=>{this.deviceList=t.devices,this.msgSvc.success("refresh"),this.resetPagination()})}edit(){this.router.navigate(["../edit-device"],{relativeTo:this.route,queryParams:{deviceName:this.selectedDevice[0].name}})}deleteConfirm(){$("#deleteConfirmDialog").modal("show")}delete(){this.selectedDevice.forEach((t,_)=>{this.metaSvc.deleteOneDeviceByName(t.name).subscribe(()=>{this.selectedDevice.splice(_,1),this.deviceList.forEach((o,s)=>{if(o.id===t.id)return this.deviceList.splice(s,1),void this.msgSvc.success("remove device ",` Name: ${o.name}`)})})}),this.specialFeatureName=void 0,$("#deleteConfirmDialog").modal("hide")}setSpecialFeatureViewer(t,_){switch(this.specialFeatureAssociatedDeviceName=t.name,this.specialFeatureName=_,this.specialFeatureName){case this.FEATURE_AUTOEVENT:this.autoEvents=t.autoEvents}}isCheckedAll(){let t=!0;return this.deviceList&&0===this.deviceList.length&&(t=!1),this.deviceList.forEach(_=>{-1===this.selectedDevice.findIndex(o=>o.name===_.name)&&(t=!1)}),t}selectAll(t){this.deviceList.forEach(t.target.checked?o=>{-1===this.selectedDevice.findIndex(s=>s.name===o.name)&&this.selectedDevice.push(o)}:o=>{this.selectedDevice.forEach((s,a)=>{s.name===o.name&&this.selectedDevice.splice(a,1)})})}isChecked(t){return this.selectedDevice.findIndex(_=>_.id===t)>=0}selectOne(t,_){t.target.checked?this.selectedDevice.push(_):this.selectedDevice.forEach((s,a)=>{s.name===_.name&&this.selectedDevice.splice(a,1)})}onPageSelected(){this.resetPagination(),this.getDeviceList()}prePage(){this.setPagination(-1),this.getDeviceList()}nextPage(){this.setPagination(1),this.getDeviceList()}setPagination(t){1===t?this.pagination+=1:-1===t&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit}resetPagination(){this.pagination=1,this.pageOffset=(this.pagination-1)*this.pageLimit}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.D),e.Y36(b.e),e.Y36(C.gz),e.Y36(C.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-device-list"]],inputs:{toolbars:"toolbars",enableSelectAll:"enableSelectAll"},decls:98,vars:12,consts:function(){let c,t,_,o,s,a,g,I,p,m,O,v,M,x,h,N,se,ae,le,re,Ee,de,Te,ge,Ce,Ae,pe,ue,fe,me,De,ve;return c="\u5237\u65B0",t="\u6DFB\u52A0",_="\u7F16\u8F91",o="\u5220\u9664",s="ID",a="\u540D\u5B57",g="\u63CF\u8FF0",I="\u6807\u7B7E",p="\u7BA1\u7406\u72B6\u6001",m="\u64CD\u4F5C\u72B6\u6001",O="\u547D\u4EE4",v="\u81EA\u52A8\u91C7\u96C6",M="\u76F8\u5173\u8BBE\u5907\u5143\u4FE1\u606F",x="\u76F8\u5173\u8BBE\u5907\u670D\u52A1",h="\u6BCF\u9875\u6761\u76EE",N="\u4E0A\u4E00\u9875",se="\u4E0B\u4E00\u9875",ae="\u8B66\u544A",le="\u6570\u636E\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\uFF01\uFF01\uFF01\u786E\u5B9A\u8981\u6267\u884C\u5220\u9664\u64CD\u4F5C\u5417\uFF1F",re="\u53D6\u6D88",Ee="\u786E\u8BA4",de="\u8BBE\u5907\u670D\u52A1",Te="\u76F8\u5173\u8BBE\u5907\u5217\u8868",ge="\u8BBE\u5907\u5143\u4FE1\u606F",Ce="\u76F8\u5173\u8BBE\u5907\u5217\u8868",Ae="\u8BBE\u5907\u5217\u8868",pe="\u76F8\u5173\u81EA\u52A8\u91C7\u96C6",ue="\u8D44\u6E90",fe="\u5355\u4F4D\u95F4\u9694",me="Onchange",De="\u76F8\u5173\u81EA\u52A8\u91C7\u96C6",ve="\u65E0\u76F8\u5173\u81EA\u52A8\u91C7\u96C6",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-list","text-danger","mr-2"],[4,"ngIf"],[1,"card-body","p-0","position-relative"],[1,"bg-light","px-2","py-2"],["role","group",1,"btn-group","btn-group-sm"],["data-testid","device-list-refresh-btn",1,"btn","btn-primary",3,"click"],[1,"fa","fa-refresh","mr-1"],c,["type","button","routerLink","../add-device",1,"btn","btn-info"],[1,"fa","fa-plus","mr-1"],t,["type","button",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-edit","mr-1"],_,["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash","mr-1"],o,[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],["type","checkbox","role","button",3,"checked","click"],s,a,g,I,p,m,O,v,M,x,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],h,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],N,[1,"page-item"],se,[1,"fa","fa-angle-double-right","ml-1"],["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],ae,[1,"modal-body"],le,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],re,["type","button",1,"btn","btn-danger",3,"click"],Ee,[1,"mr-1"],de,[1,"text-danger","mr-1"],Te,ge,Ce,Ae,[1,"user-select-all"],[3,"ngSwitch"],["class","badge badge-success",4,"ngSwitchCase"],["class","badge badge-danger",4,"ngSwitchDefault"],[1,"text-center"],["class","badge badge-danger",4,"ngSwitchCase"],["role","button",1,"badge","badge-primary","text-light",3,"click"],[1,"fa","fa-terminal","font-weight-bolder"],[1,"fa","fa-calendar-check-o","font-weight-bolder"],["routerLink","../../device-profile-center",3,"queryParams"],["routerLink","../../device-service-list"],[1,"badge","badge-success"],[1,"badge","badge-danger"],[4,"ngIf","ngIfElse"],["noAutoEvents",""],[1,"card","mt-3"],[1,"card-header"],[1,"badge","badge-danger","text-light"],[1,"text-primary","mx-2","font-weight-bold"],pe,[1,"card-body","p-0"],ue,fe,me,[4,"ngFor","ngForOf"],[1,"badge","badge-secondary","badge-pill"],[1,""],De,[1,"card-body","text-center"],[1,"text-warning"],ve,[3,"deviceName"]]},template:function(t,_){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"i",2),e.YNc(3,Oe,7,1,"span",3),e.YNc(4,Ve,7,1,"span",3),e.YNc(5,Le,2,0,"span",3),e.qZA(),e.TgZ(6,"div",4),e.TgZ(7,"div",5),e.TgZ(8,"div",6),e.TgZ(9,"button",7),e.NdJ("click",function(){return _.refresh()}),e.TgZ(10,"span"),e._UZ(11,"i",8),e.TgZ(12,"span"),e.SDv(13,9),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"button",10),e.TgZ(15,"span"),e._UZ(16,"i",11),e.TgZ(17,"span"),e.SDv(18,12),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"button",13),e.NdJ("click",function(){return _.edit()}),e.TgZ(20,"span"),e._UZ(21,"i",14),e.TgZ(22,"span"),e.SDv(23,15),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"button",16),e.NdJ("click",function(){return _.deleteConfirm()}),e.TgZ(25,"span"),e._UZ(26,"i",17),e.TgZ(27,"span"),e.SDv(28,18),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(29,"div",19),e.TgZ(30,"table",20),e.TgZ(31,"thead",21),e.TgZ(32,"tr"),e.TgZ(33,"th",22),e.TgZ(34,"input",23),e.NdJ("click",function(s){return _.selectAll(s)}),e.qZA(),e.qZA(),e.TgZ(35,"th",22),e.SDv(36,24),e.qZA(),e.TgZ(37,"th",22),e.SDv(38,25),e.qZA(),e.TgZ(39,"th",22),e.SDv(40,26),e.qZA(),e.TgZ(41,"th",22),e.SDv(42,27),e.qZA(),e.TgZ(43,"th",22),e.SDv(44,28),e.qZA(),e.TgZ(45,"th",22),e.SDv(46,29),e.qZA(),e.TgZ(47,"th",22),e.SDv(48,30),e.qZA(),e.TgZ(49,"th",22),e.SDv(50,31),e.qZA(),e.TgZ(51,"th",22),e.SDv(52,32),e.qZA(),e.TgZ(53,"th",22),e.SDv(54,33),e.qZA(),e.qZA(),e.qZA(),e.TgZ(55,"tbody"),e.YNc(56,we,32,21,"tr",34),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(57,"div",35),e.TgZ(58,"nav",36),e.TgZ(59,"ul",37),e.TgZ(60,"li",38),e.TgZ(61,"span",39),e.SDv(62,40),e.qZA(),e.qZA(),e.TgZ(63,"li",41),e.TgZ(64,"select",42),e.NdJ("ngModelChange",function(s){return _.pageLimit=s})("ngModelChange",function(){return _.onPageSelected()}),e.TgZ(65,"option",43),e._uU(66,"5"),e.qZA(),e.TgZ(67,"option",44),e._uU(68,"10"),e.qZA(),e.TgZ(69,"option",45),e._uU(70,"20"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(71,"li",46),e.TgZ(72,"button",47),e.NdJ("click",function(){return _.prePage()}),e._UZ(73,"i",48),e.TgZ(74,"span"),e.SDv(75,49),e.qZA(),e.qZA(),e.qZA(),e.TgZ(76,"li",50),e.TgZ(77,"button",47),e.NdJ("click",function(){return _.nextPage()}),e.TgZ(78,"span"),e.SDv(79,51),e.qZA(),e._UZ(80,"i",52),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.YNc(81,Fe,4,2,"div",3),e.YNc(82,ke,2,1,"div",3),e.TgZ(83,"div",53),e.TgZ(84,"div",54),e.TgZ(85,"div",55),e.TgZ(86,"div",56),e.TgZ(87,"h5",57),e._UZ(88,"i",58),e.TgZ(89,"span"),e.SDv(90,59),e.qZA(),e.qZA(),e.qZA(),e.TgZ(91,"div",60),e.SDv(92,61),e.qZA(),e.TgZ(93,"div",62),e.TgZ(94,"button",63),e.SDv(95,64),e.qZA(),e.TgZ(96,"button",65),e.NdJ("click",function(){return _.delete()}),e.SDv(97,66),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",""!==_.associatedSvcName),e.xp6(1),e.Q6J("ngIf",""!==_.associatedProfileName),e.xp6(1),e.Q6J("ngIf",""===_.associatedProfileName&&""===_.associatedSvcName),e.xp6(14),e.Q6J("disabled",1!==_.selectedDevice.length),e.xp6(5),e.Q6J("disabled",0===_.selectedDevice.length),e.xp6(10),e.Q6J("checked",_.isCheckedAll()),e.xp6(22),e.Q6J("ngForOf",_.deviceList),e.xp6(8),e.Q6J("ngModel",_.pageLimit),e.xp6(8),e.Q6J("disabled",1===_.pagination),e.xp6(5),e.Q6J("disabled",_.pageLimit>_.deviceList.length),e.xp6(4),e.Q6J("ngIf",_.specialFeatureName===_.FEATURE_AUTOEVENT),e.xp6(1),e.Q6J("ngIf",_.specialFeatureName===_.FEATURE_COMMAND))},directives:[n.O5,C.rH,n.sg,l.EJ,l.JJ,l.On,l.YN,l.Kr,n.RF,n.n9,n.ED,C.yS,Ze],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),i})();class ze{constructor(){this.Schema="",this.Host="",this.Port="",this.User="",this.Password="",this.ClientId="",this.CommandTopic=""}}class Ye{constructor(){this.Address="",this.Port="",this.UnitID="",this.Timeout="",this.IdleTimeout=""}}class Qe{constructor(){this.Address="",this.UnitID="",this.BaudRate="",this.DataBits="",this.StopBits="",this.Parity="",this.Timeout="",this.IdleTimeout=""}}class Be{constructor(){this.Address="",this.Port=""}}class We{constructor(){this.Address="",this.Port="",this.MACAddress=""}}class He{constructor(){this.host="",this.port=""}}function je(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",10),e.TgZ(1,"span",11),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return o.changeProtocolTemplateMode(o.TEMPLATE_BUILT_IN)}),e._UZ(2,"i",12),e.TgZ(3,"span"),e.SDv(4,13),e.qZA(),e.qZA(),e.TgZ(5,"span",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return o.changeProtocolTemplateMode(o.TEMPLATE_CUSTOM)}),e._UZ(6,"i",12),e.TgZ(7,"span"),e.SDv(8,15),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(1),e.ekj("badge-primary",t.protocolTemplateMode===t.TEMPLATE_BUILT_IN)("badge-secondary",t.protocolTemplateMode!==t.TEMPLATE_BUILT_IN),e.xp6(1),e.ekj("fa-check-square",t.protocolTemplateMode===t.TEMPLATE_BUILT_IN),e.xp6(3),e.ekj("badge-primary",t.protocolTemplateMode===t.TEMPLATE_CUSTOM)("badge-secondary",t.protocolTemplateMode!==t.TEMPLATE_CUSTOM),e.xp6(1),e.ekj("fa-check-square",t.protocolTemplateMode===t.TEMPLATE_CUSTOM)}}function Ke(i,c){1&i&&e._UZ(0,"div")}function et(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"form",34),e.TgZ(2,"div",35),e.TgZ(3,"div",36),e.TgZ(4,"span",37),e.SDv(5,38),e.qZA(),e.qZA(),e._UZ(6,"input",39),e.qZA(),e.TgZ(7,"div",40),e._UZ(8,"i",41),e.qZA(),e.TgZ(9,"div",35),e.TgZ(10,"div",36),e.TgZ(11,"span",37),e.SDv(12,42),e.qZA(),e.qZA(),e.TgZ(13,"input",43),e.NdJ("ngModelChange",function(o){const a=e.CHM(t).$implicit;return e.oxw(4).builtinProtocolTemplateSelected[a]=o}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=c.$implicit,_=e.oxw(4);e.xp6(6),e.Q6J("value",t),e.xp6(7),e.Q6J("ngModel",_.builtinProtocolTemplateSelected[t])}}function tt(i,c){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,et,14,2,"div",33),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.builtinProtocolTemplateProperties)}}function _t(i,c){1&i&&(e.TgZ(0,"h5",48),e._UZ(1,"i",49),e.TgZ(2,"span"),e.SDv(3,50),e.qZA(),e.qZA())}function it(i,c){if(1&i&&(e.TgZ(0,"div"),e._UZ(1,"span",44),e.TgZ(2,"span",45),e.SDv(3,46),e.qZA(),e.qZA(),e.YNc(4,_t,4,0,"h5",47)),2&i){const t=e.oxw(3);e.xp6(4),e.Q6J("ngIf",0===t.builtinProtocolTemplateProperties.length&&t.builtinProtocolName)}}function nt(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",16),e.TgZ(1,"div",17),e.TgZ(2,"form"),e.TgZ(3,"div",18),e.TgZ(4,"label"),e.SDv(5,19),e.qZA(),e.TgZ(6,"select",20),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw(2).builtinProtocolName=o})("ngModelChange",function(){return e.CHM(t),e.oxw(2).onSelectBuiltinProtocolTemplate()}),e.TgZ(7,"option",21),e._uU(8,"device-mqtt"),e.qZA(),e.TgZ(9,"option",22),e._uU(10,"device-rest"),e.qZA(),e.TgZ(11,"option",23),e._uU(12,"device-virtual"),e.qZA(),e.TgZ(13,"option",24),e._uU(14,"device-modbus-tcp"),e.qZA(),e.TgZ(15,"option",25),e._uU(16,"device-modbus-rtu"),e.qZA(),e.TgZ(17,"option",26),e._uU(18,"device-onvif-camera"),e.qZA(),e.TgZ(19,"option",27),e._uU(20,"device-rfid-llrp"),e.qZA(),e.qZA(),e.TgZ(21,"div",28),e.TgZ(22,"small"),e.SDv(23,29),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"div",30),e.YNc(25,tt,2,1,"div",31),e.YNc(26,it,5,1,"ng-template",null,32,e.W1O),e.qZA(),e.qZA()}if(2&i){const t=e.MAs(27),_=e.oxw(2);e.xp6(6),e.ekj("is-invalid",!_.builtinProtocolName)("is-valid",_.builtinProtocolName),e.Q6J("ngModel",_.builtinProtocolName),e.xp6(19),e.Q6J("ngIf",0!==_.builtinProtocolTemplateProperties.length)("ngIfElse",t)}}function ot(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"form",34),e.TgZ(2,"div",35),e.TgZ(3,"div",36),e.TgZ(4,"span",37),e.SDv(5,60),e.qZA(),e.qZA(),e.TgZ(6,"input",61),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.propertyName=o}),e.qZA(),e.qZA(),e.TgZ(7,"div",40),e._UZ(8,"i",41),e.qZA(),e.TgZ(9,"div",35),e.TgZ(10,"div",36),e.TgZ(11,"span",37),e.SDv(12,62),e.qZA(),e.qZA(),e.TgZ(13,"input",63),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.propertyValue=o}),e.qZA(),e.qZA(),e.TgZ(14,"div",64),e.TgZ(15,"button",65),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw(3).removeCustomProtocolProperty(s)}),e._UZ(16,"i",66),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=c.$implicit;e.xp6(6),e.Q6J("ngModel",t.propertyName),e.xp6(7),e.Q6J("ngModel",t.propertyValue)}}function ct(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",16),e.TgZ(1,"div",51),e.TgZ(2,"div",18),e.TgZ(3,"label"),e.SDv(4,52),e.qZA(),e.TgZ(5,"input",53),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw(2).customProtocolName=o})("ngModelChange",function(){return e.CHM(t),e.oxw(2).onCustomProtocolNameChange()}),e.qZA(),e.TgZ(6,"div",28),e.TgZ(7,"small"),e.SDv(8,54),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",55),e.TgZ(10,"div"),e.TgZ(11,"p",56),e._UZ(12,"span",57),e.TgZ(13,"span",58),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addCustomProtocolProperty()}),e.SDv(14,59),e.qZA(),e.qZA(),e.qZA(),e.YNc(15,ot,17,2,"div",33),e.qZA(),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(5),e.ekj("is-invalid",!t.customProtocolName)("is-valid",t.customProtocolName),e.Q6J("ngModel",t.customProtocolName),e.xp6(10),e.Q6J("ngForOf",t.customProtocolPropertyBearer)}}function st(i,c){if(1&i&&(e.TgZ(0,"div",0),e.TgZ(1,"div",4),e.YNc(2,je,9,12,"div",6),e.YNc(3,Ke,1,0,"div",7),e.YNc(4,nt,28,7,"ng-template",null,8,e.W1O),e.YNc(6,ct,16,6,"ng-template",null,9,e.W1O),e.qZA(),e.qZA()),2&i){const t=e.MAs(5),_=e.MAs(7),o=e.oxw();e.xp6(2),e.Q6J("ngIf",o.mode===o.MODE_ADD),e.xp6(1),e.Q6J("ngIf",o.protocolTemplateMode===o.TEMPLATE_CUSTOM)("ngIfThen",_)("ngIfElse",t)}}let K=(()=>{class i{constructor(){this.MODE_ADD="add",this.MODE_EDIT="edit",this.deviceProtocols={},this.isValid=!1,this.isValidChange=new e.vpe,this.TEMPLATE_CUSTOM="custom",this.TEMPLATE_BUILT_IN="built-in",this.customProtocolPropertyBearer=[],this.builtinProtocolTemplateProperties=[]}ngOnInit(){if(this.mode){if(this.mode==this.MODE_EDIT)return this.protocolTemplateMode=this.TEMPLATE_CUSTOM,this.extractProtocolName(),this.customProtocolName=this.protocolName?this.protocolName:"",void this.setCustomProtocolPropertysBearer();this.mode==this.MODE_ADD&&(this.protocolTemplateMode=this.TEMPLATE_BUILT_IN),this.validate()}}extractProtocolName(){!this.deviceProtocols||0===Object.keys(this.deviceProtocols).length||(this.protocolName=Object.keys(this.deviceProtocols)[0])}onSelectBuiltinProtocolTemplate(){switch(this.validate(),this.builtinProtocolName){case"mqtt":this.builtinProtocolTemplateSelected=new ze;break;case"modbus-tcp":this.builtinProtocolTemplateSelected=new Ye;break;case"modbus-rtu":this.builtinProtocolTemplateSelected=new Qe;break;case"other":this.builtinProtocolTemplateSelected=new Be;break;case"other-rest":this.builtinProtocolTemplateSelected={};break;case"Onvif":this.builtinProtocolTemplateSelected=new We;break;case"tcp":this.builtinProtocolTemplateSelected=new He;break;default:this.builtinProtocolTemplateSelected={}}this.builtinProtocolTemplateProperties=Object.keys(this.builtinProtocolTemplateSelected)}changeProtocolTemplateMode(t){this.protocolTemplateMode=t,this.validate()}onCustomProtocolNameChange(){this.validate()}setCustomProtocolPropertysBearer(){if(this.customProtocolName)for(const[t,_]of Object.entries(this.deviceProtocols[this.customProtocolName]))this.customProtocolPropertyBearer.push({propertyName:t,propertyValue:_})}addCustomProtocolProperty(){this.customProtocolPropertyBearer.push({propertyName:"",propertyValue:""})}removeCustomProtocolProperty(t){this.customProtocolPropertyBearer.splice(this.customProtocolPropertyBearer.indexOf(t),1)}getDeviceProtocols(){if(this.deviceProtocols={},this.protocolTemplateMode===this.TEMPLATE_BUILT_IN)this.deviceProtocols[this.builtinProtocolName]=Object.assign({},this.builtinProtocolTemplateSelected);else{let t={};this.customProtocolPropertyBearer.forEach(_=>{t[_.propertyName]=_.propertyValue}),this.deviceProtocols[this.customProtocolName]=t}return this.deviceProtocols}validate(){switch(this.isValid=!0,this.protocolTemplateMode){case this.TEMPLATE_BUILT_IN:this.builtinProtocolName||(this.isValid=!1);break;default:this.customProtocolName||(this.isValid=!1)}this.isValidChange.emit(this.isValid)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-device-protocol"]],inputs:{mode:"mode",deviceProtocols:"deviceProtocols",isValid:"isValid"},outputs:{isValidChange:"isValidChange"},decls:7,vars:1,consts:function(){let c,t,_,o,s,a,g,I,p,m,O,v,M,x;return c="\u8BBE\u5907\u534F\u8BAE",t="\u53EF\u5229\u7528\u7684\u534F\u8BAE\u6A21\u677F",_="\u81EA\u5B9A\u4E49\u534F\u8BAE\u6A21\u677F",o="\u534F\u8BAE\u540D\u5B57",s="\u534F\u8BAE\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",a="PropertyName",g="PropertyVaule",I=" all built-in protocol templates refer to the device service released by edgex, such as device-virtual, device-rest, device-mqtt, device-modbus ",p="\u8BE5\u8BBE\u5907\u670D\u52A1\u4E0D\u9700\u8981\u8BBE\u7F6E\u901A\u4FE1\u534F\u8BAE",m="\u534F\u8BAE\u540D\u5B57",O="\u534F\u8BAE\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",v="\u6DFB\u52A0\u534F\u8BAE\u5C5E\u6027",M="PropertyName",x="PropertyValue",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-tags","fa-lg","text-danger","mr-1"],c,[1,"card-body"],["class","card",4,"ngIf"],["class","mb-2",4,"ngIf"],[4,"ngIf","ngIfThen","ngIfElse"],["builtinProtocolTemplate",""],["customProtocolTemplate",""],[1,"mb-2"],["role","button",1,"user-select-none","badge","font-weight-bold","mr-3",3,"click"],[1,"fa","fa-square-o","mr-1"],t,["role","button",1,"user-select-none","badge","font-weight-bold",3,"click"],_,[1,"row","border","border-secondary","p-2","rounded-lg","mx-1"],[1,"col-md-2","border-right","border-info"],[1,"form-group"],o,["type","text","name","builtinProtocolName","required","",1,"custom-select",3,"ngModel","ngModelChange"],["value","mqtt"],["value","other-rest"],["value","other"],["value","modbus-tcp"],["value","modbus-rtu"],["value","Onvif"],["value","tcp"],[1,"invalid-feedback"],s,[1,"col-md-10"],[4,"ngIf","ngIfElse"],["noBuiltinProperties",""],[4,"ngFor","ngForOf"],[1,"form-inline","mb-1"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],a,["type","text","disabled","",1,"form-control",2,"width","300px",3,"value"],[1,"form-group","mx-2"],[1,"fa","fa-long-arrow-right"],g,["type","text","name","property",1,"form-control",2,"width","300px",3,"ngModel","ngModelChange"],[1,"fa","fa-info-circle","fa-lg","text-success","font-weight-bold","mr-1"],[1,"text-muted"],I,["class","text-warning",4,"ngIf"],[1,"text-warning"],[1,"fa","fa-warning","mr-1"],p,[1,"col-md-2","col-lg-2","border-right","border-secondary"],m,["type","text","name","customProtocolName",1,"form-control",3,"ngModel","ngModelChange"],O,[1,"col-md-10","col-lg-10"],[1,"badge","badge-secondary","font-weight-bold"],[1,"fa","fa-plus-circle","mr-2"],["role","button",1,"user-select-none",3,"click"],v,M,["type","text","name","propertyName",1,"form-control",2,"width","300px",3,"ngModel","ngModelChange"],x,["type","text","name","PropertyValue",1,"form-control",2,"width","300px",3,"ngModel","ngModelChange"],[1,"input-group","ml-2"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash"]]},template:function(t,_){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span"),e.SDv(4,3),e.qZA(),e.qZA(),e.TgZ(5,"div",4),e.YNc(6,st,8,4,"div",5),e.qZA(),e.qZA()),2&t&&(e.xp6(6),e.Q6J("ngIf",_.mode))},directives:[n.O5,l._Y,l.JL,l.F,l.EJ,l.Q7,l.JJ,l.On,l.YN,l.Kr,n.sg,l.Fj],styles:[""]}),i})();var ee=T(4889);function at(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"tr"),e.TgZ(1,"td"),e.TgZ(2,"input",35),e.NdJ("click",function(o){const a=e.CHM(t).$implicit;return e.oxw().selectOneSvc(o,a.name)}),e.qZA(),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"date"),e.qZA(),e.qZA()}if(2&i){const t=c.$implicit,_=e.oxw();e.ekj("table-active",_.isSvcChecked(t.name)),e.xp6(2),e.Q6J("checked",_.isSvcChecked(t.name)),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(t.labels),e.xp6(2),e.Oqu(t.adminState),e.xp6(2),e.Oqu(e.xi3(15,10,t.created,"yyyy-MM-dd hh:mm:ss")),e.xp6(3),e.Oqu(e.xi3(18,13,t.modified,"yyyy-MM-dd hh:mm:ss"))}}let ne=(()=>{class i{constructor(t){this.metaSvc=t,this.singleDeviceSvcSelectedEvent=new e.vpe,this.deviceServiceList=[],this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.findAllDeviceSvcPagination()}findAllDeviceSvcPagination(){this.metaSvc.findAllDeviceServicesPagination(this.pageOffset,this.pageLimit).subscribe(t=>{this.deviceServiceList=t.services})}onSingleDeviceSvcSelectedEmitter(){this.singleDeviceSvcSelectedEvent.emit(this.deviceSvcSelected)}isSvcChecked(t){var _;return(null===(_=this.deviceSvcSelected)||void 0===_?void 0:_.name)===t}selectOneSvc(t,_){let s=this;t.target.checked?this.deviceServiceList.forEach(function(a){a.name===_&&(s.deviceSvcSelected=a)}):this.deviceSvcSelected=void 0,this.onSingleDeviceSvcSelectedEmitter()}onPageSelected(){this.resetPagination(),this.setPagination(),this.findAllDeviceSvcPagination()}prePage(){this.setPagination(-1),this.findAllDeviceSvcPagination()}nextPage(){this.setPagination(1),this.findAllDeviceSvcPagination()}setPagination(t){1===t?this.pagination+=1:-1===t&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit}resetPagination(){this.pagination=1}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.D))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-device-service-list"]],inputs:{deviceSvcSelected:"deviceSvcSelected"},outputs:{singleDeviceSvcSelectedEvent:"singleDeviceSvcSelectedEvent"},decls:52,vars:4,consts:function(){let c,t,_,o,s,a,g,I,p,m,O;return c="\u8BBE\u5907\u670D\u52A1\u5217\u8868",t="ID",_="\u540D\u5B57",o="\u63CF\u8FF0",s="\u6807\u7B7E",a="\u7BA1\u7406\u72B6\u6001",g="\u521B\u5EFA\u65F6\u95F4",I="\u4FEE\u6539\u65F6\u95F4",p="\u6BCF\u9875\u6761\u76EE",m="\u4E0A\u4E00\u9875",O="\u4E0B\u4E00\u9875",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-list","mr-2","text-danger"],c,[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],t,_,o,s,a,g,I,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],p,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],m,[1,"page-item"],O,[1,"fa","fa-angle-double-right","ml-1"],["type","checkbox","role","button",3,"checked","click"]]},template:function(t,_){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span"),e.SDv(4,3),e.qZA(),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"div",5),e.TgZ(7,"table",6),e.TgZ(8,"thead",7),e.TgZ(9,"tr"),e.TgZ(10,"th",8),e._uU(11,"#"),e.qZA(),e.TgZ(12,"th",8),e.SDv(13,9),e.qZA(),e.TgZ(14,"th",8),e.SDv(15,10),e.qZA(),e.TgZ(16,"th",8),e.SDv(17,11),e.qZA(),e.TgZ(18,"th",8),e.SDv(19,12),e.qZA(),e.TgZ(20,"th",8),e.SDv(21,13),e.qZA(),e.TgZ(22,"th",8),e.SDv(23,14),e.qZA(),e.TgZ(24,"th",8),e.SDv(25,15),e.qZA(),e.qZA(),e.qZA(),e.TgZ(26,"tbody"),e.YNc(27,at,19,16,"tr",16),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"div",17),e.TgZ(29,"nav",18),e.TgZ(30,"ul",19),e.TgZ(31,"li",20),e.TgZ(32,"span",21),e.SDv(33,22),e.qZA(),e.qZA(),e.TgZ(34,"li",23),e.TgZ(35,"select",24),e.NdJ("ngModelChange",function(s){return _.pageLimit=s})("ngModelChange",function(){return _.onPageSelected()}),e.TgZ(36,"option",25),e._uU(37,"5"),e.qZA(),e.TgZ(38,"option",26),e._uU(39,"10"),e.qZA(),e.TgZ(40,"option",27),e._uU(41,"20"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(42,"li",28),e.TgZ(43,"button",29),e.NdJ("click",function(){return _.prePage()}),e._UZ(44,"i",30),e.TgZ(45,"span"),e.SDv(46,31),e.qZA(),e.qZA(),e.qZA(),e.TgZ(47,"li",32),e.TgZ(48,"button",29),e.NdJ("click",function(){return _.nextPage()}),e.TgZ(49,"span"),e.SDv(50,33),e.qZA(),e._UZ(51,"i",34),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(27),e.Q6J("ngForOf",_.deviceServiceList),e.xp6(8),e.Q6J("ngModel",_.pageLimit),e.xp6(8),e.Q6J("disabled",1===_.pagination),e.xp6(5),e.Q6J("disabled",_.pageLimit>_.deviceServiceList.length))},directives:[n.sg,l.EJ,l.JJ,l.On,l.YN,l.Kr],pipes:[n.uU],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),i})();var _e=T(2822);function lt(i,c){if(1&i&&(e.TgZ(0,"option",37),e._uU(1),e.qZA()),2&i){const t=c.$implicit;e.s9C("value",t),e.xp6(1),e.Oqu(t)}}function rt(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",10),e.TgZ(1,"div",4),e.TgZ(2,"form"),e.TgZ(3,"div",11),e.TgZ(4,"label",12),e.SDv(5,13),e.qZA(),e.TgZ(6,"div",14),e.TgZ(7,"div",15),e.TgZ(8,"input",16),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.interval=o})("ngModelChange",function(){return e.CHM(t),e.oxw().onValueChange()}),e.qZA(),e.TgZ(9,"div",17),e.TgZ(10,"select",18),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.unit=o})("ngModelChange",function(){return e.CHM(t),e.oxw().onValueChange()}),e.TgZ(11,"option",19),e._uU(12,"millisecond"),e.qZA(),e.TgZ(13,"option",20),e._uU(14,"second"),e.qZA(),e.TgZ(15,"option",21),e._uU(16,"minute"),e.qZA(),e.TgZ(17,"option",22),e._uU(18,"hour"),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",23),e.SDv(20,24),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",25),e.TgZ(22,"label",12),e.SDv(23,26),e.qZA(),e.TgZ(24,"div",14),e.TgZ(25,"select",27),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.onChange=o})("ngModelChange",function(){return e.CHM(t),e.oxw().onValueChange()}),e.TgZ(26,"option",28),e._uU(27,"true"),e.qZA(),e.TgZ(28,"option",29),e._uU(29,"false"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",25),e.TgZ(31,"label",12),e.SDv(32,30),e.qZA(),e.TgZ(33,"div",14),e.TgZ(34,"select",31),e.NdJ("ngModelChange",function(o){return e.CHM(t).$implicit.resource=o})("ngModelChange",function(){return e.CHM(t),e.oxw().onValueChange()}),e.YNc(35,lt,2,2,"option",32),e.qZA(),e.TgZ(36,"div",23),e.SDv(37,33),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"button",34),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.oxw().removeAutoEvent(s)}),e._UZ(39,"i",35),e.TgZ(40,"span"),e.SDv(41,36),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=c.$implicit,_=e.oxw();e.xp6(8),e.ekj("is-invalid",!_.eventIntervalNumType(t.interval))("is-valid",_.eventIntervalNumType(t.interval)),e.Q6J("ngModel",t.interval),e.xp6(2),e.Q6J("ngModel",t.unit),e.xp6(15),e.Q6J("ngModel",t.onChange),e.xp6(9),e.ekj("is-invalid",""===t.resource)("is-valid",""!==t.resource),e.Q6J("ngModel",t.resource),e.xp6(1),e.Q6J("ngForOf",_.autoEventResourceNameSet)}}let oe=(()=>{class i{constructor(){this.autoEvents=[],this.autoEventsChange=new e.vpe,this.isValid=!1,this.isValidChange=new e.vpe,this.autoEventDecoratorBearer=[],this.autoEventResourceNameSet=[]}ngOnInit(){}ngOnChanges(){this.resetAutoEventDecoratorBearer(),this.setAutoEventDecorator(this.autoEvents),this.setupAutoEventResourceNameSet(this.deviceProfile),this.resumeOriginalAutoEvents()}onValueChange(){this.resumeOriginalAutoEvents()}resetAutoEventDecoratorBearer(){this.autoEventDecoratorBearer.splice(0,this.autoEventDecoratorBearer.length)}addAutoEvent(){this.autoEventDecoratorBearer.push({interval:"",onChange:!1,resource:"",unit:"ms"}),this.resumeOriginalAutoEvents()}removeAutoEvent(t){this.autoEventDecoratorBearer.splice(this.autoEventDecoratorBearer.indexOf(t),1),this.resumeOriginalAutoEvents()}setupAutoEventResourceNameSet(t){!t||(this.autoEventResourceNameSet.splice(0,this.autoEventResourceNameSet.length),t.deviceResources.forEach((_,o)=>{this.autoEventResourceNameSet.push(_.name)}),t.deviceCommands.forEach((_,o)=>{this.autoEventResourceNameSet.push(_.name)}))}eventIntervalNumType(t){return!isNaN(t)&&parseFloat(t)===parseInt(t)}setAutoEventDecorator(t){!t||t.forEach(_=>{let o=0;-1!==_.interval.indexOf("ms")?o=_.interval.indexOf("ms"):-1!==_.interval.indexOf("s")?o=_.interval.indexOf("s"):-1!==_.interval.indexOf("m")?o=_.interval.indexOf("m"):-1!==_.interval.indexOf("h")&&(o=_.interval.indexOf("h")),this.autoEventDecoratorBearer.push({interval:_.interval.slice(0,o),onChange:!!_.onChange&&_.onChange,resource:_.sourceName,unit:_.interval.substring(o)})})}resumeOriginalAutoEvents(){this.autoEvents?this.autoEvents.splice(0,this.autoEvents.length):this.autoEvents=[],this.autoEventDecoratorBearer.forEach(t=>{this.autoEvents.push({interval:`${t.interval}${t.unit}`,onChange:!!t.onChange,sourceName:t.resource})}),this.validate(),this.autoEventsChange.emit(this.autoEvents)}validate(){this.isValid=!0,0!==this.autoEventDecoratorBearer.length&&this.autoEventDecoratorBearer.forEach(t=>{this.eventIntervalNumType(t.interval)&&""!==t.resource||(this.isValid=!1)}),this.isValidChange.emit(this.isValid)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-device-auto-event"]],inputs:{autoEvents:"autoEvents",deviceProfile:"deviceProfile",isValid:"isValid"},outputs:{autoEventsChange:"autoEventsChange",isValidChange:"isValidChange"},features:[e.TTD],decls:11,vars:1,consts:function(){let c,t,_,o,s,a,g,I;return c="\u81EA\u52A8\u91C7\u96C6",t="\u6DFB\u52A0\u66F4\u591A\u81EA\u52A8\u91C7\u96C6\u4E8B\u4EF6",_="\u5355\u4F4D\u95F4\u9694",o=" can only be a pure integer number ",s="onchange",a="\u8BBE\u5907\u8D44\u6E90",g=" resource can't be empty ",I="\u5220\u9664",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-tags","fa-lg","text-danger","mr-1"],c,[1,"card-body"],[1,"badge","badge-secondary","font-weight-bold"],[1,"fa","fa-plus-circle","mr-2"],["role","button",1,"user-select-none",3,"click"],t,["class","card mb-3",4,"ngFor","ngForOf"],[1,"card","mb-3"],[1,"form-group","row","has-validation"],[1,"col-md-2","col-form-label"],_,[1,"col-md-10"],[1,"input-group","mb-3",2,"width","250px"],["type","text","name","interval","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],["name","eventIntervalUnit","required","",1,"custom-select",3,"ngModel","ngModelChange"],["value","ms"],["value","s"],["value","m"],["value","h"],[1,"invalid-feedback"],o,[1,"form-group","row"],s,["name","onchange",1,"custom-select",2,"width","250px",3,"ngModel","ngModelChange"],["value","true"],["value","false"],a,["name","resource","required","",1,"custom-select",2,"width","250px",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],g,[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash","mr-1"],I,[3,"value"]]},template:function(t,_){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"i",2),e.TgZ(3,"span"),e.SDv(4,3),e.qZA(),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"p",5),e._UZ(7,"span",6),e.TgZ(8,"span",7),e.NdJ("click",function(){return _.addAutoEvent()}),e.SDv(9,8),e.qZA(),e.qZA(),e.YNc(10,rt,42,13,"div",9),e.qZA(),e.qZA()),2&t&&(e.xp6(10),e.Q6J("ngForOf",_.autoEventDecoratorBearer))},directives:[n.sg,l._Y,l.JL,l.F,l.Fj,l.Q7,l.JJ,l.On,l.EJ,l.YN,l.Kr],styles:[""]}),i})();function Et(i,c){1&i&&e._UZ(0,"i",33)}function dt(i,c){1&i&&e._UZ(0,"i",33)}function Tt(i,c){1&i&&e._UZ(0,"i",33)}function gt(i,c){1&i&&e._UZ(0,"i",33)}function Ct(i,c){1&i&&e._UZ(0,"i",33)}function At(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){return e.CHM(t),e.oxw().previous()}),e._UZ(1,"i",35),e.TgZ(2,"span"),e.SDv(3,36),e.qZA(),e.qZA()}}function pt(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){return e.CHM(t),e.oxw().next()}),e.TgZ(1,"span"),e.SDv(2,38),e.qZA(),e._UZ(3,"i",39),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.stepStateLock())}}function ut(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"button",40),e.NdJ("click",function(){return e.CHM(t),e.oxw().submit()}),e._UZ(1,"i",41),e.TgZ(2,"span"),e.SDv(3,42),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.stepStateLock())}}function ft(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",43),e.TgZ(1,"app-device-service-list",44),e.NdJ("singleDeviceSvcSelectedEvent",function(o){return e.CHM(t),e.oxw().onSingleDeviceSvcSelected(o)}),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("deviceSvcSelected",t.selectedSvc)}}function mt(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",43),e.TgZ(1,"app-device-profile-list",45),e.NdJ("singleProfileSelectedEvent",function(o){return e.CHM(t),e.oxw().onSingleProfileSelected(o)}),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("singleProfileSelected",t.selectedProfile)("enableSelectAll",!1)("toolbars",!1)("associatedDeviceColumn",!1)}}function Dt(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"form",46),e.TgZ(1,"div",47),e.TgZ(2,"label",48),e.SDv(3,49),e.qZA(),e.TgZ(4,"div",50),e.TgZ(5,"input",51),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().newDevice.name=o}),e.qZA(),e.TgZ(6,"div",52),e.TgZ(7,"small"),e.SDv(8,53),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",54),e.TgZ(10,"label",55),e.SDv(11,56),e.qZA(),e.TgZ(12,"div",50),e.TgZ(13,"input",57),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().newDevice.description=o}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"div",54),e.TgZ(15,"label",58),e.SDv(16,59),e.qZA(),e.TgZ(17,"div",50),e.TgZ(18,"input",60),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().deviceLabels=o}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",54),e.TgZ(20,"label",61),e.SDv(21,62),e.qZA(),e.TgZ(22,"div",50),e.TgZ(23,"select",63),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().newDevice.adminState=o}),e.TgZ(24,"option",64),e._uU(25,"UNLOCKED"),e.qZA(),e.TgZ(26,"option",65),e._uU(27,"LOCKED"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(5),e.ekj("is-invalid",!t.newDevice.name)("is-valid",t.newDevice.name),e.Q6J("ngModel",t.newDevice.name),e.xp6(8),e.Q6J("ngModel",t.newDevice.description),e.xp6(5),e.Q6J("ngModel",t.deviceLabels),e.xp6(5),e.Q6J("ngModel",t.newDevice.adminState)}}function vt(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",30),e.TgZ(1,"div",1),e.TgZ(2,"span",66),e.SDv(3,67),e.qZA(),e.qZA(),e.TgZ(4,"div",31),e.TgZ(5,"app-device-auto-event",68),e.NdJ("autoEventsChange",function(o){return e.CHM(t),e.oxw().newDevice.autoEvents=o})("isValidChange",function(o){return e.CHM(t),e.oxw().isAutoEventsValid=o}),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(5),e.Q6J("deviceProfile",t.selectedProfile)("autoEvents",t.newDevice.autoEvents)("isValid",t.isAutoEventsValid)}}let St=(()=>{class i{constructor(t,_,o,s,a){this.metaSvc=t,this.msgSvc=_,this.errorSvc=o,this.router=s,this.route=a,this.deviceLabels="",this.currentStep=0,this.selectedClass="text-white rounded px-2 bg-success  font-weight-bold",this.noSelectedClass="text-white rounded px-2 bg-secondary  font-weight-bold",this.isProtocolValid=!1,this.isAutoEventsValid=!1,this.newDevice={adminState:"UNLOCKED",operatingState:"UP"}}ngOnInit(){}onSingleProfileSelected(t){this.selectedProfile=t}onSingleDeviceSvcSelected(t){this.selectedSvc=t}stepStateLock(){switch(this.currentStep){case 0:return void 0===this.selectedSvc;case 1:return void 0===this.selectedProfile;case 2:return!this.newDevice.name;case 3:return!this.isAutoEventsValid;case 4:return!this.isProtocolValid;default:return!1}}next(){this.currentStep+=1}previous(){this.currentStep=this.currentStep-1}submit(){var t,_,o;this.newDevice.labels=null===(t=this.deviceLabels)||void 0===t?void 0:t.split(","),this.newDevice.serviceName=null===(_=this.selectedSvc)||void 0===_?void 0:_.name,this.newDevice.profileName=null===(o=this.selectedProfile)||void 0===o?void 0:o.name,this.newDevice.protocols=this.deviceProtocols.getDeviceProtocols(),this.metaSvc.addDevice(this.newDevice).subscribe(s=>{this.errorSvc.handleErrorForAPI(s)||(this.msgSvc.success("Add device",`name: ${this.newDevice.name}`),this.router.navigate(["../device-list"],{relativeTo:this.route}))})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.D),e.Y36(b.e),e.Y36(ee.T),e.Y36(C.F0),e.Y36(C.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-device"]],viewQuery:function(t,_){if(1&t&&e.Gf(K,5),2&t){let o;e.iGM(o=e.CRH())&&(_.deviceProtocols=o.first)}},decls:54,vars:22,consts:function(){let c,t,_,o,s,a,g,I,p,m,O,v,M,x,h;return c="\u8BBE\u5907\u6DFB\u52A0\u5411\u5BFC",t="\u9009\u62E9\u8BBE\u5907\u670D\u52A1",_="\u9009\u62E9\u8BBE\u5907\u5143\u4FE1\u606F",o="\u8BBE\u5907\u4FE1\u606F",s="\u521B\u5EFA\u81EA\u52A8\u4E8B\u4EF6",a="\u521B\u5EFA\u8BBE\u5907\u901A\u4FE1\u534F\u8BAE",g="\u4E0A\u4E00\u9875",I="\u4E0B\u4E00\u9875",p="\u63D0\u4EA4",m="\u540D\u5B57",O="\u8BBE\u5907\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",v="\u63CF\u8FF0",M="\u6807\u7B7E",x="\u7BA1\u7406\u72B6\u6001",h=" this step is optional, you can skip it then set it later in edit mode.",[[1,"card"],[1,"card-header"],[1,"font-weight-bold"],[1,"fa","fa-lightbulb-o","fa-lg","mr-2","text-danger"],[1,"text-secondary"],c,[1,"card-header","py-2"],["aria-label","breadcrumb",1,"mb-0","p-0"],[1,"breadcrumb","p-1","mb-0","bg-light"],[1,"breadcrumb-item"],[3,"ngClass"],t,["class","fa fa-check ml-1",4,"ngIf"],_,o,s,[1,"breadcrumb-item","active"],a,[1,"card-header","py-1"],["class","btn btn-info btn-sm",3,"click",4,"ngIf"],["class","btn btn-primary btn-sm float-right",3,"disabled","click",4,"ngIf","ngIfElse"],["stepDone",""],[1,"card-body","p-0"],[3,"ngSwitch"],[3,"ngSwitchCase"],["SelectDeviceService",""],["SelectDeviceProfile",""],["DevicePrimary",""],["CreateAutoEvent",""],["CreateDeviceProtocol",""],[1,"card","border-0"],[1,"card-body"],[3,"mode","isValid","isValidChange"],[1,"fa","fa-check","ml-1"],[1,"btn","btn-info","btn-sm",3,"click"],[1,"fa","fa-long-arrow-left","mr-1"],g,[1,"btn","btn-primary","btn-sm","float-right",3,"disabled","click"],I,[1,"fa","fa-long-arrow-right","ml-1"],[1,"btn","btn-success","btn-sm","ml-4","float-right",3,"disabled","click"],[1,"fa","fa-save","mr-1"],p,[1,"p-2"],[3,"deviceSvcSelected","singleDeviceSvcSelectedEvent"],[3,"singleProfileSelected","enableSelectAll","toolbars","associatedDeviceColumn","singleProfileSelectedEvent"],[1,"px-5","py-4"],[1,"form-group","row","has-validation"],["for","deviceName","required","",1,"col-md-2","col-form-label"],m,[1,"col-md-10"],["type","text","id","validationDeviceNameFeedback","name","deviceName",1,"form-control",3,"ngModel","ngModelChange"],["id","validationDeviceNameFeedback",1,"invalid-feedback"],O,[1,"form-group","row"],["for","deviceDesc",1,"col-md-2","col-form-label"],v,["type","text","name","deviceDescription",1,"form-control",3,"ngModel","ngModelChange"],["for","deviceLabels",1,"col-md-2","col-form-label"],M,["type","text","name","deviceLabels","placeholder","Multiple Labels are separated by commas: label1,label2,label3",1,"form-control",3,"ngModel","ngModelChange"],["for","adminState",1,"col-md-2","col-form-label"],x,["name","deviceAdminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"],[1,"fa","fa-info-circle","text-warning","font-weight-bold"],h,[3,"deviceProfile","autoEvents","isValid","autoEventsChange","isValidChange"]]},template:function(t,_){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"span",2),e._UZ(3,"span",3),e.TgZ(4,"span",4),e.SDv(5,5),e.qZA(),e.qZA(),e.qZA(),e.TgZ(6,"div",6),e.TgZ(7,"nav",7),e.TgZ(8,"ol",8),e.TgZ(9,"li",9),e.TgZ(10,"span",10),e.TgZ(11,"span"),e.SDv(12,11),e.qZA(),e.YNc(13,Et,1,0,"i",12),e.qZA(),e.qZA(),e.TgZ(14,"li",9),e.TgZ(15,"span",10),e.TgZ(16,"span"),e.SDv(17,13),e.qZA(),e.YNc(18,dt,1,0,"i",12),e.qZA(),e.qZA(),e.TgZ(19,"li",9),e.TgZ(20,"span",10),e.TgZ(21,"span"),e.SDv(22,14),e.qZA(),e.YNc(23,Tt,1,0,"i",12),e.qZA(),e.qZA(),e.TgZ(24,"li",9),e.TgZ(25,"span",10),e.TgZ(26,"span"),e.SDv(27,15),e.qZA(),e.YNc(28,gt,1,0,"i",12),e.qZA(),e.qZA(),e.TgZ(29,"li",16),e.TgZ(30,"span",10),e.TgZ(31,"span"),e.SDv(32,17),e.qZA(),e.YNc(33,Ct,1,0,"i",12),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(34,"div",18),e.YNc(35,At,4,0,"button",19),e.YNc(36,pt,4,1,"button",20),e.YNc(37,ut,4,1,"ng-template",null,21,e.W1O),e.qZA(),e.TgZ(39,"div",22),e.TgZ(40,"div",23),e.YNc(41,ft,2,1,"ng-template",24,25,e.W1O),e.YNc(43,mt,2,4,"ng-template",24,26,e.W1O),e.YNc(45,Dt,28,8,"ng-template",24,27,e.W1O),e.YNc(47,vt,6,3,"ng-template",24,28,e.W1O),e.TgZ(49,"div",null,29),e.TgZ(51,"div",30),e.TgZ(52,"div",31),e.TgZ(53,"app-device-protocol",32),e.NdJ("isValidChange",function(s){return _.isProtocolValid=s}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t){const o=e.MAs(38);e.xp6(10),e.Q6J("ngClass",_.currentStep>=0?_.selectedClass:_.noSelectedClass),e.xp6(3),e.Q6J("ngIf",_.currentStep>=1),e.xp6(2),e.Q6J("ngClass",_.currentStep>=1?_.selectedClass:_.noSelectedClass),e.xp6(3),e.Q6J("ngIf",_.currentStep>=2),e.xp6(2),e.Q6J("ngClass",_.currentStep>=2?_.selectedClass:_.noSelectedClass),e.xp6(3),e.Q6J("ngIf",_.currentStep>=3),e.xp6(2),e.Q6J("ngClass",_.currentStep>=3?_.selectedClass:_.noSelectedClass),e.xp6(3),e.Q6J("ngIf",_.currentStep>=4),e.xp6(2),e.Q6J("ngClass",_.currentStep>=4?_.selectedClass:_.noSelectedClass),e.xp6(3),e.Q6J("ngIf",_.currentStep>=5),e.xp6(2),e.Q6J("ngIf",_.currentStep),e.xp6(1),e.Q6J("ngIf",4>_.currentStep)("ngIfElse",o),e.xp6(4),e.Q6J("ngSwitch",_.currentStep),e.xp6(1),e.Q6J("ngSwitchCase",0),e.xp6(2),e.Q6J("ngSwitchCase",1),e.xp6(2),e.Q6J("ngSwitchCase",2),e.xp6(2),e.Q6J("ngSwitchCase",3),e.xp6(2),e.Udp("display",4===_.currentStep?"":"none"),e.xp6(4),e.Q6J("mode","add")("isValid",_.isProtocolValid)}},directives:[n.mk,n.O5,n.RF,n.n9,K,ne,_e.f,l._Y,l.JL,l.F,l.Fj,l.JJ,l.On,l.EJ,l.YN,l.Kr,oe],styles:['.breadcrumb[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] + li[_ngcontent-%COMP%]:before{color:inherit;font-weight:inherit;content:">>";padding:0 5px}.btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}']}),i})();function It(i,c){if(1&i){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"div",2),e._UZ(2,"i",3),e.TgZ(3,"span",4),e.SDv(4,5),e.qZA(),e.TgZ(5,"span",6),e._uU(6),e.qZA(),e.TgZ(7,"button",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().save()}),e.TgZ(8,"span"),e._UZ(9,"i",8),e.TgZ(10,"span"),e.SDv(11,9),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(12,"div",10),e.TgZ(13,"div",11),e.TgZ(14,"div",2),e._UZ(15,"i",12),e.TgZ(16,"span"),e.SDv(17,13),e.qZA(),e.qZA(),e.TgZ(18,"div",10),e.TgZ(19,"form"),e.TgZ(20,"div",14),e.TgZ(21,"label",15),e.SDv(22,16),e.qZA(),e.TgZ(23,"div",17),e.TgZ(24,"input",18),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().device.name=o}),e.qZA(),e.TgZ(25,"div",19),e.SDv(26,20),e.qZA(),e.qZA(),e.qZA(),e.TgZ(27,"div",14),e.TgZ(28,"label",15),e.SDv(29,21),e.qZA(),e.TgZ(30,"div",17),e.TgZ(31,"input",22),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().device.description=o}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"div",14),e.TgZ(33,"label",15),e.SDv(34,23),e.qZA(),e.TgZ(35,"div",17),e.TgZ(36,"input",24),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().deviceLabels=o}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"div",14),e.TgZ(38,"label",25),e.SDv(39,26),e.qZA(),e.TgZ(40,"div",17),e.TgZ(41,"select",27),e.NdJ("ngModelChange",function(o){return e.CHM(t),e.oxw().device.adminState=o}),e.TgZ(42,"option",28),e._uU(43,"UNLOCKED"),e.qZA(),e.TgZ(44,"option",29),e._uU(45,"LOCKED"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(46,"div",14),e.TgZ(47,"label",30),e.SDv(48,31),e.qZA(),e.TgZ(49,"div",17),e._UZ(50,"input",32),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(51,"div",33),e.TgZ(52,"app-device-service-list",34),e.NdJ("singleDeviceSvcSelectedEvent",function(o){return e.CHM(t),e.oxw().onSingleDeviceSvcSelected(o)}),e.qZA(),e.qZA(),e.TgZ(53,"div",33),e.TgZ(54,"app-device-profile-list",35),e.NdJ("singleProfileSelectedEvent",function(o){return e.CHM(t),e.oxw().onSingleProfileSelected(o)}),e.qZA(),e.qZA(),e.TgZ(55,"div",33),e.TgZ(56,"app-device-protocol",36),e.NdJ("isValidChange",function(o){return e.CHM(t),e.oxw().isProtocolValid=o}),e.qZA(),e.qZA(),e.TgZ(57,"div",33),e.TgZ(58,"app-device-auto-event",37),e.NdJ("autoEventsChange",function(o){return e.CHM(t),e.oxw().device.autoEvents=o})("isValidChange",function(o){return e.CHM(t),e.oxw().isAutoEventsValid=o}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=e.oxw();e.xp6(6),e.Oqu(t.device.name),e.xp6(1),e.Q6J("disabled",t.validateBeforeSave()),e.xp6(17),e.ekj("is-invalid",""===t.device.name),e.Q6J("ngModel",t.device.name),e.xp6(7),e.Q6J("ngModel",t.device.description),e.xp6(5),e.Q6J("ngModel",t.deviceLabels),e.xp6(5),e.Q6J("ngModel",t.device.adminState),e.xp6(9),e.Q6J("value",t.device.operatingState),e.xp6(2),e.Q6J("deviceSvcSelected",t.selectedSvc),e.xp6(2),e.Q6J("enableSelectAll",!1)("toolbars",!1)("singleProfileSelected",t.selectedProfile)("associatedDeviceColumn",!1),e.xp6(2),e.Q6J("mode","edit")("deviceProtocols",t.device.protocols)("isValid",t.isProtocolValid),e.xp6(2),e.Q6J("deviceProfile",t.selectedProfile)("autoEvents",t.device.autoEvents)("isValid",t.isAutoEventsValid)}}let Mt=(()=>{class i{constructor(t,_,o,s,a){this.router=t,this.route=_,this.metaSvc=o,this.msgSvc=s,this.errorSvc=a,this.isProtocolValid=!0,this.isAutoEventsValid=!0}ngOnInit(){this.route.queryParams.subscribe(t=>{!t.deviceName||this.metaSvc.findDeviceByName(t.deviceName).subscribe(o=>{var s;this.device=o.device,this.deviceLabels=null===(s=this.device.labels)||void 0===s?void 0:s.join(","),this.setDefaultDeviceSvcSelected(this.device.serviceName),this.setDefaultDeviceProfileSelected(this.device.profileName)})})}onSingleProfileSelected(t){this.selectedProfile=t}onSingleDeviceSvcSelected(t){this.selectedSvc=t}setDefaultDeviceSvcSelected(t){this.metaSvc.findDevcieServiceByName(t).subscribe(_=>{this.selectedSvc=_.service})}setDefaultDeviceProfileSelected(t){this.metaSvc.findProfileByName(t).subscribe(_=>{this.selectedProfile=_.profile})}validateBeforeSave(){return""===this.device.name||!this.isAutoEventsValid||!this.isProtocolValid}save(){var t,_,o;this.device.labels=null===(t=this.deviceLabels)||void 0===t?void 0:t.split(","),this.device.serviceName=null===(_=this.selectedSvc)||void 0===_?void 0:_.name,this.device.profileName=null===(o=this.selectedProfile)||void 0===o?void 0:o.name,this.device.protocols=this.deviceProtocols.getDeviceProtocols(),this.metaSvc.updateDevice(this.device).subscribe(s=>{var a;this.errorSvc.handleErrorForAPI(s)||(this.msgSvc.success("update device",`name: ${null===(a=this.device)||void 0===a?void 0:a.name}`),this.router.navigate(["../device-list"],{relativeTo:this.route}))})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.F0),e.Y36(C.gz),e.Y36(D.D),e.Y36(b.e),e.Y36(ee.T))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-device"]],viewQuery:function(t,_){if(1&t&&e.Gf(K,5),2&t){let o;e.iGM(o=e.CRH())&&(_.deviceProtocols=o.first)}},decls:1,vars:1,consts:function(){let c,t,_,o,s,a,g,I,p;return c="\u7F16\u8F91\u8BBE\u5907",t="\u4FDD\u5B58",_="\u8BBE\u5907\u57FA\u672C\u4FE1\u606F",o="\u8BBE\u5907\u540D\u5B57",s="\u8BBE\u5907\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A\uFF01",a="\u63CF\u8FF0",g="\u6807\u7B7E",I="\u7BA1\u7406\u72B6\u6001",p="\u64CD\u4F5C\u72B6\u6001",[["class","card",4,"ngIf"],[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-edit","text-danger","fa-lg"],[1,"mx-2"],c,[1,"text-primary"],["type","button",1,"btn","btn-success","btn-sm","float-right",3,"disabled","click"],[1,"fa","fa-save","mr-1"],t,[1,"card-body"],[1,"card","mb-3"],[1,"fa","fa-tags","fa-lg","text-danger","mr-1"],_,[1,"form-group","row"],[1,"col-md-2","col-form-label"],o,[1,"col-md-10"],["type","text","name","name","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"invalid-feedback"],s,a,["type","text","name","description",1,"form-control",3,"ngModel","ngModelChange"],g,["type","text","name","labels",1,"form-control",3,"ngModel","ngModelChange"],["for","adminState",1,"col-md-2","col-form-label"],I,["name","adminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"],["for","operatingState",1,"col-md-2","col-form-label"],p,["type","text","name","operatingState","disabled","",1,"form-control",3,"value"],[1,"mb-3"],[3,"deviceSvcSelected","singleDeviceSvcSelectedEvent"],[3,"enableSelectAll","toolbars","singleProfileSelected","associatedDeviceColumn","singleProfileSelectedEvent"],[3,"mode","deviceProtocols","isValid","isValidChange"],[3,"deviceProfile","autoEvents","isValid","autoEventsChange","isValidChange"]]},template:function(t,_){1&t&&e.YNc(0,It,59,20,"div",0),2&t&&e.Q6J("ngIf",_.device)},directives:[n.O5,l._Y,l.JL,l.F,l.Fj,l.Q7,l.JJ,l.On,l.EJ,l.YN,l.Kr,ne,_e.f,K,oe],styles:["input[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}.btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),i})(),Pt=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-device-profile-center"]],decls:1,vars:0,template:function(t,_){1&t&&e._UZ(0,"router-outlet")},directives:[C.lC],styles:[""]}),i})(),ht=(()=>{class i{constructor(t,_,o,s,a){this.metaSvc=t,this.msgSvc=_,this.errSvc=o,this.router=s,this.route=a}ngOnInit(){this.renderYamlSource()}renderYamlSource(){let t=document.getElementById("editor");this.codeMirrorEditor=CodeMirror.fromTextArea(t,{mode:"yaml",theme:"gruvbox-dark",foldGutter:!0,smartIndent:!0,showCursorWhenSelecting:!0,lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],autofocus:!0,matchBrackets:!0,autoCloseBrackets:!0,styleActiveLine:!0,cursorHeight:.85,autocorrect:!0}),this.codeMirrorEditor.setSize("auto","600px"),this.codeMirrorEditor.on("drop",(_,o)=>{var s;this.yamlFile=null===(s=o.dataTransfer)||void 0===s?void 0:s.files[0]}),this.codeMirrorEditor.on("paste",(_,o)=>{})}submit(){this.profileYamlSource=this.codeMirrorEditor.getValue(),this.metaSvc.addProfileYamlByNameViaUIBackend(this.profileYamlSource).subscribe(t=>{this.errSvc.handleErrorForAPI(t)||(this.msgSvc.success("Add profile"),this.router.navigate(["../device-profile-list"],{relativeTo:this.route}))})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.D),e.Y36(b.e),e.Y36(ee.T),e.Y36(C.F0),e.Y36(C.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-profile"]],decls:15,vars:0,consts:function(){let c,t,_;return c="\u6DFB\u52A0\u8BBE\u5907\u5143\u4FE1\u606F",t="\u62D6\u62FD\u529F\u80FD\u5DF2\u5F00\u542F",_="\u63D0\u4EA4",[[1,"card"],[1,"card-header"],[1,"text-danger","font-weight-bold","fa","fa-code","mr-2"],[1,"mr-3","font-weight-bold"],c,[1,"fa","fa-info-circle","text-success","font-weight-bold"],t,[1,"float-right"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save","mr-1"],_,[1,"card-body","p-0"],["id","editor","name","editor"]]},template:function(t,_){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"span"),e._UZ(3,"span",2),e.TgZ(4,"span",3),e.SDv(5,4),e.qZA(),e.TgZ(6,"span",5),e.SDv(7,6),e.qZA(),e.qZA(),e.TgZ(8,"span",7),e.TgZ(9,"button",8),e.NdJ("click",function(){return _.submit()}),e._UZ(10,"i",9),e.TgZ(11,"span"),e.SDv(12,10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",11),e._UZ(14,"textarea",12),e.qZA(),e.qZA())},styles:[""]}),i})(),Nt=(()=>{class i{constructor(t,_,o,s,a){this.metaSvc=t,this.msgSvc=_,this.errSvc=o,this.router=s,this.route=a}ngOnInit(){this.renderYamlSource(),this.route.queryParams.subscribe(t=>{t.profileName&&(this.profileName=t.profileName,this.metaSvc.findProfileYamlByNameViaUIBackend(t.profileName).subscribe(_=>{this.codeMirrorEditor.setValue(_),this.codeMirrorEditor.refresh()}))})}update(){this.codeMirrorEditor.refresh(),this.metaSvc.updateProfileYamlContentViaUIBackend(this.codeMirrorEditor.getValue()).subscribe(t=>{this.errSvc.handleErrorForAPI(t)||(this.msgSvc.success("Update profile",`name: ${this.profileName}`),this.router.navigate(["../device-profile-list"],{relativeTo:this.route}))})}renderYamlSource(){let t=document.getElementById("editor-edit");this.codeMirrorEditor=CodeMirror.fromTextArea(t,{mode:"yaml",theme:"gruvbox-dark",foldGutter:!0,smartIndent:!0,showCursorWhenSelecting:!0,lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],autofocus:!0,matchBrackets:!0,autoCloseBrackets:!0,styleActiveLine:!0,cursorHeight:.85,autocorrect:!0}),this.codeMirrorEditor.setSize("auto","600px")}ngOnDestroy(){this.codeMirrorEditor=null}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(D.D),e.Y36(b.e),e.Y36(ee.T),e.Y36(C.F0),e.Y36(C.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-profile"]],decls:13,vars:1,consts:function(){let c;return c="\u4FDD\u5B58",[[1,"card"],[1,"card-header"],[1,"text-danger","fa","fa-edit","mr-2"],[1,"float-right"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save","mr-1"],c,[1,"card-body","p-0"],["id","editor-edit","name","editor"]]},template:function(t,_){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"span"),e._UZ(3,"span",2),e._uU(4),e.qZA(),e.TgZ(5,"span",3),e.TgZ(6,"button",4),e.NdJ("click",function(){return _.update()}),e.TgZ(7,"span"),e._UZ(8,"i",5),e.TgZ(9,"span"),e.SDv(10,6),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",7),e._UZ(12,"textarea",8),e.qZA(),e.qZA()),2&t&&(e.xp6(4),e.hij("",_.profileName," "))},styles:[""]}),i})(),Zt=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-provision-watcher-center"]],decls:2,vars:0,template:function(t,_){1&t&&(e.TgZ(0,"p"),e._uU(1,"provision-watcher-center works!"),e.qZA())},styles:[""]}),i})(),Ot=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-provision-watcher-list"]],decls:2,vars:0,template:function(t,_){1&t&&(e.TgZ(0,"p"),e._uU(1,"provision-watcher-list works!"),e.qZA())},styles:[""]}),i})(),Vt=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-provision-watcher"]],decls:2,vars:0,template:function(t,_){1&t&&(e.TgZ(0,"p"),e._uU(1,"add-provision-watcher works!"),e.qZA())},styles:[""]}),i})(),Lt=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit-provision-watcher"]],decls:2,vars:0,template:function(t,_){1&t&&(e.TgZ(0,"p"),e._uU(1,"edit-provision-watcher works!"),e.qZA())},styles:[""]}),i})();var Rt=T(8253),bt=T(1964),$t=T(4294),xt=T(5894),qt=T(7216);let ce=(()=>{class i{constructor(t,_){this.router=t,this.metadataSvc=_}canActivate(t,_){return this.checkAvailable(t,_)}canActivateChild(t,_){return this.canActivate(t,_)}checkAvailable(t,_){return this.metadataSvc.ping().pipe((0,$t.q)(1),(0,xt.K)(o=>this.router.navigate(["/svc-unavailable"],{queryParams:{svcName:"metadata",routerPath:`/${_.url.split("/")[1]}`}})),(0,qt.z)(()=>(0,bt.of)(!0)))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(C.F0),e.LFG(D.D))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const yt=[{path:"",component:y,canActivate:[Rt.a,ce],canActivateChild:[ce],children:[{path:"",redirectTo:"device-service-list",pathMatch:"full"},{path:"device-service-list",component:V},{path:"device-center",component:r,children:[{path:"",redirectTo:"device-list",pathMatch:"full"},{path:"device-list",component:Je},{path:"add-device",component:St},{path:"edit-device",component:Mt}]},{path:"device-profile-center",component:Pt,children:[{path:"",redirectTo:"device-profile-list",pathMatch:"full"},{path:"device-profile-list",component:_e.f},{path:"edit-profile",component:Nt},{path:"add-profile",component:ht}]},{path:"provision-watcher-center",component:Zt,children:[{path:"",redirectTo:"provision-watcher-list",pathMatch:"full"},{path:"provision-watcher-list",component:Ot},{path:"edit-provision-watcher",component:Lt},{path:"add-provision-watcher",component:Vt}]}]}];let wt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[C.Bz.forChild(yt)],C.Bz]}),i})(),Gt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[n.ez,l.u5,wt,l.UX]]}),i})()},2822:(ie,q,T)=>{T.d(q,{f:()=>te});var n=T(476),l=T(2437),C=T(7822),e=T(9502),y=T(8583),D=T(3092);function b(f,V){if(1&f){const r=n.EpF();n.TgZ(0,"div",50),n.TgZ(1,"div",51),n.TgZ(2,"button",52),n.NdJ("click",function(){return n.CHM(r),n.oxw().refresh()}),n.TgZ(3,"span"),n._UZ(4,"i",53),n.TgZ(5,"span"),n.SDv(6,54),n.qZA(),n.qZA(),n.qZA(),n.TgZ(7,"button",55),n.TgZ(8,"span"),n._UZ(9,"i",56),n.TgZ(10,"span"),n.SDv(11,57),n.qZA(),n.qZA(),n.qZA(),n.TgZ(12,"button",58),n.NdJ("click",function(){return n.CHM(r),n.oxw().edit()}),n.TgZ(13,"span"),n._UZ(14,"i",59),n.TgZ(15,"span"),n.SDv(16,60),n.qZA(),n.qZA(),n.qZA(),n.TgZ(17,"button",61),n.NdJ("click",function(){return n.CHM(r),n.oxw().deleteConfirm()}),n.TgZ(18,"span"),n._UZ(19,"i",62),n.TgZ(20,"span"),n.SDv(21,63),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&f){const r=n.oxw();n.xp6(12),n.Q6J("disabled",1!==r.multiProfilesSelected.length),n.xp6(5),n.Q6J("disabled",0===r.multiProfilesSelected.length)}}function u(f,V){if(1&f){const r=n.EpF();n.TgZ(0,"input",64),n.NdJ("click",function(A){return n.CHM(r),n.oxw().selectAll(A)}),n.qZA()}if(2&f){const r=n.oxw();n.Q6J("checked",r.isCheckedAll())}}function S(f,V){1&f&&(n.TgZ(0,"th",9),n.SDv(1,65),n.qZA())}const Z=function(f){return{profileName:f}};function R(f,V){if(1&f&&(n.TgZ(0,"td",69),n.TgZ(1,"a",70),n._UZ(2,"i",71),n.qZA(),n.qZA()),2&f){const r=n.oxw().$implicit;n.xp6(1),n.Q6J("queryParams",n.VKq(1,Z,r.name))}}function G(f,V){if(1&f){const r=n.EpF();n.TgZ(0,"tr"),n.TgZ(1,"td"),n.TgZ(2,"input",66),n.NdJ("click",function(A){const w=n.CHM(r).$implicit;return n.oxw().selectOne(A,w.name)}),n.qZA(),n.qZA(),n.TgZ(3,"td",67),n._uU(4),n.qZA(),n.TgZ(5,"td",67),n._uU(6),n.qZA(),n.TgZ(7,"td"),n._uU(8),n.qZA(),n.YNc(9,R,3,3,"td",68),n.TgZ(10,"td"),n._uU(11),n.qZA(),n.TgZ(12,"td"),n._uU(13),n.qZA(),n.TgZ(14,"td"),n._uU(15),n.qZA(),n.qZA()}if(2&f){const r=V.$implicit,E=n.oxw();n.ekj("table-active",E.isChecked(r.name)),n.xp6(2),n.s9C("value",r.name),n.Q6J("checked",E.isChecked(r.name)),n.xp6(2),n.Oqu(r.id),n.xp6(2),n.Oqu(r.name),n.xp6(2),n.Oqu(r.description),n.xp6(1),n.Q6J("ngIf",E.associatedDeviceColumn),n.xp6(2),n.Oqu(r.labels),n.xp6(2),n.Oqu(r.manufacturer),n.xp6(2),n.Oqu(r.model)}}let te=(()=>{class f{constructor(r,E,A,L){this.metaSvc=r,this.msgSvc=E,this.route=A,this.router=L,this.associatedDeviceColumn=!0,this.toolbars=!0,this.enableSelectAll=!0,this.singleProfileSelectedEvent=new n.vpe,this.multipleProfileSelectedEvent=new n.vpe,this.profileList=[],this.multiProfilesSelected=[],this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.route.queryParams.subscribe(r=>{r.profileName?this.metaSvc.findProfileByName(r.profileName).subscribe(E=>{this.profileList=[],this.profileList.push(E.profile)}):this.findAllDeviceProfilesPagination()})}findAllDeviceProfilesPagination(){this.metaSvc.allDeviceProfolesPagination(this.pageOffset,this.pageLimit).subscribe(r=>{this.profileList=r.profiles})}onSingleProfileSelectedEmitter(){this.singleProfileSelectedEvent.emit(this.singleProfileSelected)}onMultipleProfileSelectedEmitter(){this.multipleProfileSelectedEvent.emit(this.multiProfilesSelected)}refresh(){this.metaSvc.allDeviceProfolesPagination(0,this.pageLimit).subscribe(r=>{this.profileList=r.profiles,this.msgSvc.success("refresh"),this.pagination=1,this.resetCheckbox()})}onPageSelected(){this.resetPagination(),this.setPagination(),this.findAllDeviceProfilesPagination()}prePage(){this.setPagination(-1),this.metaSvc.allDeviceProfolesPagination(this.pageOffset,this.pageLimit).subscribe(r=>{this.profileList=r.profiles})}nextPage(){this.setPagination(1),this.metaSvc.allDeviceProfolesPagination(this.pageOffset,this.pageLimit).subscribe(r=>{this.profileList=r.profiles})}setPageLimit(r){this.pageLimit=r}setPagination(r){1===r?this.pagination+=1:-1===r&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit,this.resetCheckbox()}resetPagination(){this.pagination=1,this.resetCheckbox()}resetCheckbox(){}edit(){this.router.navigate(["../edit-profile"],{relativeTo:this.route,queryParams:{profileName:this.multiProfilesSelected[0]}})}deleteConfirm(){$("#deleteConfirmDialog").modal("show")}delete(){this.multiProfilesSelected.forEach(r=>{this.metaSvc.deleteProfileByName(r).subscribe(()=>{this.multiProfilesSelected=[],this.profileList.forEach((E,A)=>{E.name==r&&(this.profileList.splice(A,1),this.msgSvc.success("delete",`  Name: ${E.name}`))})})}),$("#deleteConfirmDialog").modal("hide")}isSingleProfileChecked(r){var E;return(null===(E=this.singleProfileSelected)||void 0===E?void 0:E.name)===r}selectSingleProfile(r,E){r.target.checked?this.profileList.forEach(L=>{L.name===E&&(this.singleProfileSelected=L)}):this.singleProfileSelected=void 0,this.onSingleProfileSelectedEmitter()}isCheckedAll(){let r=!0;return this.profileList&&0===this.profileList.length&&(r=!1),this.profileList.forEach(E=>{-1===this.multiProfilesSelected.indexOf(E.name)&&(r=!1)}),r}selectAll(r){this.profileList.forEach(r.target.checked?A=>{this.multiProfilesSelected.includes(A.name)||this.multiProfilesSelected.push(A.name)}:A=>{this.multiProfilesSelected.includes(A.name)&&this.multiProfilesSelected.splice(this.multiProfilesSelected.indexOf(A.name),1)}),this.onMultipleProfileSelectedEmitter()}isChecked(r){return this.enableSelectAll?this.multiProfilesSelected.includes(r):this.isSingleProfileChecked(r)}selectOne(r,E){this.enableSelectAll?(r.target.checked?this.multiProfilesSelected.push(E):this.multiProfilesSelected.splice(this.multiProfilesSelected.indexOf(E),1),this.onMultipleProfileSelectedEmitter()):this.selectSingleProfile(r,E)}}return f.\u0275fac=function(r){return new(r||f)(n.Y36(l.D),n.Y36(C.e),n.Y36(e.gz),n.Y36(e.F0))},f.\u0275cmp=n.Xpm({type:f,selectors:[["app-device-profile-list"]],inputs:{associatedDeviceColumn:"associatedDeviceColumn",toolbars:"toolbars",enableSelectAll:"enableSelectAll",multiProfilesSelected:"multiProfilesSelected",singleProfileSelected:"singleProfileSelected"},outputs:{singleProfileSelectedEvent:"singleProfileSelectedEvent",multipleProfileSelectedEvent:"multipleProfileSelectedEvent"},decls:67,vars:7,consts:function(){let V,r,E,A,L,w,X,U,F,k,J,z,Y,Q,B,W,H,j;return V="\u8BBE\u5907\u5143\u4FE1\u606F\u5217\u8868",r="\u540D\u5B57",E="\u63CF\u8FF0",A="\u6807\u7B7E",L="\u7EF4\u62A4\u8005",w="\u6A21\u5F0F",X="\u6BCF\u9875\u6761\u76EE",U="\u4E0A\u4E00\u9875",F="\u4E0B\u4E00\u9875",k="\u8B66\u544A",J="\u6570\u636E\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\uFF01\uFF01\uFF01\u786E\u5B9A\u8981\u6267\u884C\u5220\u9664\u64CD\u4F5C\u5417\uFF1F",z="\u53D6\u6D88",Y="\u786E\u8BA4",Q="\u5237\u65B0",B="\u6DFB\u52A0",W="\u7F16\u8F91",H="\u5220\u9664",j="\u76F8\u5173\u8BBE\u5907",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-list","text-danger","mr-2"],V,[1,"card-body","p-0"],["class","bg-light px-2 py-2",4,"ngIf"],[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],["type","checkbox",3,"checked","click",4,"ngIf"],r,E,["scope","col",4,"ngIf"],A,L,w,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],X,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],U,[1,"page-item"],F,[1,"fa","fa-angle-double-right","ml-1"],["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],k,[1,"modal-body"],J,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],z,["type","button",1,"btn","btn-danger",3,"click"],Y,[1,"bg-light","px-2","py-2"],["role","group",1,"btn-group","btn-group-sm"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-refresh","mr-1"],Q,["type","button","routerLink","../add-profile",1,"btn","btn-info"],[1,"fa","fa-plus","mr-1"],B,["type","button","data-toggle","tooltip","data-placement","top","title","only one should be selected",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-edit","mr-1"],W,["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash","mr-1"],H,["type","checkbox",3,"checked","click"],j,["type","checkbox",3,"value","checked","click"],[1,"user-select-all"],["class","text-center",4,"ngIf"],[1,"text-center"],["routerLink","../../device-center",1,"badge","badge-pill","badge-primary",3,"queryParams"],[1,"fa","fa-sitemap"]]},template:function(r,E){1&r&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n._UZ(2,"i",2),n.TgZ(3,"span"),n.SDv(4,3),n.qZA(),n.qZA(),n.TgZ(5,"div",4),n.YNc(6,b,22,2,"div",5),n.TgZ(7,"div",6),n.TgZ(8,"table",7),n.TgZ(9,"thead",8),n.TgZ(10,"tr"),n.TgZ(11,"th",9),n.YNc(12,u,1,1,"input",10),n.qZA(),n.TgZ(13,"th",9),n._uU(14,"ID"),n.qZA(),n.TgZ(15,"th",9),n.SDv(16,11),n.qZA(),n.TgZ(17,"th",9),n.SDv(18,12),n.qZA(),n.YNc(19,S,2,0,"th",13),n.TgZ(20,"th",9),n.SDv(21,14),n.qZA(),n.TgZ(22,"th",9),n.SDv(23,15),n.qZA(),n.TgZ(24,"th",9),n.SDv(25,16),n.qZA(),n.qZA(),n.qZA(),n.TgZ(26,"tbody"),n.YNc(27,G,16,11,"tr",17),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(28,"div",18),n.TgZ(29,"nav",19),n.TgZ(30,"ul",20),n.TgZ(31,"li",21),n.TgZ(32,"span",22),n.SDv(33,23),n.qZA(),n.qZA(),n.TgZ(34,"li",24),n.TgZ(35,"select",25),n.NdJ("ngModelChange",function(L){return E.pageLimit=L})("ngModelChange",function(){return E.onPageSelected()}),n.TgZ(36,"option",26),n._uU(37,"5"),n.qZA(),n.TgZ(38,"option",27),n._uU(39,"10"),n.qZA(),n.TgZ(40,"option",28),n._uU(41,"20"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(42,"li",29),n.TgZ(43,"button",30),n.NdJ("click",function(){return E.prePage()}),n._UZ(44,"i",31),n.TgZ(45,"span"),n.SDv(46,32),n.qZA(),n.qZA(),n.qZA(),n.TgZ(47,"li",33),n.TgZ(48,"button",30),n.NdJ("click",function(){return E.nextPage()}),n.TgZ(49,"span"),n.SDv(50,34),n.qZA(),n._UZ(51,"i",35),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(52,"div",36),n.TgZ(53,"div",37),n.TgZ(54,"div",38),n.TgZ(55,"div",39),n.TgZ(56,"h5",40),n._UZ(57,"i",41),n.TgZ(58,"span"),n.SDv(59,42),n.qZA(),n.qZA(),n.qZA(),n.TgZ(60,"div",43),n.SDv(61,44),n.qZA(),n.TgZ(62,"div",45),n.TgZ(63,"button",46),n.SDv(64,47),n.qZA(),n.TgZ(65,"button",48),n.NdJ("click",function(){return E.delete()}),n.SDv(66,49),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&r&&(n.xp6(6),n.Q6J("ngIf",E.toolbars),n.xp6(6),n.Q6J("ngIf",E.enableSelectAll),n.xp6(7),n.Q6J("ngIf",E.associatedDeviceColumn),n.xp6(8),n.Q6J("ngForOf",E.profileList),n.xp6(8),n.Q6J("ngModel",E.pageLimit),n.xp6(8),n.Q6J("disabled",1===E.pagination),n.xp6(5),n.Q6J("disabled",E.pageLimit>E.profileList.length))},directives:[y.O5,y.sg,D.EJ,D.JJ,D.On,D.YN,D.Kr,e.rH,e.yS],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),f})()},7982:(ie,q,T)=>{T.d(q,{V:()=>y});var n=T(1841),l=T(5894),C=T(476),e=T(4889);let y=(()=>{class D{constructor(u,S){this.http=u,this.errorSvc=S,this.endpoint="/core-command",this.version="/api/v3",this.urlPrefix=`${this.endpoint}${this.version}`,this.endpointHealthUrl="/ping",this.versionUrl="/version",this.configUrl="/config",this.deviceCoreCommandListUrl=`${this.urlPrefix}/device/all`,this.commandsByDeviceIdUrl=`${this.urlPrefix}/device/`,this.commandsByDeviceNameUrl=`${this.urlPrefix}/device/name/`,this.issueCmdByDeviceNameAndCmdNameUrl=`${this.urlPrefix}/device/name/`,this.httpPostOrPutJSONOptions={headers:new n.WM({"Content-type":"application/json"})}}getConfig(){return this.http.get(`${this.urlPrefix}${this.configUrl}`).pipe((0,l.K)(S=>this.errorSvc.handleError(S)))}findCommnadsByDeviceId(u){return this.http.get(`${this.commandsByDeviceIdUrl}${u}`).pipe((0,l.K)(Z=>this.errorSvc.handleError(Z)))}allDeviceCoreCommandsPagination(u,S){return this.http.get(`${this.deviceCoreCommandListUrl}?offset=${u}&limit=${S}`).pipe((0,l.K)(R=>this.errorSvc.handleError(R)))}findDeviceAssociatedCommnadsByDeviceName(u){return this.http.get(`${this.commandsByDeviceNameUrl}${u}`).pipe((0,l.K)(Z=>this.errorSvc.handleError(Z)))}findAllDeviceCommnads(){return this.http.get(`${this.urlPrefix}/device`).pipe((0,l.K)(S=>this.errorSvc.handleError(S)))}issueGetBinaryCmd(u,S){return this.http.request("GET",`${this.commandsByDeviceIdUrl}${u}/command/${S}`,{responseType:"arraybuffer"}).pipe((0,l.K)(R=>this.errorSvc.handleError(R)))}issueGetCmd(u,S){return this.http.get(`${this.issueCmdByDeviceNameAndCmdNameUrl}${u}/${S}?ds-pushevent=true&ds-returnevent=true`).pipe((0,l.K)(R=>this.errorSvc.handleError(R)))}issueSetCmd(u,S,Z){return this.http.put(`${this.issueCmdByDeviceNameAndCmdNameUrl}${u}/${S}`,JSON.stringify(Z),this.httpPostOrPutJSONOptions).pipe((0,l.K)(G=>this.errorSvc.handleError(G)))}}return D.\u0275fac=function(u){return new(u||D)(C.LFG(n.eN),C.LFG(e.T))},D.\u0275prov=C.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})()}}]);