"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[10],{4010:(i_,b,C)=>{C.r(b),C.d(b,{MetadataModule:()=>xe});var n=C(8583),a=C(3092),A=C(9502),_=C(476);let X=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-metadata"]],decls:14,vars:0,consts:function(){let E,e,t;return E="\u8BBE\u5907\u670D\u52A1",e="\u8BBE\u5907",t="\u8BBE\u5907\u5143\u4FE1\u606F",[[1,"card"],[1,"card-header"],[1,"nav","nav-tabs","card-header-tabs","font-weight-bold"],[1,"nav-item"],["routerLink","./device-service-list","routerLinkActive","active",1,"nav-link"],E,["routerLink","./device-center","routerLinkActive","active",1,"nav-link"],e,["routerLink","./device-profile-center","routerLinkActive","active",1,"nav-link"],t,[1,"card-body"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"ul",2),_.TgZ(3,"li",3),_.TgZ(4,"a",4),_.SDv(5,5),_.qZA(),_.qZA(),_.TgZ(6,"li",3),_.TgZ(7,"a",6),_.SDv(8,7),_.qZA(),_.qZA(),_.TgZ(9,"li",3),_.TgZ(10,"a",8),_.SDv(11,9),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(12,"div",10),_._UZ(13,"router-outlet"),_.qZA(),_.qZA())},directives:[A.yS,A.Od,A.lC],styles:[".active-link[_ngcontent-%COMP%]{color:#922c48;background-color:#922c4866!important}"]}),i})();var p=C(2437),V=C(7822);function I(i,E){if(1&i&&(_.TgZ(0,"p"),_._uU(1),_.qZA()),2&i){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.description)}}function M(i,E){1&i&&(_.TgZ(0,"p",20),_._uU(1,"no description."),_.qZA())}function U(i,E){if(1&i&&(_.TgZ(0,"span",21),_._uU(1),_.qZA()),2&i){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.adminState)}}function Z(i,E){if(1&i&&(_.TgZ(0,"span",22),_._uU(1),_.qZA()),2&i){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.adminState)}}function x(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"a",23),_.NdJ("click",function(){_.CHM(e);const o=_.oxw().$implicit;return _.oxw().associatedDevicesSkip(o.name)}),_._UZ(1,"i",24),_.TgZ(2,"span"),_.SDv(3,25),_.qZA(),_._uU(4),_.qZA()}if(2&i){const e=_.oxw().$implicit,t=_.oxw();_.xp6(4),_.hij("\xa0 ",t.associatedDevices.get(e.name)," ")}}function e_(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"li",3),_.TgZ(1,"div",4),_.TgZ(2,"div",5),_._UZ(3,"i",6),_.qZA(),_.TgZ(4,"div",7),_.TgZ(5,"div",8),_.TgZ(6,"h5",9),_._uU(7),_.qZA(),_.qZA(),_.YNc(8,I,2,1,"p",10),_.YNc(9,M,2,0,"ng-template",null,11,_.W1O),_.TgZ(11,"div"),_.TgZ(12,"span",12),_._uU(13),_.qZA(),_.TgZ(14,"span",13),_.YNc(15,U,2,1,"span",14),_.YNc(16,Z,2,1,"span",15),_.qZA(),_.YNc(17,x,5,1,"a",16),_.TgZ(18,"span",17),_.NdJ("click",function(){const c=_.CHM(e).$implicit;return _.oxw().edit(c)}),_._UZ(19,"i",18),_.TgZ(20,"span"),_.SDv(21,19),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=E.$implicit,t=_.MAs(10),o=_.oxw();_.xp6(7),_.Oqu(e.name),_.xp6(1),_.Q6J("ngIf",e.description)("ngIfElse",t),_.xp6(5),_.hij("Port ",o.getSvcPort(e.baseAddress),""),_.xp6(1),_.Q6J("ngSwitch",e.adminState),_.xp6(1),_.Q6J("ngSwitchCase","UNLOCKED"),_.xp6(2),_.Q6J("ngIf",o.associatedDevices.size)}}function g(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div",26),_.TgZ(1,"div",27),_._UZ(2,"i",28),_.TgZ(3,"span"),_.SDv(4,29),_.qZA(),_.TgZ(5,"span",30),_._uU(6),_.qZA(),_.TgZ(7,"button",31),_.NdJ("click",function(){return _.CHM(e),_.oxw().updateSvc()}),_.SDv(8,32),_.qZA(),_.qZA(),_.TgZ(9,"div",33),_.TgZ(10,"form"),_.TgZ(11,"div",34),_.TgZ(12,"label",35),_.SDv(13,36),_.qZA(),_.TgZ(14,"div",37),_.TgZ(15,"input",38),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().deviceSvcSelected.description=o}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(16,"div",34),_.TgZ(17,"label",39),_.SDv(18,40),_.qZA(),_.TgZ(19,"div",37),_.TgZ(20,"select",41),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().deviceSvcSelected.adminState=o}),_.TgZ(21,"option",42),_._uU(22,"UNLOCKED"),_.qZA(),_.TgZ(23,"option",43),_._uU(24,"LOCKED"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=_.oxw();_.xp6(6),_.Oqu(e.deviceSvcSelected.name),_.xp6(9),_.Q6J("ngModel",e.deviceSvcSelected.description),_.xp6(5),_.Q6J("ngModel",e.deviceSvcSelected.adminState)}}let P=(()=>{class i{constructor(e,t,o,c){this.metaSvc=e,this.msgSvc=t,this.router=o,this.route=c,this.deviceServiceList=[],this.associatedDevices=new Map}ngOnInit(){this.metaSvc.allDeviceServices().subscribe(e=>{this.deviceServiceList=e.services,this.deviceServiceList.forEach(t=>{this.metaSvc.findDevicesByServiceName(0,20,t.name).subscribe(o=>{this.associatedDevices.set(t.name,o.devices.length>20?"20+":String(o.devices.length))})})})}getSvcPort(e){return new URL(e).port}edit(e){this.deviceSvcSelected=e}updateSvc(){this.metaSvc.updateDeviceService(this.deviceSvcSelected).subscribe(()=>{var e;this.msgSvc.success("update device service",`name: ${null===(e=this.deviceSvcSelected)||void 0===e?void 0:e.name}`),this.deviceSvcSelected=void 0})}associatedDevicesSkip(e){this.router.navigate(["../device-center"],{queryParams:{svcName:e},relativeTo:this.route})}}return i.\u0275fac=function(e){return new(e||i)(_.Y36(p.D),_.Y36(V.e),_.Y36(A.F0),_.Y36(A.gz))},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-device-service-media-list"]],decls:3,vars:2,consts:function(){let E,e,t,o,c,s;return E="\u8BBE\u7F6E",e="\u5173\u8054\u8BBE\u5907",t="\u7F16\u8F91",o="\u4FDD\u5B58",c="\u63CF\u8FF0",s="\u7BA1\u7406\u72B6\u6001",[[1,"list-group","p-0"],["class","list-group-item list-group-item-action list-group-item-light",4,"ngFor","ngForOf"],["class","card mt-3",4,"ngIf"],[1,"list-group-item","list-group-item-action","list-group-item-light"],[1,"media"],[1,"align-self-center","mr-3"],[1,"fa","fa-tags","fa-2x","text-secondary"],[1,"media-body"],[1,"mt-0","mb-1"],[1,"d-inline","mr-3","align-middle","text-dark"],[4,"ngIf","ngIfElse"],["nodesc",""],[1,"badge","badge-info","mr-3"],[3,"ngSwitch"],["class","badge badge-success mr-3",4,"ngSwitchCase"],["class","badge badge-danger mr-3",4,"ngSwitchDefault"],["class","badge badge-primary","role","button",3,"click",4,"ngIf"],["role","button",1,"badge","badge-secondary","float-right",3,"click"],[1,"fa","fa-cog","mr-1"],E,[1,"my-1"],[1,"badge","badge-success","mr-3"],[1,"badge","badge-danger","mr-3"],["role","button",1,"badge","badge-primary",3,"click"],[1,"fa","fa-sitemap","mr-1"],e,[1,"card","mt-3"],[1,"card-header"],[1,"fa","fa-edit","mr-1","text-danger"],t,[1,"ml-1"],[1,"btn","btn-success","btn-sm","float-right",3,"click"],o,[1,"card-body"],[1,"form-group","row"],["for","deviceDesc",1,"col-md-2","col-form-label"],c,[1,"col-md-10"],["type","text","name","deviceSvcDescription",1,"form-control",3,"ngModel","ngModelChange"],["for","adminState",1,"col-md-2","col-form-label"],s,["name","deviceSvcAdminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"]]},template:function(e,t){1&e&&(_.TgZ(0,"ul",0),_.YNc(1,e_,22,7,"li",1),_.qZA(),_.YNc(2,g,25,3,"div",2)),2&e&&(_.xp6(1),_.Q6J("ngForOf",t.deviceServiceList),_.xp6(1),_.Q6J("ngIf",t.deviceSvcSelected))},directives:[n.sg,n.O5,n.RF,n.n9,n.ED,a._Y,a.JL,a.F,a.Fj,a.JJ,a.On,a.EJ,a.YN,a.Kr],styles:[""]}),i})(),l=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-device-center"]],decls:1,vars:0,template:function(e,t){1&e&&_._UZ(0,"router-outlet")},directives:[A.lC],styles:[""]}),i})();var r=C(7982);function D(i,E){1&i&&_._UZ(0,"div")}function h(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"li",20),_.NdJ("click",function(){const c=_.CHM(e).$implicit;return _.oxw(2).selectCmd(c)}),_._uU(1),_.qZA()}if(2&i){const e=E.$implicit,t=_.oxw(2);_.ekj("list-group-item-info",(null==t.selectedCmd?null:t.selectedCmd.name)===e.name),_.xp6(1),_.Oqu(e.name)}}function B(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"button",34),_.NdJ("click",function(){return _.CHM(e),_.oxw(3).issueGetCmd()}),_._uU(1,"try"),_.qZA()}}function q(i,E){1&i&&_._UZ(0,"div")}function H(i,E){if(1&i&&(_.TgZ(0,"span",41),_._uU(1),_.qZA()),2&i){const e=_.oxw(4);_.xp6(1),_.hij(" ",e.cmdGetResponse,"")}}function F(i,E){if(1&i&&(_.TgZ(0,"pre",42),_._uU(1),_.qZA()),2&i){const e=_.oxw(4);_.xp6(1),_.Oqu(e.cmdGetResponseRaw)}}function y(i,E){if(1&i&&(_.TgZ(0,"div"),_.TgZ(1,"span",35),_.SDv(2,36),_.qZA(),_.YNc(3,H,2,1,"span",37),_.qZA(),_.TgZ(4,"div",38),_.TgZ(5,"span",35),_.SDv(6,39),_.qZA(),_.YNc(7,F,2,1,"pre",40),_.qZA()),2&i){const e=_.oxw(3);_.xp6(3),_.Q6J("ngIf",e.cmdGetResponse),_.xp6(4),_.Q6J("ngIf",e.cmdGetResponseRaw)}}function Y(i,E){1&i&&(_.TgZ(0,"h6",43),_._UZ(1,"i",44),_.TgZ(2,"span"),_.SDv(3,45),_.qZA(),_.qZA())}function Q(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"button",34),_.NdJ("click",function(){return _.CHM(e),_.oxw(3).issueSetCmd()}),_._uU(1,"try"),_.qZA()}}function W(i,E){1&i&&_._UZ(0,"div")}function w(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div"),_.TgZ(1,"label",56),_._uU(2),_.qZA(),_.TgZ(3,"select",57),_.NdJ("ngModelChange",function(o){_.CHM(e);const c=_.oxw().index;return _.oxw(6).parameterBearerList[c].value=o}),_.TgZ(4,"option",58),_._uU(5,"false"),_.qZA(),_.TgZ(6,"option",58),_._uU(7,"true"),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=_.oxw(),t=e.$implicit,o=e.index,c=_.oxw(6);_.xp6(1),_.s9C("for",t.resourceName),_.xp6(1),_.hij(" ",t.resourceName," "),_.xp6(1),_.s9C("id",t.resourceName),_.s9C("name",t.resourceName),_.Q6J("ngModel",c.parameterBearerList[o].value),_.xp6(1),_.Q6J("ngValue",!1),_.xp6(2),_.Q6J("ngValue",!0)}}function k(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"label",56),_._uU(1),_.qZA(),_.TgZ(2,"input",59),_.NdJ("ngModelChange",function(o){_.CHM(e);const c=_.oxw().index;return _.oxw(6).parameterBearerList[c].value=o}),_.qZA()}if(2&i){const e=_.oxw(),t=e.$implicit,o=e.index,c=_.oxw(6);_.s9C("for",t.resourceName),_.xp6(1),_.Oqu(t.resourceName),_.xp6(1),_.s9C("id",t.resourceName),_.s9C("name",t.resourceName),_.MGl("placeholder","valueType: ",t.valueType,""),_.Q6J("ngModel",c.parameterBearerList[o].value)}}function J(i,E){if(1&i&&(_.TgZ(0,"div",53),_.YNc(1,w,8,7,"div",54),_.YNc(2,k,3,6,"ng-template",null,55,_.W1O),_.qZA()),2&i){const e=E.$implicit,t=_.MAs(3);_.xp6(1),_.Q6J("ngIf","Bool"==e.valueType)("ngIfElse",t)}}function z(i,E){if(1&i&&(_.TgZ(0,"div",51),_.YNc(1,J,4,2,"div",52),_.qZA()),2&i){const e=_.oxw(5);_.xp6(1),_.Q6J("ngForOf",e.selectedCmdSetParams)}}function j(i,E){if(1&i&&(_.TgZ(0,"div",12),_.TgZ(1,"div",4),_.SDv(2,49),_.qZA(),_.TgZ(3,"div",9),_.YNc(4,z,2,1,"div",50),_.qZA(),_.qZA()),2&i){const e=_.oxw(4);_.xp6(4),_.Q6J("ngIf",e.selectedCmd)}}function v(i,E){if(1&i&&(_.TgZ(0,"span",41),_._uU(1),_.qZA()),2&i){const e=_.oxw(4);_.xp6(1),_.Oqu(e.cmdSetResponse)}}function M_(i,E){if(1&i&&(_.TgZ(0,"pre",42),_._uU(1),_.qZA()),2&i){const e=_.oxw(4);_.xp6(1),_.Oqu(e.cmdSetResponseRaw)}}function f_(i,E){if(1&i&&(_.YNc(0,j,5,1,"div",46),_.TgZ(1,"div"),_.TgZ(2,"div"),_.TgZ(3,"span",35),_.SDv(4,47),_.qZA(),_.YNc(5,v,2,1,"span",37),_.qZA(),_.TgZ(6,"div",38),_.TgZ(7,"span",35),_.SDv(8,48),_.qZA(),_.YNc(9,M_,2,1,"pre",40),_.qZA(),_.qZA()),2&i){const e=_.oxw(3);_.Q6J("ngIf",e.selectedCmdSetParams),_.xp6(5),_.Q6J("ngIf",e.cmdSetResponse),_.xp6(4),_.Q6J("ngIf",e.cmdSetResponseRaw)}}function m_(i,E){1&i&&(_.TgZ(0,"h6",43),_._UZ(1,"i",44),_.TgZ(2,"span"),_.SDv(3,60),_.qZA(),_.qZA())}function v_(i,E){if(1&i&&(_.TgZ(0,"div",21),_.TgZ(1,"div",4),_.TgZ(2,"span",22),_._UZ(3,"i",23),_._uU(4),_.qZA(),_.TgZ(5,"span"),_.SDv(6,24),_.qZA(),_.qZA(),_.TgZ(7,"div",25),_.TgZ(8,"div",10),_.TgZ(9,"div",26),_.TgZ(10,"div",12),_.TgZ(11,"div",4),_._uU(12," Get "),_.YNc(13,B,2,0,"button",27),_.qZA(),_.TgZ(14,"div",28),_.YNc(15,q,1,0,"div",0),_.YNc(16,y,8,2,"ng-template",null,29,_.W1O),_.YNc(18,Y,4,0,"ng-template",null,30,_.W1O),_.qZA(),_.qZA(),_.qZA(),_.TgZ(20,"div",31),_.TgZ(21,"div",21),_.TgZ(22,"div",4),_._uU(23," Set "),_.YNc(24,Q,2,0,"button",27),_.qZA(),_.TgZ(25,"div",9),_.YNc(26,W,1,0,"div",0),_.YNc(27,f_,10,3,"ng-template",null,32,_.W1O),_.YNc(29,m_,4,0,"ng-template",null,33,_.W1O),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&i){const e=_.MAs(17),t=_.MAs(19),o=_.MAs(28),c=_.MAs(30),s=_.oxw(2);_.xp6(4),_.hij(" ",s.selectedCmd.name," method:"),_.xp6(9),_.Q6J("ngIf",s.selectedCmd.get),_.xp6(2),_.Q6J("ngIf",s.selectedCmd.get)("ngIfThen",e)("ngIfElse",t),_.xp6(9),_.Q6J("ngIf",s.selectedCmd.set),_.xp6(2),_.Q6J("ngIf",s.selectedCmd.set)("ngIfThen",o)("ngIfElse",c)}}function R_(i,E){if(1&i&&(_.TgZ(0,"div",3),_.TgZ(1,"div",4),_.TgZ(2,"span",5),_._UZ(3,"i",6),_.qZA(),_.TgZ(4,"span",7),_._uU(5),_.qZA(),_.TgZ(6,"span"),_.SDv(7,8),_.qZA(),_.qZA(),_.TgZ(8,"div",9),_.TgZ(9,"div",10),_.TgZ(10,"div",11),_.TgZ(11,"div",12),_.TgZ(12,"div",13),_.SDv(13,14),_.qZA(),_.TgZ(14,"div",15),_.TgZ(15,"ul",16),_.YNc(16,h,2,3,"li",17),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(17,"div",18),_.YNc(18,v_,31,9,"div",19),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&i){const e=_.oxw();_.xp6(5),_.Oqu(e.associatedCmdDeviceName),_.xp6(11),_.Q6J("ngForOf",e.deviceCoreCommand),_.xp6(2),_.Q6J("ngIf",e.selectedCmd)}}function G_(i,E){if(1&i&&(_.TgZ(0,"div",3),_.TgZ(1,"div",4),_.TgZ(2,"span",5),_._UZ(3,"i",6),_.qZA(),_.TgZ(4,"span",7),_._uU(5),_.qZA(),_.TgZ(6,"span"),_.SDv(7,61),_.qZA(),_.qZA(),_.TgZ(8,"div",62),_.TgZ(9,"h5",43),_._UZ(10,"i",63),_.TgZ(11,"span"),_.SDv(12,64),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&i){const e=_.oxw();_.xp6(5),_.Oqu(e.associatedCmdDeviceName)}}let U_=(()=>{class i{constructor(e,t){this.cmdSvc=e,this.metadataSvc=t,this.selectedCmd={},this.selectedCmdSetParams=[],this.parameterBearerList=[]}ngOnInit(){}ngOnChanges(){!this.deviceName||(this.resetResponse(),this.cmdSvc.findDeviceAssociatedCommnadsByDeviceName(this.deviceName).subscribe(e=>{this.associatedCmdDeviceName=e.deviceCoreCommand.deviceName,this.deviceCoreCommand=e.deviceCoreCommand.coreCommands,this.deviceCoreCommand&&0!==this.deviceCoreCommand.length&&(this.selectedCmd=this.deviceCoreCommand[0],this.selectedCmdSetParams=this.selectedCmd.parameters,this.setParameterBearerList(),this.getAssociatedDeviceProfile(e.deviceCoreCommand.profileName))}))}getAssociatedDeviceProfile(e){this.metadataSvc.findProfileByName(e).subscribe(t=>this.associateDeviceProfile=t.profile)}selectCmd(e){this.selectedCmd=e,this.selectedCmdSetParams=this.selectedCmd.parameters,this.resetResponse(),this.setParameterBearerList()}setParameterBearerList(){this.parameterBearerList=[],this.selectedCmdSetParams.forEach(e=>{this.parameterBearerList.push({key:e.resourceName,value:""})})}resetResponse(){this.cmdGetResponse="",this.cmdGetResponseRaw="",this.cmdSetResponse="",this.cmdSetResponseRaw="",this.cmdBinaryResponse=!0,this.cmdBinaryResponseURL=""}isBinaryResource(){let e=!1;return this.associateDeviceProfile.deviceResources.forEach(t=>{t.name!==this.selectedCmd.name||"Binary"!==t.properties.valueType||(e=!0)}),e||(this.associateDeviceProfile.deviceCommands.forEach(t=>{t.name===this.selectedCmd.name&&t.resourceOperations.forEach(o=>{this.associateDeviceProfile.deviceResources.forEach(c=>{o.deviceResource!==c.name||"Binary"!==c.properties.valueType||(e=!0)})})}),e)}issueGetCmd(){this.cmdSvc.issueGetCmd(this.associatedCmdDeviceName,this.selectedCmd.name).subscribe(e=>{if(this.cmdGetResponseRaw=JSON.stringify(e.event.readings,null,3),this.isBinaryResource())return void(this.cmdGetResponse="Binary resource is not supported for preview");let t=[];e.event.readings.forEach(o=>{t.push(o.value)}),this.cmdGetResponse=t.join(",")})}issueGetCmdOfBinaryResource(){this.cmdSvc.issueGetBinaryCmd(this.associatedCmdDeviceName,this.selectedCmd.name).subscribe(e=>{let t=CBOR.decode(e);"image/jpeg"===t.mediaType||"image/jpg"===t.mediaType||"image/png"===t.mediaType?(this.cmdBinaryResponse=t.binaryValue,this.cmdBinaryResponseURL=URL.createObjectURL(this.cmdBinaryResponse)):this.cmdBinaryResponse="only image binary is supported"})}issueSetCmd(){var e;let t={};this.parameterBearerList.forEach(o=>{t[o.key]=o.value}),this.cmdSvc.issueSetCmd(this.associatedCmdDeviceName,null===(e=this.selectedCmd)||void 0===e?void 0:e.name,t).subscribe(o=>{this.cmdSetResponseRaw=JSON.stringify(o,null,3),this.cmdSetResponse=o.message})}}return i.\u0275fac=function(e){return new(e||i)(_.Y36(r.V),_.Y36(p.D))},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-device-command-viewer"]],inputs:{deviceName:"deviceName"},features:[_.TTD],decls:5,vars:3,consts:function(){let E,e,t,o,c,s,T,f,S,O,N,u;return E="\u76F8\u5173\u547D\u4EE4",e=" \u547D\u4EE4\u5217\u8868 ",t="Get \u548C Set",o="\u54CD\u5E94\uFF1A",c="\u539F\u59CB\u54CD\u5E94\uFF1A",s="\u6CA1\u6709Get\u65B9\u6CD5",T="\u54CD\u5E94\uFF1A",f="\u539F\u59CB\u54CD\u5E94\uFF1A",S="\u53C2\u6570\u8BBE\u7F6E",O="\u6CA1\u6709Set\u65B9\u6CD5",N="\u76F8\u5173\u547D\u4EE4",u="\u6CA1\u6709\u76F8\u5173\u547D\u4EE4",[[4,"ngIf","ngIfThen","ngIfElse"],["hasAssociatedCommand",""],["noAssociatedCommand",""],[1,"card","mt-3"],[1,"card-header"],[1,"badge","badge-danger","text-light"],[1,"fa","fa-terminal","font-weight-bolder"],[1,"text-primary","mx-2","font-weight-bold"],E,[1,"card-body"],[1,"row"],[1,"col-md-2","col-lg-2"],[1,"card","mb-2"],[1,"card-header","font-weight-bold"],e,[1,"card-body","p-0"],[1,"list-group","list-group-flush"],["role","button","class","list-group-item list-group-item-action",3,"list-group-item-info","click",4,"ngFor","ngForOf"],[1,"col-md-10","col-lg-10"],["class","card",4,"ngIf"],["role","button",1,"list-group-item","list-group-item-action",3,"click"],[1,"card"],[1,"text-primary","font-weight-bold","mr-2"],[1,"fa","fa-thumb-tack","text-danger","mr-1"],t,[1,"card-body","px-2"],[1,"col-md-5","col-lg-5"],["class","btn btn-primary btn-sm float-right",3,"click",4,"ngIf"],[1,"card-body","overflow-auto"],["hasGetMethod",""],["noGetMethod",""],[1,"col-md-7","col-lg-7"],["hasSetMethod",""],["noSetMethod",""],[1,"btn","btn-primary","btn-sm","float-right",3,"click"],[1,"badge","badge-info"],o,["class","ml-2 text-primary",4,"ngIf"],[1,"mt-3"],c,["class","mt-2 bg-secondary p-2 text-light rounded",4,"ngIf"],[1,"ml-2","text-primary"],[1,"mt-2","bg-secondary","p-2","text-light","rounded"],[1,"text-warning"],[1,"fa","fa-warning","mr-1"],s,["class","card mb-2",4,"ngIf"],T,f,S,["class","d-flex flex-column bd-highlight",4,"ngIf"],[1,"d-flex","flex-column","bd-highlight"],["class","form p-2 bd-highlight",4,"ngFor","ngForOf"],[1,"form","p-2","bd-highlight"],[4,"ngIf","ngIfElse"],["valueTypeIsNotBool",""],[3,"for"],[1,"custom-select","custom-select-sm",3,"id","name","ngModel","ngModelChange"],[3,"ngValue"],[1,"form-control","form-control-sm",3,"id","name","ngModel","placeholder","ngModelChange"],O,N,[1,"card-body","text-center"],[1,"fa","fa-warning"],u]},template:function(e,t){if(1&e&&(_.YNc(0,D,1,0,"div",0),_.YNc(1,R_,19,3,"ng-template",null,1,_.W1O),_.YNc(3,G_,13,1,"ng-template",null,2,_.W1O)),2&e){const o=_.MAs(2),c=_.MAs(4);_.Q6J("ngIf",t.deviceCoreCommand)("ngIfThen",o)("ngIfElse",c)}},directives:[n.O5,n.sg,a.EJ,a.JJ,a.On,a.YN,a.Kr,a.Fj],styles:[""]}),i})();function N_(i,E){if(1&i&&(_.TgZ(0,"span"),_.TgZ(1,"span",67),_.SDv(2,68),_.qZA(),_.TgZ(3,"span",69),_._uU(4),_.qZA(),_.TgZ(5,"span"),_.SDv(6,70),_.qZA(),_.qZA()),2&i){const e=_.oxw();_.xp6(4),_.Oqu(e.associatedSvcName)}}function P_(i,E){if(1&i&&(_.TgZ(0,"span"),_.TgZ(1,"span",67),_.SDv(2,71),_.qZA(),_.TgZ(3,"span",69),_._uU(4),_.qZA(),_.TgZ(5,"span"),_.SDv(6,72),_.qZA(),_.qZA()),2&i){const e=_.oxw();_.xp6(4),_.Oqu(e.associatedProfileName)}}function h_(i,E){1&i&&(_.TgZ(0,"span"),_.SDv(1,73),_.qZA())}function Z_(i,E){if(1&i&&(_.TgZ(0,"span",85),_._uU(1),_.qZA()),2&i){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.adminState)}}function V_(i,E){if(1&i&&(_.TgZ(0,"span",86),_._uU(1),_.qZA()),2&i){const e=_.oxw().$implicit;_.xp6(1),_.Oqu(e.adminState)}}function L_(i,E){if(1&i&&(_.TgZ(0,"span",85),_._uU(1),_.qZA()),2&i){const e=_.oxw().$implicit;_.xp6(1),_.hij(" ",e.operatingState,"")}}function b_(i,E){if(1&i&&(_.TgZ(0,"span",86),_._uU(1),_.qZA()),2&i){const e=_.oxw().$implicit;_.xp6(1),_.hij(" ",e.operatingState,"")}}function X_(i,E){if(1&i&&(_.TgZ(0,"span",86),_._uU(1),_.qZA()),2&i){const e=_.oxw().$implicit;_.xp6(1),_.hij(" ",e.operatingState,"")}}const $_=function(i){return{profileName:i}};function B_(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"tr"),_.TgZ(1,"td"),_.TgZ(2,"input",23),_.NdJ("click",function(o){const s=_.CHM(e).$implicit;return _.oxw().selectOne(o,s)}),_.qZA(),_.qZA(),_.TgZ(3,"td",74),_._uU(4),_.qZA(),_.TgZ(5,"td",74),_._uU(6),_.qZA(),_.TgZ(7,"td"),_._uU(8),_.qZA(),_.TgZ(9,"td"),_._uU(10),_.qZA(),_.TgZ(11,"td"),_.TgZ(12,"span",75),_.YNc(13,Z_,2,1,"span",76),_.YNc(14,V_,2,1,"span",77),_.qZA(),_.qZA(),_.TgZ(15,"td",78),_.TgZ(16,"span",75),_.YNc(17,L_,2,1,"span",76),_.YNc(18,b_,2,1,"span",79),_.YNc(19,X_,2,1,"span",77),_.qZA(),_.qZA(),_.TgZ(20,"td",78),_.TgZ(21,"span",80),_.NdJ("click",function(){const c=_.CHM(e).$implicit,s=_.oxw();return s.setSpecialFeatureViewer(c,s.FEATURE_COMMAND)}),_._UZ(22,"i",81),_.qZA(),_.qZA(),_.TgZ(23,"td",78),_.TgZ(24,"span",80),_.NdJ("click",function(){const c=_.CHM(e).$implicit,s=_.oxw();return s.setSpecialFeatureViewer(c,s.FEATURE_AUTOEVENT)}),_._UZ(25,"i",82),_.qZA(),_.qZA(),_.TgZ(26,"td"),_.TgZ(27,"a",83),_._uU(28),_.qZA(),_.qZA(),_.TgZ(29,"td"),_.TgZ(30,"a",84),_._uU(31),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=E.$implicit,t=_.oxw();_.ekj("table-active",t.isChecked(e.id)||t.specialFeatureAssociatedDeviceName===e.name),_.xp6(2),_.Q6J("checked",t.isChecked(e.id)),_.xp6(2),_.Oqu(e.id),_.xp6(2),_.Oqu(e.name),_.xp6(2),_.Oqu(e.description),_.xp6(2),_.Oqu(e.labels),_.xp6(2),_.Q6J("ngSwitch",e.adminState),_.xp6(1),_.Q6J("ngSwitchCase","UNLOCKED"),_.xp6(3),_.Q6J("ngSwitch",e.operatingState),_.xp6(1),_.Q6J("ngSwitchCase","UP"),_.xp6(1),_.Q6J("ngSwitchCase","DOWN"),_.xp6(3),_.ekj("badge-danger",t.specialFeatureName===t.FEATURE_COMMAND&&t.specialFeatureAssociatedDeviceName===e.name),_.xp6(3),_.ekj("badge-danger",t.specialFeatureName===t.FEATURE_AUTOEVENT&&t.specialFeatureAssociatedDeviceName===e.name),_.xp6(3),_.Q6J("queryParams",_.VKq(19,$_,e.profileName)),_.xp6(1),_.Oqu(e.profileName),_.xp6(3),_.Oqu(e.serviceName)}}function x_(i,E){if(1&i&&(_.TgZ(0,"tr"),_.TgZ(1,"td"),_._uU(2),_.qZA(),_.TgZ(3,"td"),_.TgZ(4,"span",99),_._uU(5),_.qZA(),_.qZA(),_.TgZ(6,"td"),_.TgZ(7,"span",100),_._uU(8),_.qZA(),_.qZA(),_.qZA()),2&i){const e=E.$implicit;_.xp6(2),_.Oqu(e.sourceName),_.xp6(3),_.Oqu(e.interval),_.xp6(3),_.Oqu(e.onChange)}}function q_(i,E){if(1&i&&(_.TgZ(0,"div"),_.TgZ(1,"div",89),_.TgZ(2,"div",90),_.TgZ(3,"span",91),_._UZ(4,"i",82),_.qZA(),_.TgZ(5,"span",92),_._uU(6),_.qZA(),_.TgZ(7,"span"),_.SDv(8,93),_.qZA(),_.qZA(),_.TgZ(9,"div",94),_.TgZ(10,"div",19),_.TgZ(11,"table",20),_.TgZ(12,"thead",21),_.TgZ(13,"th",22),_.SDv(14,95),_.qZA(),_.TgZ(15,"th",22),_.SDv(16,96),_.qZA(),_.TgZ(17,"th",22),_.SDv(18,97),_.qZA(),_.qZA(),_.TgZ(19,"tbody"),_.YNc(20,x_,9,3,"tr",98),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&i){const e=_.oxw(2);_.xp6(6),_.hij(" ",e.specialFeatureAssociatedDeviceName,""),_.xp6(14),_.Q6J("ngForOf",e.autoEvents)}}function H_(i,E){if(1&i&&(_.TgZ(0,"div",89),_.TgZ(1,"div",90),_.TgZ(2,"span",91),_._UZ(3,"i",82),_.qZA(),_.TgZ(4,"span",92),_._uU(5),_.qZA(),_.TgZ(6,"span"),_.SDv(7,101),_.qZA(),_.qZA(),_.TgZ(8,"div",102),_.TgZ(9,"h5",103),_._UZ(10,"i",58),_.TgZ(11,"span"),_.SDv(12,104),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&i){const e=_.oxw(2);_.xp6(5),_.hij(" ",e.specialFeatureAssociatedDeviceName,"")}}function F_(i,E){if(1&i&&(_.TgZ(0,"div"),_.YNc(1,q_,21,2,"div",87),_.YNc(2,H_,13,1,"ng-template",null,88,_.W1O),_.qZA()),2&i){const e=_.MAs(3),t=_.oxw();_.xp6(1),_.Q6J("ngIf",t.autoEvents)("ngIfElse",e)}}function y_(i,E){if(1&i&&(_.TgZ(0,"div"),_._UZ(1,"app-device-command-viewer",105),_.qZA()),2&i){const e=_.oxw();_.xp6(1),_.Q6J("deviceName",e.specialFeatureAssociatedDeviceName)}}let Y_=(()=>{class i{constructor(e,t,o,c){this.metaSvc=e,this.msgSvc=t,this.route=o,this.router=c,this.toolbars=!0,this.enableSelectAll=!0,this.deviceList=[],this.associatedSvcName="",this.associatedProfileName="",this.selectedDevice=[],this.FEATURE_AUTOEVENT="autoevent",this.FEATURE_COMMAND="command",this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.route.queryParams.subscribe(e=>e.svcName?(this.associatedSvcName=e.svcName,void this.getDeviceListByAssociatedSvc(this.associatedSvcName)):e.profileName?(this.associatedProfileName=e.profileName,void this.getDeviceListByAssociatedProfile(this.associatedProfileName)):(this.associatedSvcName="",this.associatedProfileName="",void this.getDeviceListPagination()))}renderPopoverComponent(){setTimeout(()=>{$('[data-toggle="popover"]').popover({trigger:"hover"})},250)}getDeviceList(){""===this.associatedSvcName?""===this.associatedProfileName?this.getDeviceListPagination():this.getDeviceListByAssociatedProfile(this.associatedSvcName):this.getDeviceListByAssociatedSvc(this.associatedSvcName)}getDeviceListByAssociatedSvc(e){this.metaSvc.findDevicesByServiceName(this.pageOffset,this.pageLimit,e).subscribe(t=>this.deviceList=t.devices)}getDeviceListByAssociatedProfile(e){this.metaSvc.findDevicesByProfileName(this.pageOffset,this.pageLimit,e).subscribe(t=>this.deviceList=t.devices)}getDeviceListPagination(){this.metaSvc.allDevicesPagination(this.pageOffset,this.pageLimit).subscribe(e=>{this.deviceList=e.devices})}refresh(){this.associatedProfileName="",this.associatedSvcName="",this.metaSvc.allDevicesPagination(0,this.pageLimit).subscribe(e=>{this.deviceList=e.devices,this.msgSvc.success("refresh"),this.resetPagination()})}edit(){this.router.navigate(["../edit-device"],{relativeTo:this.route,queryParams:{deviceName:this.selectedDevice[0].name}})}deleteConfirm(){$("#deleteConfirmDialog").modal("show")}delete(){this.selectedDevice.forEach((e,t)=>{this.metaSvc.deleteOneDeviceByName(e.name).subscribe(()=>{this.selectedDevice.splice(t,1),this.deviceList.forEach((o,c)=>{if(o.id===e.id)return this.deviceList.splice(c,1),void this.msgSvc.success("remove device ",` Name: ${o.name}`)})})}),this.specialFeatureName=void 0,$("#deleteConfirmDialog").modal("hide")}setSpecialFeatureViewer(e,t){switch(this.specialFeatureAssociatedDeviceName=e.name,this.specialFeatureName=t,this.specialFeatureName){case this.FEATURE_AUTOEVENT:this.autoEvents=e.autoEvents}}isCheckedAll(){let e=!0;return this.deviceList&&0===this.deviceList.length&&(e=!1),this.deviceList.forEach(t=>{-1===this.selectedDevice.findIndex(o=>o.name===t.name)&&(e=!1)}),e}selectAll(e){this.deviceList.forEach(e.target.checked?o=>{-1===this.selectedDevice.findIndex(c=>c.name===o.name)&&this.selectedDevice.push(o)}:o=>{this.selectedDevice.forEach((c,s)=>{c.name===o.name&&this.selectedDevice.splice(s,1)})})}isChecked(e){return this.selectedDevice.findIndex(t=>t.id===e)>=0}selectOne(e,t){e.target.checked?this.selectedDevice.push(t):this.selectedDevice.forEach((c,s)=>{c.name===t.name&&this.selectedDevice.splice(s,1)})}onPageSelected(){this.resetPagination(),this.getDeviceList()}prePage(){this.setPagination(-1),this.getDeviceList()}nextPage(){this.setPagination(1),this.getDeviceList()}setPagination(e){1===e?this.pagination+=1:-1===e&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit}resetPagination(){this.pagination=1,this.pageOffset=(this.pagination-1)*this.pageLimit}}return i.\u0275fac=function(e){return new(e||i)(_.Y36(p.D),_.Y36(V.e),_.Y36(A.gz),_.Y36(A.F0))},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-device-list"]],inputs:{toolbars:"toolbars",enableSelectAll:"enableSelectAll"},decls:98,vars:12,consts:function(){let E,e,t,o,c,s,T,f,S,O,N,u,m,L,R,G,c_,s_,a_,l_,r_,d_,C_,T_,A_,D_,S_,I_,g_,O_,p_,u_;return E="\u5237\u65B0",e="\u6DFB\u52A0",t="\u7F16\u8F91",o="\u5220\u9664",c="ID",s="\u540D\u5B57",T="\u63CF\u8FF0",f="\u6807\u7B7E",S="\u7BA1\u7406\u72B6\u6001",O="\u64CD\u4F5C\u72B6\u6001",N="\u547D\u4EE4",u="\u81EA\u52A8\u91C7\u96C6",m="\u76F8\u5173\u8BBE\u5907\u5143\u4FE1\u606F",L="\u76F8\u5173\u8BBE\u5907\u670D\u52A1",R="\u6BCF\u9875\u6761\u76EE",G="\u4E0A\u4E00\u9875",c_="\u4E0B\u4E00\u9875",s_="\u8B66\u544A",a_="\u6570\u636E\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\uFF01\uFF01\uFF01\u786E\u5B9A\u8981\u6267\u884C\u5220\u9664\u64CD\u4F5C\u5417\uFF1F",l_="\u53D6\u6D88",r_="\u786E\u8BA4",d_="\u8BBE\u5907\u670D\u52A1",C_="\u76F8\u5173\u8BBE\u5907\u5217\u8868",T_="\u8BBE\u5907\u5143\u4FE1\u606F",A_="\u76F8\u5173\u8BBE\u5907\u5217\u8868",D_="\u8BBE\u5907\u5217\u8868",S_="\u76F8\u5173\u81EA\u52A8\u91C7\u96C6",I_="\u8D44\u6E90",g_="\u5355\u4F4D\u95F4\u9694",O_="Onchange",p_="\u76F8\u5173\u81EA\u52A8\u91C7\u96C6",u_="\u65E0\u76F8\u5173\u81EA\u52A8\u91C7\u96C6",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-list","text-danger","mr-2"],[4,"ngIf"],[1,"card-body","p-0","position-relative"],[1,"bg-light","px-2","py-2"],["role","group",1,"btn-group","btn-group-sm"],["data-testid","device-list-refresh-btn",1,"btn","btn-primary",3,"click"],[1,"fa","fa-refresh","mr-1"],E,["type","button","routerLink","../add-device",1,"btn","btn-info"],[1,"fa","fa-plus","mr-1"],e,["type","button",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-edit","mr-1"],t,["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash","mr-1"],o,[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],["type","checkbox","role","button",3,"checked","click"],c,s,T,f,S,O,N,u,m,L,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],R,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],G,[1,"page-item"],c_,[1,"fa","fa-angle-double-right","ml-1"],["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],s_,[1,"modal-body"],a_,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],l_,["type","button",1,"btn","btn-danger",3,"click"],r_,[1,"mr-1"],d_,[1,"text-danger","mr-1"],C_,T_,A_,D_,[1,"user-select-all"],[3,"ngSwitch"],["class","badge badge-success",4,"ngSwitchCase"],["class","badge badge-danger",4,"ngSwitchDefault"],[1,"text-center"],["class","badge badge-danger",4,"ngSwitchCase"],["role","button",1,"badge","badge-primary","text-light",3,"click"],[1,"fa","fa-terminal","font-weight-bolder"],[1,"fa","fa-calendar-check-o","font-weight-bolder"],["routerLink","../../device-profile-center",3,"queryParams"],["routerLink","../../device-service-list"],[1,"badge","badge-success"],[1,"badge","badge-danger"],[4,"ngIf","ngIfElse"],["noAutoEvents",""],[1,"card","mt-3"],[1,"card-header"],[1,"badge","badge-danger","text-light"],[1,"text-primary","mx-2","font-weight-bold"],S_,[1,"card-body","p-0"],I_,g_,O_,[4,"ngFor","ngForOf"],[1,"badge","badge-secondary","badge-pill"],[1,""],p_,[1,"card-body","text-center"],[1,"text-warning"],u_,[3,"deviceName"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._UZ(2,"i",2),_.YNc(3,N_,7,1,"span",3),_.YNc(4,P_,7,1,"span",3),_.YNc(5,h_,2,0,"span",3),_.qZA(),_.TgZ(6,"div",4),_.TgZ(7,"div",5),_.TgZ(8,"div",6),_.TgZ(9,"button",7),_.NdJ("click",function(){return t.refresh()}),_.TgZ(10,"span"),_._UZ(11,"i",8),_.TgZ(12,"span"),_.SDv(13,9),_.qZA(),_.qZA(),_.qZA(),_.TgZ(14,"button",10),_.TgZ(15,"span"),_._UZ(16,"i",11),_.TgZ(17,"span"),_.SDv(18,12),_.qZA(),_.qZA(),_.qZA(),_.TgZ(19,"button",13),_.NdJ("click",function(){return t.edit()}),_.TgZ(20,"span"),_._UZ(21,"i",14),_.TgZ(22,"span"),_.SDv(23,15),_.qZA(),_.qZA(),_.qZA(),_.TgZ(24,"button",16),_.NdJ("click",function(){return t.deleteConfirm()}),_.TgZ(25,"span"),_._UZ(26,"i",17),_.TgZ(27,"span"),_.SDv(28,18),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(29,"div",19),_.TgZ(30,"table",20),_.TgZ(31,"thead",21),_.TgZ(32,"tr"),_.TgZ(33,"th",22),_.TgZ(34,"input",23),_.NdJ("click",function(c){return t.selectAll(c)}),_.qZA(),_.qZA(),_.TgZ(35,"th",22),_.SDv(36,24),_.qZA(),_.TgZ(37,"th",22),_.SDv(38,25),_.qZA(),_.TgZ(39,"th",22),_.SDv(40,26),_.qZA(),_.TgZ(41,"th",22),_.SDv(42,27),_.qZA(),_.TgZ(43,"th",22),_.SDv(44,28),_.qZA(),_.TgZ(45,"th",22),_.SDv(46,29),_.qZA(),_.TgZ(47,"th",22),_.SDv(48,30),_.qZA(),_.TgZ(49,"th",22),_.SDv(50,31),_.qZA(),_.TgZ(51,"th",22),_.SDv(52,32),_.qZA(),_.TgZ(53,"th",22),_.SDv(54,33),_.qZA(),_.qZA(),_.qZA(),_.TgZ(55,"tbody"),_.YNc(56,B_,32,21,"tr",34),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(57,"div",35),_.TgZ(58,"nav",36),_.TgZ(59,"ul",37),_.TgZ(60,"li",38),_.TgZ(61,"span",39),_.SDv(62,40),_.qZA(),_.qZA(),_.TgZ(63,"li",41),_.TgZ(64,"select",42),_.NdJ("ngModelChange",function(c){return t.pageLimit=c})("ngModelChange",function(){return t.onPageSelected()}),_.TgZ(65,"option",43),_._uU(66,"5"),_.qZA(),_.TgZ(67,"option",44),_._uU(68,"10"),_.qZA(),_.TgZ(69,"option",45),_._uU(70,"20"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(71,"li",46),_.TgZ(72,"button",47),_.NdJ("click",function(){return t.prePage()}),_._UZ(73,"i",48),_.TgZ(74,"span"),_.SDv(75,49),_.qZA(),_.qZA(),_.qZA(),_.TgZ(76,"li",50),_.TgZ(77,"button",47),_.NdJ("click",function(){return t.nextPage()}),_.TgZ(78,"span"),_.SDv(79,51),_.qZA(),_._UZ(80,"i",52),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.YNc(81,F_,4,2,"div",3),_.YNc(82,y_,2,1,"div",3),_.TgZ(83,"div",53),_.TgZ(84,"div",54),_.TgZ(85,"div",55),_.TgZ(86,"div",56),_.TgZ(87,"h5",57),_._UZ(88,"i",58),_.TgZ(89,"span"),_.SDv(90,59),_.qZA(),_.qZA(),_.qZA(),_.TgZ(91,"div",60),_.SDv(92,61),_.qZA(),_.TgZ(93,"div",62),_.TgZ(94,"button",63),_.SDv(95,64),_.qZA(),_.TgZ(96,"button",65),_.NdJ("click",function(){return t.delete()}),_.SDv(97,66),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&e&&(_.xp6(3),_.Q6J("ngIf",""!==t.associatedSvcName),_.xp6(1),_.Q6J("ngIf",""!==t.associatedProfileName),_.xp6(1),_.Q6J("ngIf",""===t.associatedProfileName&&""===t.associatedSvcName),_.xp6(14),_.Q6J("disabled",1!==t.selectedDevice.length),_.xp6(5),_.Q6J("disabled",0===t.selectedDevice.length),_.xp6(10),_.Q6J("checked",t.isCheckedAll()),_.xp6(22),_.Q6J("ngForOf",t.deviceList),_.xp6(8),_.Q6J("ngModel",t.pageLimit),_.xp6(8),_.Q6J("disabled",1===t.pagination),_.xp6(5),_.Q6J("disabled",t.pageLimit>t.deviceList.length),_.xp6(4),_.Q6J("ngIf",t.specialFeatureName===t.FEATURE_AUTOEVENT),_.xp6(1),_.Q6J("ngIf",t.specialFeatureName===t.FEATURE_COMMAND))},directives:[n.O5,A.rH,n.sg,a.EJ,a.JJ,a.On,a.YN,a.Kr,n.RF,n.n9,n.ED,A.yS,U_],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),i})();class Q_{constructor(){this.Schema="",this.Host="",this.Port="",this.User="",this.Password="",this.ClientId="",this.CommandTopic=""}}class W_{constructor(){this.Address="",this.Port="",this.UnitID="",this.Timeout="",this.IdleTimeout=""}}class w_{constructor(){this.Address="",this.UnitID="",this.BaudRate="",this.DataBits="",this.StopBits="",this.Parity="",this.Timeout="",this.IdleTimeout=""}}class k_{constructor(){this.Address="",this.Port=""}}class J_{constructor(){this.Address="",this.Port="",this.MACAddress=""}}class z_{constructor(){this.host="",this.port=""}}function j_(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div",10),_.TgZ(1,"span",11),_.NdJ("click",function(){_.CHM(e);const o=_.oxw(2);return o.changeProtocolTemplateMode(o.TEMPLATE_BUILT_IN)}),_._UZ(2,"i",12),_.TgZ(3,"span"),_.SDv(4,13),_.qZA(),_.qZA(),_.TgZ(5,"span",14),_.NdJ("click",function(){_.CHM(e);const o=_.oxw(2);return o.changeProtocolTemplateMode(o.TEMPLATE_CUSTOM)}),_._UZ(6,"i",12),_.TgZ(7,"span"),_.SDv(8,15),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=_.oxw(2);_.xp6(1),_.ekj("badge-primary",e.protocolTemplateMode===e.TEMPLATE_BUILT_IN)("badge-secondary",e.protocolTemplateMode!==e.TEMPLATE_BUILT_IN),_.xp6(1),_.ekj("fa-check-square",e.protocolTemplateMode===e.TEMPLATE_BUILT_IN),_.xp6(3),_.ekj("badge-primary",e.protocolTemplateMode===e.TEMPLATE_CUSTOM)("badge-secondary",e.protocolTemplateMode!==e.TEMPLATE_CUSTOM),_.xp6(1),_.ekj("fa-check-square",e.protocolTemplateMode===e.TEMPLATE_CUSTOM)}}function K_(i,E){1&i&&_._UZ(0,"div")}function _e(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div"),_.TgZ(1,"form",34),_.TgZ(2,"div",35),_.TgZ(3,"div",36),_.TgZ(4,"span",37),_.SDv(5,38),_.qZA(),_.qZA(),_._UZ(6,"input",39),_.qZA(),_.TgZ(7,"div",40),_._UZ(8,"i",41),_.qZA(),_.TgZ(9,"div",35),_.TgZ(10,"div",36),_.TgZ(11,"span",37),_.SDv(12,42),_.qZA(),_.qZA(),_.TgZ(13,"input",43),_.NdJ("ngModelChange",function(o){const s=_.CHM(e).$implicit;return _.oxw(4).builtinProtocolTemplateSelected[s]=o}),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=E.$implicit,t=_.oxw(4);_.xp6(6),_.Q6J("value",e),_.xp6(7),_.Q6J("ngModel",t.builtinProtocolTemplateSelected[e])}}function ee(i,E){if(1&i&&(_.TgZ(0,"div"),_.YNc(1,_e,14,2,"div",33),_.qZA()),2&i){const e=_.oxw(3);_.xp6(1),_.Q6J("ngForOf",e.builtinProtocolTemplateProperties)}}function te(i,E){1&i&&(_.TgZ(0,"h5",48),_._UZ(1,"i",49),_.TgZ(2,"span"),_.SDv(3,50),_.qZA(),_.qZA())}function ie(i,E){if(1&i&&(_.TgZ(0,"div"),_._UZ(1,"span",44),_.TgZ(2,"span",45),_.SDv(3,46),_.qZA(),_.qZA(),_.YNc(4,te,4,0,"h5",47)),2&i){const e=_.oxw(3);_.xp6(4),_.Q6J("ngIf",0===e.builtinProtocolTemplateProperties.length&&e.builtinProtocolName)}}function ne(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div",16),_.TgZ(1,"div",17),_.TgZ(2,"form"),_.TgZ(3,"div",18),_.TgZ(4,"label"),_.SDv(5,19),_.qZA(),_.TgZ(6,"select",20),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw(2).builtinProtocolName=o})("ngModelChange",function(){return _.CHM(e),_.oxw(2).onSelectBuiltinProtocolTemplate()}),_.TgZ(7,"option",21),_._uU(8,"device-mqtt"),_.qZA(),_.TgZ(9,"option",22),_._uU(10,"device-rest"),_.qZA(),_.TgZ(11,"option",23),_._uU(12,"device-virtual"),_.qZA(),_.TgZ(13,"option",24),_._uU(14,"device-modbus-tcp"),_.qZA(),_.TgZ(15,"option",25),_._uU(16,"device-modbus-rtu"),_.qZA(),_.TgZ(17,"option",26),_._uU(18,"device-onvif-camera"),_.qZA(),_.TgZ(19,"option",27),_._uU(20,"device-rfid-llrp"),_.qZA(),_.qZA(),_.TgZ(21,"div",28),_.TgZ(22,"small"),_.SDv(23,29),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(24,"div",30),_.YNc(25,ee,2,1,"div",31),_.YNc(26,ie,5,1,"ng-template",null,32,_.W1O),_.qZA(),_.qZA()}if(2&i){const e=_.MAs(27),t=_.oxw(2);_.xp6(6),_.ekj("is-invalid",!t.builtinProtocolName)("is-valid",t.builtinProtocolName),_.Q6J("ngModel",t.builtinProtocolName),_.xp6(19),_.Q6J("ngIf",0!==t.builtinProtocolTemplateProperties.length)("ngIfElse",e)}}function oe(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div"),_.TgZ(1,"form",34),_.TgZ(2,"div",35),_.TgZ(3,"div",36),_.TgZ(4,"span",37),_.SDv(5,60),_.qZA(),_.qZA(),_.TgZ(6,"input",61),_.NdJ("ngModelChange",function(o){return _.CHM(e).$implicit.propertyName=o}),_.qZA(),_.qZA(),_.TgZ(7,"div",40),_._UZ(8,"i",41),_.qZA(),_.TgZ(9,"div",35),_.TgZ(10,"div",36),_.TgZ(11,"span",37),_.SDv(12,62),_.qZA(),_.qZA(),_.TgZ(13,"input",63),_.NdJ("ngModelChange",function(o){return _.CHM(e).$implicit.propertyValue=o}),_.qZA(),_.qZA(),_.TgZ(14,"div",64),_.TgZ(15,"button",65),_.NdJ("click",function(){const c=_.CHM(e).$implicit;return _.oxw(3).removeCustomProtocolProperty(c)}),_._UZ(16,"i",66),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=E.$implicit;_.xp6(6),_.Q6J("ngModel",e.propertyName),_.xp6(7),_.Q6J("ngModel",e.propertyValue)}}function Ee(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div",16),_.TgZ(1,"div",51),_.TgZ(2,"div",18),_.TgZ(3,"label"),_.SDv(4,52),_.qZA(),_.TgZ(5,"input",53),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw(2).customProtocolName=o})("ngModelChange",function(){return _.CHM(e),_.oxw(2).onCustomProtocolNameChange()}),_.qZA(),_.TgZ(6,"div",28),_.TgZ(7,"small"),_.SDv(8,54),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(9,"div",55),_.TgZ(10,"div"),_.TgZ(11,"p",56),_._UZ(12,"span",57),_.TgZ(13,"span",58),_.NdJ("click",function(){return _.CHM(e),_.oxw(2).addCustomProtocolProperty()}),_.SDv(14,59),_.qZA(),_.qZA(),_.qZA(),_.YNc(15,oe,17,2,"div",33),_.qZA(),_.qZA()}if(2&i){const e=_.oxw(2);_.xp6(5),_.ekj("is-invalid",!e.customProtocolName)("is-valid",e.customProtocolName),_.Q6J("ngModel",e.customProtocolName),_.xp6(10),_.Q6J("ngForOf",e.customProtocolPropertyBearer)}}function ce(i,E){if(1&i&&(_.TgZ(0,"div",0),_.TgZ(1,"div",4),_.YNc(2,j_,9,12,"div",6),_.YNc(3,K_,1,0,"div",7),_.YNc(4,ne,28,7,"ng-template",null,8,_.W1O),_.YNc(6,Ee,16,6,"ng-template",null,9,_.W1O),_.qZA(),_.qZA()),2&i){const e=_.MAs(5),t=_.MAs(7),o=_.oxw();_.xp6(2),_.Q6J("ngIf",o.mode===o.MODE_ADD),_.xp6(1),_.Q6J("ngIf",o.protocolTemplateMode===o.TEMPLATE_CUSTOM)("ngIfThen",t)("ngIfElse",e)}}let K=(()=>{class i{constructor(){this.MODE_ADD="add",this.MODE_EDIT="edit",this.deviceProtocols={},this.isValid=!1,this.isValidChange=new _.vpe,this.TEMPLATE_CUSTOM="custom",this.TEMPLATE_BUILT_IN="built-in",this.customProtocolPropertyBearer=[],this.builtinProtocolTemplateProperties=[]}ngOnInit(){if(this.mode){if(this.mode==this.MODE_EDIT)return this.protocolTemplateMode=this.TEMPLATE_CUSTOM,this.extractProtocolName(),this.customProtocolName=this.protocolName?this.protocolName:"",void this.setCustomProtocolPropertysBearer();this.mode==this.MODE_ADD&&(this.protocolTemplateMode=this.TEMPLATE_BUILT_IN),this.validate()}}extractProtocolName(){!this.deviceProtocols||0===Object.keys(this.deviceProtocols).length||(this.protocolName=Object.keys(this.deviceProtocols)[0])}onSelectBuiltinProtocolTemplate(){switch(this.validate(),this.builtinProtocolName){case"mqtt":this.builtinProtocolTemplateSelected=new Q_;break;case"modbus-tcp":this.builtinProtocolTemplateSelected=new W_;break;case"modbus-rtu":this.builtinProtocolTemplateSelected=new w_;break;case"other":this.builtinProtocolTemplateSelected=new k_;break;case"other-rest":this.builtinProtocolTemplateSelected={};break;case"Onvif":this.builtinProtocolTemplateSelected=new J_;break;case"tcp":this.builtinProtocolTemplateSelected=new z_;break;default:this.builtinProtocolTemplateSelected={}}this.builtinProtocolTemplateProperties=Object.keys(this.builtinProtocolTemplateSelected)}changeProtocolTemplateMode(e){this.protocolTemplateMode=e,this.validate()}onCustomProtocolNameChange(){this.validate()}setCustomProtocolPropertysBearer(){if(this.customProtocolName)for(const[e,t]of Object.entries(this.deviceProtocols[this.customProtocolName]))this.customProtocolPropertyBearer.push({propertyName:e,propertyValue:t})}addCustomProtocolProperty(){this.customProtocolPropertyBearer.push({propertyName:"",propertyValue:""})}removeCustomProtocolProperty(e){this.customProtocolPropertyBearer.splice(this.customProtocolPropertyBearer.indexOf(e),1)}getDeviceProtocols(){if(this.deviceProtocols={},this.protocolTemplateMode===this.TEMPLATE_BUILT_IN)this.deviceProtocols[this.builtinProtocolName]=Object.assign({},this.builtinProtocolTemplateSelected);else{let e={};this.customProtocolPropertyBearer.forEach(t=>{e[t.propertyName]=t.propertyValue}),this.deviceProtocols[this.customProtocolName]=e}return this.deviceProtocols}validate(){switch(this.isValid=!0,this.protocolTemplateMode){case this.TEMPLATE_BUILT_IN:this.builtinProtocolName||(this.isValid=!1);break;default:this.customProtocolName||(this.isValid=!1)}this.isValidChange.emit(this.isValid)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-device-protocol"]],inputs:{mode:"mode",deviceProtocols:"deviceProtocols",isValid:"isValid"},outputs:{isValidChange:"isValidChange"},decls:7,vars:1,consts:function(){let E,e,t,o,c,s,T,f,S,O,N,u,m,L;return E="\u8BBE\u5907\u534F\u8BAE",e="\u53EF\u5229\u7528\u7684\u534F\u8BAE\u6A21\u677F",t="\u81EA\u5B9A\u4E49\u534F\u8BAE\u6A21\u677F",o="\u534F\u8BAE\u540D\u5B57",c="\u534F\u8BAE\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",s="PropertyName",T="PropertyVaule",f=" all built-in protocol templates refer to the device service released by edgex, such as device-virtual, device-rest, device-mqtt, device-modbus ",S="\u8BE5\u8BBE\u5907\u670D\u52A1\u4E0D\u9700\u8981\u8BBE\u7F6E\u901A\u4FE1\u534F\u8BAE",O="\u534F\u8BAE\u540D\u5B57",N="\u534F\u8BAE\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",u="\u6DFB\u52A0\u534F\u8BAE\u5C5E\u6027",m="PropertyName",L="PropertyValue",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-tags","fa-lg","text-danger","mr-1"],E,[1,"card-body"],["class","card",4,"ngIf"],["class","mb-2",4,"ngIf"],[4,"ngIf","ngIfThen","ngIfElse"],["builtinProtocolTemplate",""],["customProtocolTemplate",""],[1,"mb-2"],["role","button",1,"user-select-none","badge","font-weight-bold","mr-3",3,"click"],[1,"fa","fa-square-o","mr-1"],e,["role","button",1,"user-select-none","badge","font-weight-bold",3,"click"],t,[1,"row","border","border-secondary","p-2","rounded-lg","mx-1"],[1,"col-md-2","border-right","border-info"],[1,"form-group"],o,["type","text","name","builtinProtocolName","required","",1,"custom-select",3,"ngModel","ngModelChange"],["value","mqtt"],["value","other-rest"],["value","other"],["value","modbus-tcp"],["value","modbus-rtu"],["value","Onvif"],["value","tcp"],[1,"invalid-feedback"],c,[1,"col-md-10"],[4,"ngIf","ngIfElse"],["noBuiltinProperties",""],[4,"ngFor","ngForOf"],[1,"form-inline","mb-1"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],s,["type","text","disabled","",1,"form-control",2,"width","300px",3,"value"],[1,"form-group","mx-2"],[1,"fa","fa-long-arrow-right"],T,["type","text","name","property",1,"form-control",2,"width","300px",3,"ngModel","ngModelChange"],[1,"fa","fa-info-circle","fa-lg","text-success","font-weight-bold","mr-1"],[1,"text-muted"],f,["class","text-warning",4,"ngIf"],[1,"text-warning"],[1,"fa","fa-warning","mr-1"],S,[1,"col-md-2","col-lg-2","border-right","border-secondary"],O,["type","text","name","customProtocolName",1,"form-control",3,"ngModel","ngModelChange"],N,[1,"col-md-10","col-lg-10"],[1,"badge","badge-secondary","font-weight-bold"],[1,"fa","fa-plus-circle","mr-2"],["role","button",1,"user-select-none",3,"click"],u,m,["type","text","name","propertyName",1,"form-control",2,"width","300px",3,"ngModel","ngModelChange"],L,["type","text","name","PropertyValue",1,"form-control",2,"width","300px",3,"ngModel","ngModelChange"],[1,"input-group","ml-2"],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._UZ(2,"i",2),_.TgZ(3,"span"),_.SDv(4,3),_.qZA(),_.qZA(),_.TgZ(5,"div",4),_.YNc(6,ce,8,4,"div",5),_.qZA(),_.qZA()),2&e&&(_.xp6(6),_.Q6J("ngIf",t.mode))},directives:[n.O5,a._Y,a.JL,a.F,a.EJ,a.Q7,a.JJ,a.On,a.YN,a.Kr,n.sg,a.Fj],styles:[""]}),i})();var __=C(4889);function se(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"tr"),_.TgZ(1,"td"),_.TgZ(2,"input",35),_.NdJ("click",function(o){const s=_.CHM(e).$implicit;return _.oxw().selectOneSvc(o,s.name)}),_.qZA(),_.qZA(),_.TgZ(3,"td"),_._uU(4),_.qZA(),_.TgZ(5,"td"),_._uU(6),_.qZA(),_.TgZ(7,"td"),_._uU(8),_.qZA(),_.TgZ(9,"td"),_._uU(10),_.qZA(),_.TgZ(11,"td"),_._uU(12),_.qZA(),_.TgZ(13,"td"),_._uU(14),_.ALo(15,"date"),_.qZA(),_.TgZ(16,"td"),_._uU(17),_.ALo(18,"date"),_.qZA(),_.qZA()}if(2&i){const e=E.$implicit,t=_.oxw();_.ekj("table-active",t.isSvcChecked(e.name)),_.xp6(2),_.Q6J("checked",t.isSvcChecked(e.name)),_.xp6(2),_.Oqu(e.id),_.xp6(2),_.Oqu(e.name),_.xp6(2),_.Oqu(e.description),_.xp6(2),_.Oqu(e.labels),_.xp6(2),_.Oqu(e.adminState),_.xp6(2),_.Oqu(_.xi3(15,10,e.created,"yyyy-MM-dd hh:mm:ss")),_.xp6(3),_.Oqu(_.xi3(18,13,e.modified,"yyyy-MM-dd hh:mm:ss"))}}let n_=(()=>{class i{constructor(e){this.metaSvc=e,this.singleDeviceSvcSelectedEvent=new _.vpe,this.deviceServiceList=[],this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.findAllDeviceSvcPagination()}findAllDeviceSvcPagination(){this.metaSvc.findAllDeviceServicesPagination(this.pageOffset,this.pageLimit).subscribe(e=>{this.deviceServiceList=e.services})}onSingleDeviceSvcSelectedEmitter(){this.singleDeviceSvcSelectedEvent.emit(this.deviceSvcSelected)}isSvcChecked(e){var t;return(null===(t=this.deviceSvcSelected)||void 0===t?void 0:t.name)===e}selectOneSvc(e,t){let c=this;e.target.checked?this.deviceServiceList.forEach(function(s){s.name===t&&(c.deviceSvcSelected=s)}):this.deviceSvcSelected=void 0,this.onSingleDeviceSvcSelectedEmitter()}onPageSelected(){this.resetPagination(),this.setPagination(),this.findAllDeviceSvcPagination()}prePage(){this.setPagination(-1),this.findAllDeviceSvcPagination()}nextPage(){this.setPagination(1),this.findAllDeviceSvcPagination()}setPagination(e){1===e?this.pagination+=1:-1===e&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit}resetPagination(){this.pagination=1}}return i.\u0275fac=function(e){return new(e||i)(_.Y36(p.D))},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-device-service-list"]],inputs:{deviceSvcSelected:"deviceSvcSelected"},outputs:{singleDeviceSvcSelectedEvent:"singleDeviceSvcSelectedEvent"},decls:52,vars:4,consts:function(){let E,e,t,o,c,s,T,f,S,O,N;return E="\u8BBE\u5907\u670D\u52A1\u5217\u8868",e="ID",t="\u540D\u5B57",o="\u63CF\u8FF0",c="\u6807\u7B7E",s="\u7BA1\u7406\u72B6\u6001",T="\u521B\u5EFA\u65F6\u95F4",f="\u4FEE\u6539\u65F6\u95F4",S="\u6BCF\u9875\u6761\u76EE",O="\u4E0A\u4E00\u9875",N="\u4E0B\u4E00\u9875",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-list","mr-2","text-danger"],E,[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],e,t,o,c,s,T,f,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],S,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],O,[1,"page-item"],N,[1,"fa","fa-angle-double-right","ml-1"],["type","checkbox","role","button",3,"checked","click"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._UZ(2,"i",2),_.TgZ(3,"span"),_.SDv(4,3),_.qZA(),_.qZA(),_.TgZ(5,"div",4),_.TgZ(6,"div",5),_.TgZ(7,"table",6),_.TgZ(8,"thead",7),_.TgZ(9,"tr"),_.TgZ(10,"th",8),_._uU(11,"#"),_.qZA(),_.TgZ(12,"th",8),_.SDv(13,9),_.qZA(),_.TgZ(14,"th",8),_.SDv(15,10),_.qZA(),_.TgZ(16,"th",8),_.SDv(17,11),_.qZA(),_.TgZ(18,"th",8),_.SDv(19,12),_.qZA(),_.TgZ(20,"th",8),_.SDv(21,13),_.qZA(),_.TgZ(22,"th",8),_.SDv(23,14),_.qZA(),_.TgZ(24,"th",8),_.SDv(25,15),_.qZA(),_.qZA(),_.qZA(),_.TgZ(26,"tbody"),_.YNc(27,se,19,16,"tr",16),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(28,"div",17),_.TgZ(29,"nav",18),_.TgZ(30,"ul",19),_.TgZ(31,"li",20),_.TgZ(32,"span",21),_.SDv(33,22),_.qZA(),_.qZA(),_.TgZ(34,"li",23),_.TgZ(35,"select",24),_.NdJ("ngModelChange",function(c){return t.pageLimit=c})("ngModelChange",function(){return t.onPageSelected()}),_.TgZ(36,"option",25),_._uU(37,"5"),_.qZA(),_.TgZ(38,"option",26),_._uU(39,"10"),_.qZA(),_.TgZ(40,"option",27),_._uU(41,"20"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(42,"li",28),_.TgZ(43,"button",29),_.NdJ("click",function(){return t.prePage()}),_._UZ(44,"i",30),_.TgZ(45,"span"),_.SDv(46,31),_.qZA(),_.qZA(),_.qZA(),_.TgZ(47,"li",32),_.TgZ(48,"button",29),_.NdJ("click",function(){return t.nextPage()}),_.TgZ(49,"span"),_.SDv(50,33),_.qZA(),_._UZ(51,"i",34),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&e&&(_.xp6(27),_.Q6J("ngForOf",t.deviceServiceList),_.xp6(8),_.Q6J("ngModel",t.pageLimit),_.xp6(8),_.Q6J("disabled",1===t.pagination),_.xp6(5),_.Q6J("disabled",t.pageLimit>t.deviceServiceList.length))},directives:[n.sg,a.EJ,a.JJ,a.On,a.YN,a.Kr],pipes:[n.uU],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),i})();var t_=C(2822);function ae(i,E){if(1&i&&(_.TgZ(0,"option",37),_._uU(1),_.qZA()),2&i){const e=E.$implicit;_.s9C("value",e),_.xp6(1),_.Oqu(e)}}function le(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div",10),_.TgZ(1,"div",4),_.TgZ(2,"form"),_.TgZ(3,"div",11),_.TgZ(4,"label",12),_.SDv(5,13),_.qZA(),_.TgZ(6,"div",14),_.TgZ(7,"div",15),_.TgZ(8,"input",16),_.NdJ("ngModelChange",function(o){return _.CHM(e).$implicit.interval=o})("ngModelChange",function(){return _.CHM(e),_.oxw().onValueChange()}),_.qZA(),_.TgZ(9,"div",17),_.TgZ(10,"select",18),_.NdJ("ngModelChange",function(o){return _.CHM(e).$implicit.unit=o})("ngModelChange",function(){return _.CHM(e),_.oxw().onValueChange()}),_.TgZ(11,"option",19),_._uU(12,"millisecond"),_.qZA(),_.TgZ(13,"option",20),_._uU(14,"second"),_.qZA(),_.TgZ(15,"option",21),_._uU(16,"minute"),_.qZA(),_.TgZ(17,"option",22),_._uU(18,"hour"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(19,"div",23),_.SDv(20,24),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(21,"div",25),_.TgZ(22,"label",12),_.SDv(23,26),_.qZA(),_.TgZ(24,"div",14),_.TgZ(25,"select",27),_.NdJ("ngModelChange",function(o){return _.CHM(e).$implicit.onChange=o})("ngModelChange",function(){return _.CHM(e),_.oxw().onValueChange()}),_.TgZ(26,"option",28),_._uU(27,"true"),_.qZA(),_.TgZ(28,"option",29),_._uU(29,"false"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(30,"div",25),_.TgZ(31,"label",12),_.SDv(32,30),_.qZA(),_.TgZ(33,"div",14),_.TgZ(34,"select",31),_.NdJ("ngModelChange",function(o){return _.CHM(e).$implicit.resource=o})("ngModelChange",function(){return _.CHM(e),_.oxw().onValueChange()}),_.YNc(35,ae,2,2,"option",32),_.qZA(),_.TgZ(36,"div",23),_.SDv(37,33),_.qZA(),_.qZA(),_.qZA(),_.TgZ(38,"button",34),_.NdJ("click",function(){const c=_.CHM(e).$implicit;return _.oxw().removeAutoEvent(c)}),_._UZ(39,"i",35),_.TgZ(40,"span"),_.SDv(41,36),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=E.$implicit,t=_.oxw();_.xp6(8),_.ekj("is-invalid",!t.eventIntervalNumType(e.interval))("is-valid",t.eventIntervalNumType(e.interval)),_.Q6J("ngModel",e.interval),_.xp6(2),_.Q6J("ngModel",e.unit),_.xp6(15),_.Q6J("ngModel",e.onChange),_.xp6(9),_.ekj("is-invalid",""===e.resource)("is-valid",""!==e.resource),_.Q6J("ngModel",e.resource),_.xp6(1),_.Q6J("ngForOf",t.autoEventResourceNameSet)}}let o_=(()=>{class i{constructor(){this.autoEvents=[],this.autoEventsChange=new _.vpe,this.isValid=!1,this.isValidChange=new _.vpe,this.autoEventDecoratorBearer=[],this.autoEventResourceNameSet=[]}ngOnInit(){}ngOnChanges(){this.resetAutoEventDecoratorBearer(),this.setAutoEventDecorator(this.autoEvents),this.setupAutoEventResourceNameSet(this.deviceProfile),this.resumeOriginalAutoEvents()}onValueChange(){this.resumeOriginalAutoEvents()}resetAutoEventDecoratorBearer(){this.autoEventDecoratorBearer.splice(0,this.autoEventDecoratorBearer.length)}addAutoEvent(){this.autoEventDecoratorBearer.push({interval:"",onChange:!1,resource:"",unit:"ms"}),this.resumeOriginalAutoEvents()}removeAutoEvent(e){this.autoEventDecoratorBearer.splice(this.autoEventDecoratorBearer.indexOf(e),1),this.resumeOriginalAutoEvents()}setupAutoEventResourceNameSet(e){!e||(this.autoEventResourceNameSet.splice(0,this.autoEventResourceNameSet.length),e.deviceResources.forEach((t,o)=>{this.autoEventResourceNameSet.push(t.name)}),e.deviceCommands.forEach((t,o)=>{this.autoEventResourceNameSet.push(t.name)}))}eventIntervalNumType(e){return!isNaN(e)&&parseFloat(e)===parseInt(e)}setAutoEventDecorator(e){!e||e.forEach(t=>{let o=0;-1!==t.interval.indexOf("ms")?o=t.interval.indexOf("ms"):-1!==t.interval.indexOf("s")?o=t.interval.indexOf("s"):-1!==t.interval.indexOf("m")?o=t.interval.indexOf("m"):-1!==t.interval.indexOf("h")&&(o=t.interval.indexOf("h")),this.autoEventDecoratorBearer.push({interval:t.interval.slice(0,o),onChange:!!t.onChange&&t.onChange,resource:t.sourceName,unit:t.interval.substring(o)})})}resumeOriginalAutoEvents(){this.autoEvents?this.autoEvents.splice(0,this.autoEvents.length):this.autoEvents=[],this.autoEventDecoratorBearer.forEach(e=>{this.autoEvents.push({interval:`${e.interval}${e.unit}`,onChange:!!e.onChange,sourceName:e.resource})}),this.validate(),this.autoEventsChange.emit(this.autoEvents)}validate(){this.isValid=!0,0!==this.autoEventDecoratorBearer.length&&this.autoEventDecoratorBearer.forEach(e=>{this.eventIntervalNumType(e.interval)&&""!==e.resource||(this.isValid=!1)}),this.isValidChange.emit(this.isValid)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-device-auto-event"]],inputs:{autoEvents:"autoEvents",deviceProfile:"deviceProfile",isValid:"isValid"},outputs:{autoEventsChange:"autoEventsChange",isValidChange:"isValidChange"},features:[_.TTD],decls:11,vars:1,consts:function(){let E,e,t,o,c,s,T,f;return E="\u81EA\u52A8\u91C7\u96C6",e="\u6DFB\u52A0\u66F4\u591A\u81EA\u52A8\u91C7\u96C6\u4E8B\u4EF6",t="\u5355\u4F4D\u95F4\u9694",o=" can only be a pure integer number ",c="onchange",s="\u8BBE\u5907\u8D44\u6E90",T=" resource can't be empty ",f="\u5220\u9664",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-tags","fa-lg","text-danger","mr-1"],E,[1,"card-body"],[1,"badge","badge-secondary","font-weight-bold"],[1,"fa","fa-plus-circle","mr-2"],["role","button",1,"user-select-none",3,"click"],e,["class","card mb-3",4,"ngFor","ngForOf"],[1,"card","mb-3"],[1,"form-group","row","has-validation"],[1,"col-md-2","col-form-label"],t,[1,"col-md-10"],[1,"input-group","mb-3",2,"width","250px"],["type","text","name","interval","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group-append"],["name","eventIntervalUnit","required","",1,"custom-select",3,"ngModel","ngModelChange"],["value","ms"],["value","s"],["value","m"],["value","h"],[1,"invalid-feedback"],o,[1,"form-group","row"],c,["name","onchange",1,"custom-select",2,"width","250px",3,"ngModel","ngModelChange"],["value","true"],["value","false"],s,["name","resource","required","",1,"custom-select",2,"width","250px",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],T,[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash","mr-1"],f,[3,"value"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._UZ(2,"i",2),_.TgZ(3,"span"),_.SDv(4,3),_.qZA(),_.qZA(),_.TgZ(5,"div",4),_.TgZ(6,"p",5),_._UZ(7,"span",6),_.TgZ(8,"span",7),_.NdJ("click",function(){return t.addAutoEvent()}),_.SDv(9,8),_.qZA(),_.qZA(),_.YNc(10,le,42,13,"div",9),_.qZA(),_.qZA()),2&e&&(_.xp6(10),_.Q6J("ngForOf",t.autoEventDecoratorBearer))},directives:[n.sg,a._Y,a.JL,a.F,a.Fj,a.Q7,a.JJ,a.On,a.EJ,a.YN,a.Kr],styles:[""]}),i})();function re(i,E){1&i&&_._UZ(0,"i",33)}function de(i,E){1&i&&_._UZ(0,"i",33)}function Ce(i,E){1&i&&_._UZ(0,"i",33)}function Te(i,E){1&i&&_._UZ(0,"i",33)}function Ae(i,E){1&i&&_._UZ(0,"i",33)}function De(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"button",34),_.NdJ("click",function(){return _.CHM(e),_.oxw().previous()}),_._UZ(1,"i",35),_.TgZ(2,"span"),_.SDv(3,36),_.qZA(),_.qZA()}}function Se(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"button",37),_.NdJ("click",function(){return _.CHM(e),_.oxw().next()}),_.TgZ(1,"span"),_.SDv(2,38),_.qZA(),_._UZ(3,"i",39),_.qZA()}if(2&i){const e=_.oxw();_.Q6J("disabled",e.stepStateLock())}}function Ie(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"button",40),_.NdJ("click",function(){return _.CHM(e),_.oxw().submit()}),_._UZ(1,"i",41),_.TgZ(2,"span"),_.SDv(3,42),_.qZA(),_.qZA()}if(2&i){const e=_.oxw();_.Q6J("disabled",e.stepStateLock())}}function ge(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div",43),_.TgZ(1,"app-device-service-list",44),_.NdJ("singleDeviceSvcSelectedEvent",function(o){return _.CHM(e),_.oxw().onSingleDeviceSvcSelected(o)}),_.qZA(),_.qZA()}if(2&i){const e=_.oxw();_.xp6(1),_.Q6J("deviceSvcSelected",e.selectedSvc)}}function Oe(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div",43),_.TgZ(1,"app-device-profile-list",45),_.NdJ("singleProfileSelectedEvent",function(o){return _.CHM(e),_.oxw().onSingleProfileSelected(o)}),_.qZA(),_.qZA()}if(2&i){const e=_.oxw();_.xp6(1),_.Q6J("singleProfileSelected",e.selectedProfile)("enableSelectAll",!1)("toolbars",!1)("associatedDeviceColumn",!1)}}function pe(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"form",46),_.TgZ(1,"div",47),_.TgZ(2,"label",48),_.SDv(3,49),_.qZA(),_.TgZ(4,"div",50),_.TgZ(5,"input",51),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().newDevice.name=o}),_.qZA(),_.TgZ(6,"div",52),_.TgZ(7,"small"),_.SDv(8,53),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(9,"div",54),_.TgZ(10,"label",55),_.SDv(11,56),_.qZA(),_.TgZ(12,"div",50),_.TgZ(13,"input",57),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().newDevice.description=o}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(14,"div",54),_.TgZ(15,"label",58),_.SDv(16,59),_.qZA(),_.TgZ(17,"div",50),_.TgZ(18,"input",60),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().deviceLabels=o}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(19,"div",54),_.TgZ(20,"label",61),_.SDv(21,62),_.qZA(),_.TgZ(22,"div",50),_.TgZ(23,"select",63),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().newDevice.adminState=o}),_.TgZ(24,"option",64),_._uU(25,"UNLOCKED"),_.qZA(),_.TgZ(26,"option",65),_._uU(27,"LOCKED"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=_.oxw();_.xp6(5),_.ekj("is-invalid",!e.newDevice.name)("is-valid",e.newDevice.name),_.Q6J("ngModel",e.newDevice.name),_.xp6(8),_.Q6J("ngModel",e.newDevice.description),_.xp6(5),_.Q6J("ngModel",e.deviceLabels),_.xp6(5),_.Q6J("ngModel",e.newDevice.adminState)}}function ue(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div",30),_.TgZ(1,"div",1),_.TgZ(2,"span",66),_.SDv(3,67),_.qZA(),_.qZA(),_.TgZ(4,"div",31),_.TgZ(5,"app-device-auto-event",68),_.NdJ("autoEventsChange",function(o){return _.CHM(e),_.oxw().newDevice.autoEvents=o})("isValidChange",function(o){return _.CHM(e),_.oxw().isAutoEventsValid=o}),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=_.oxw();_.xp6(5),_.Q6J("deviceProfile",e.selectedProfile)("autoEvents",e.newDevice.autoEvents)("isValid",e.isAutoEventsValid)}}let Me=(()=>{class i{constructor(e,t,o,c,s){this.metaSvc=e,this.msgSvc=t,this.errorSvc=o,this.router=c,this.route=s,this.deviceLabels="",this.currentStep=0,this.selectedClass="text-white rounded px-2 bg-success  font-weight-bold",this.noSelectedClass="text-white rounded px-2 bg-secondary  font-weight-bold",this.isProtocolValid=!1,this.isAutoEventsValid=!1,this.newDevice={adminState:"UNLOCKED",operatingState:"UP"}}ngOnInit(){}onSingleProfileSelected(e){this.selectedProfile=e}onSingleDeviceSvcSelected(e){this.selectedSvc=e}stepStateLock(){switch(this.currentStep){case 0:return void 0===this.selectedSvc;case 1:return void 0===this.selectedProfile;case 2:return!this.newDevice.name;case 3:return!this.isAutoEventsValid;case 4:return!this.isProtocolValid;default:return!1}}next(){this.currentStep+=1}previous(){this.currentStep=this.currentStep-1}submit(){var e,t,o;this.newDevice.labels=null===(e=this.deviceLabels)||void 0===e?void 0:e.split(","),this.newDevice.serviceName=null===(t=this.selectedSvc)||void 0===t?void 0:t.name,this.newDevice.profileName=null===(o=this.selectedProfile)||void 0===o?void 0:o.name,this.newDevice.protocols=this.deviceProtocols.getDeviceProtocols(),this.metaSvc.addDevice(this.newDevice).subscribe(c=>{this.errorSvc.handleErrorForV2API(c)||(this.msgSvc.success("Add device",`name: ${this.newDevice.name}`),this.router.navigate(["../device-list"],{relativeTo:this.route}))})}}return i.\u0275fac=function(e){return new(e||i)(_.Y36(p.D),_.Y36(V.e),_.Y36(__.T),_.Y36(A.F0),_.Y36(A.gz))},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-add-device"]],viewQuery:function(e,t){if(1&e&&_.Gf(K,5),2&e){let o;_.iGM(o=_.CRH())&&(t.deviceProtocols=o.first)}},decls:54,vars:22,consts:function(){let E,e,t,o,c,s,T,f,S,O,N,u,m,L,R;return E="\u8BBE\u5907\u6DFB\u52A0\u5411\u5BFC",e="\u9009\u62E9\u8BBE\u5907\u670D\u52A1",t="\u9009\u62E9\u8BBE\u5907\u5143\u4FE1\u606F",o="\u8BBE\u5907\u4FE1\u606F",c="\u521B\u5EFA\u81EA\u52A8\u4E8B\u4EF6",s="\u521B\u5EFA\u8BBE\u5907\u901A\u4FE1\u534F\u8BAE",T="\u4E0A\u4E00\u9875",f="\u4E0B\u4E00\u9875",S="\u63D0\u4EA4",O="\u540D\u5B57",N="\u8BBE\u5907\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A",u="\u63CF\u8FF0",m="\u6807\u7B7E",L="\u7BA1\u7406\u72B6\u6001",R=" this step is optional, you can skip it then set it later in edit mode.",[[1,"card"],[1,"card-header"],[1,"font-weight-bold"],[1,"fa","fa-lightbulb-o","fa-lg","mr-2","text-danger"],[1,"text-secondary"],E,[1,"card-header","py-2"],["aria-label","breadcrumb",1,"mb-0","p-0"],[1,"breadcrumb","p-1","mb-0","bg-light"],[1,"breadcrumb-item"],[3,"ngClass"],e,["class","fa fa-check ml-1",4,"ngIf"],t,o,c,[1,"breadcrumb-item","active"],s,[1,"card-header","py-1"],["class","btn btn-info btn-sm",3,"click",4,"ngIf"],["class","btn btn-primary btn-sm float-right",3,"disabled","click",4,"ngIf","ngIfElse"],["stepDone",""],[1,"card-body","p-0"],[3,"ngSwitch"],[3,"ngSwitchCase"],["SelectDeviceService",""],["SelectDeviceProfile",""],["DevicePrimary",""],["CreateAutoEvent",""],["CreateDeviceProtocol",""],[1,"card","border-0"],[1,"card-body"],[3,"mode","isValid","isValidChange"],[1,"fa","fa-check","ml-1"],[1,"btn","btn-info","btn-sm",3,"click"],[1,"fa","fa-long-arrow-left","mr-1"],T,[1,"btn","btn-primary","btn-sm","float-right",3,"disabled","click"],f,[1,"fa","fa-long-arrow-right","ml-1"],[1,"btn","btn-success","btn-sm","ml-4","float-right",3,"disabled","click"],[1,"fa","fa-save","mr-1"],S,[1,"p-2"],[3,"deviceSvcSelected","singleDeviceSvcSelectedEvent"],[3,"singleProfileSelected","enableSelectAll","toolbars","associatedDeviceColumn","singleProfileSelectedEvent"],[1,"px-5","py-4"],[1,"form-group","row","has-validation"],["for","deviceName","required","",1,"col-md-2","col-form-label"],O,[1,"col-md-10"],["type","text","id","validationDeviceNameFeedback","name","deviceName",1,"form-control",3,"ngModel","ngModelChange"],["id","validationDeviceNameFeedback",1,"invalid-feedback"],N,[1,"form-group","row"],["for","deviceDesc",1,"col-md-2","col-form-label"],u,["type","text","name","deviceDescription",1,"form-control",3,"ngModel","ngModelChange"],["for","deviceLabels",1,"col-md-2","col-form-label"],m,["type","text","name","deviceLabels","placeholder","Multiple Labels are separated by commas: label1,label2,label3",1,"form-control",3,"ngModel","ngModelChange"],["for","adminState",1,"col-md-2","col-form-label"],L,["name","deviceAdminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"],[1,"fa","fa-info-circle","text-warning","font-weight-bold"],R,[3,"deviceProfile","autoEvents","isValid","autoEventsChange","isValidChange"]]},template:function(e,t){if(1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"span",2),_._UZ(3,"span",3),_.TgZ(4,"span",4),_.SDv(5,5),_.qZA(),_.qZA(),_.qZA(),_.TgZ(6,"div",6),_.TgZ(7,"nav",7),_.TgZ(8,"ol",8),_.TgZ(9,"li",9),_.TgZ(10,"span",10),_.TgZ(11,"span"),_.SDv(12,11),_.qZA(),_.YNc(13,re,1,0,"i",12),_.qZA(),_.qZA(),_.TgZ(14,"li",9),_.TgZ(15,"span",10),_.TgZ(16,"span"),_.SDv(17,13),_.qZA(),_.YNc(18,de,1,0,"i",12),_.qZA(),_.qZA(),_.TgZ(19,"li",9),_.TgZ(20,"span",10),_.TgZ(21,"span"),_.SDv(22,14),_.qZA(),_.YNc(23,Ce,1,0,"i",12),_.qZA(),_.qZA(),_.TgZ(24,"li",9),_.TgZ(25,"span",10),_.TgZ(26,"span"),_.SDv(27,15),_.qZA(),_.YNc(28,Te,1,0,"i",12),_.qZA(),_.qZA(),_.TgZ(29,"li",16),_.TgZ(30,"span",10),_.TgZ(31,"span"),_.SDv(32,17),_.qZA(),_.YNc(33,Ae,1,0,"i",12),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(34,"div",18),_.YNc(35,De,4,0,"button",19),_.YNc(36,Se,4,1,"button",20),_.YNc(37,Ie,4,1,"ng-template",null,21,_.W1O),_.qZA(),_.TgZ(39,"div",22),_.TgZ(40,"div",23),_.YNc(41,ge,2,1,"ng-template",24,25,_.W1O),_.YNc(43,Oe,2,4,"ng-template",24,26,_.W1O),_.YNc(45,pe,28,8,"ng-template",24,27,_.W1O),_.YNc(47,ue,6,3,"ng-template",24,28,_.W1O),_.TgZ(49,"div",null,29),_.TgZ(51,"div",30),_.TgZ(52,"div",31),_.TgZ(53,"app-device-protocol",32),_.NdJ("isValidChange",function(c){return t.isProtocolValid=c}),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&e){const o=_.MAs(38);_.xp6(10),_.Q6J("ngClass",t.currentStep>=0?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=1),_.xp6(2),_.Q6J("ngClass",t.currentStep>=1?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=2),_.xp6(2),_.Q6J("ngClass",t.currentStep>=2?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=3),_.xp6(2),_.Q6J("ngClass",t.currentStep>=3?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=4),_.xp6(2),_.Q6J("ngClass",t.currentStep>=4?t.selectedClass:t.noSelectedClass),_.xp6(3),_.Q6J("ngIf",t.currentStep>=5),_.xp6(2),_.Q6J("ngIf",t.currentStep),_.xp6(1),_.Q6J("ngIf",4>t.currentStep)("ngIfElse",o),_.xp6(4),_.Q6J("ngSwitch",t.currentStep),_.xp6(1),_.Q6J("ngSwitchCase",0),_.xp6(2),_.Q6J("ngSwitchCase",1),_.xp6(2),_.Q6J("ngSwitchCase",2),_.xp6(2),_.Q6J("ngSwitchCase",3),_.xp6(2),_.Udp("display",4===t.currentStep?"":"none"),_.xp6(4),_.Q6J("mode","add")("isValid",t.isProtocolValid)}},directives:[n.mk,n.O5,n.RF,n.n9,K,n_,t_.f,a._Y,a.JL,a.F,a.Fj,a.JJ,a.On,a.EJ,a.YN,a.Kr,o_],styles:['.breadcrumb[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] + li[_ngcontent-%COMP%]:before{color:inherit;font-weight:inherit;content:">>";padding:0 5px}.btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}']}),i})();function fe(i,E){if(1&i){const e=_.EpF();_.TgZ(0,"div",1),_.TgZ(1,"div",2),_._UZ(2,"i",3),_.TgZ(3,"span",4),_.SDv(4,5),_.qZA(),_.TgZ(5,"span",6),_._uU(6),_.qZA(),_.TgZ(7,"button",7),_.NdJ("click",function(){return _.CHM(e),_.oxw().save()}),_.TgZ(8,"span"),_._UZ(9,"i",8),_.TgZ(10,"span"),_.SDv(11,9),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(12,"div",10),_.TgZ(13,"div",11),_.TgZ(14,"div",2),_._UZ(15,"i",12),_.TgZ(16,"span"),_.SDv(17,13),_.qZA(),_.qZA(),_.TgZ(18,"div",10),_.TgZ(19,"form"),_.TgZ(20,"div",14),_.TgZ(21,"label",15),_.SDv(22,16),_.qZA(),_.TgZ(23,"div",17),_.TgZ(24,"input",18),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().device.name=o}),_.qZA(),_.TgZ(25,"div",19),_.SDv(26,20),_.qZA(),_.qZA(),_.qZA(),_.TgZ(27,"div",14),_.TgZ(28,"label",15),_.SDv(29,21),_.qZA(),_.TgZ(30,"div",17),_.TgZ(31,"input",22),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().device.description=o}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(32,"div",14),_.TgZ(33,"label",15),_.SDv(34,23),_.qZA(),_.TgZ(35,"div",17),_.TgZ(36,"input",24),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().deviceLabels=o}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(37,"div",14),_.TgZ(38,"label",25),_.SDv(39,26),_.qZA(),_.TgZ(40,"div",17),_.TgZ(41,"select",27),_.NdJ("ngModelChange",function(o){return _.CHM(e),_.oxw().device.adminState=o}),_.TgZ(42,"option",28),_._uU(43,"UNLOCKED"),_.qZA(),_.TgZ(44,"option",29),_._uU(45,"LOCKED"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(46,"div",14),_.TgZ(47,"label",30),_.SDv(48,31),_.qZA(),_.TgZ(49,"div",17),_._UZ(50,"input",32),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(51,"div",33),_.TgZ(52,"app-device-service-list",34),_.NdJ("singleDeviceSvcSelectedEvent",function(o){return _.CHM(e),_.oxw().onSingleDeviceSvcSelected(o)}),_.qZA(),_.qZA(),_.TgZ(53,"div",33),_.TgZ(54,"app-device-profile-list",35),_.NdJ("singleProfileSelectedEvent",function(o){return _.CHM(e),_.oxw().onSingleProfileSelected(o)}),_.qZA(),_.qZA(),_.TgZ(55,"div",33),_.TgZ(56,"app-device-protocol",36),_.NdJ("isValidChange",function(o){return _.CHM(e),_.oxw().isProtocolValid=o}),_.qZA(),_.qZA(),_.TgZ(57,"div",33),_.TgZ(58,"app-device-auto-event",37),_.NdJ("autoEventsChange",function(o){return _.CHM(e),_.oxw().device.autoEvents=o})("isValidChange",function(o){return _.CHM(e),_.oxw().isAutoEventsValid=o}),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&i){const e=_.oxw();_.xp6(6),_.Oqu(e.device.name),_.xp6(1),_.Q6J("disabled",e.validateBeforeSave()),_.xp6(17),_.ekj("is-invalid",""===e.device.name),_.Q6J("ngModel",e.device.name),_.xp6(7),_.Q6J("ngModel",e.device.description),_.xp6(5),_.Q6J("ngModel",e.deviceLabels),_.xp6(5),_.Q6J("ngModel",e.device.adminState),_.xp6(9),_.Q6J("value",e.device.operatingState),_.xp6(2),_.Q6J("deviceSvcSelected",e.selectedSvc),_.xp6(2),_.Q6J("enableSelectAll",!1)("toolbars",!1)("singleProfileSelected",e.selectedProfile)("associatedDeviceColumn",!1),_.xp6(2),_.Q6J("mode","edit")("deviceProtocols",e.device.protocols)("isValid",e.isProtocolValid),_.xp6(2),_.Q6J("deviceProfile",e.selectedProfile)("autoEvents",e.device.autoEvents)("isValid",e.isAutoEventsValid)}}let me=(()=>{class i{constructor(e,t,o,c,s){this.router=e,this.route=t,this.metaSvc=o,this.msgSvc=c,this.errorSvc=s,this.isProtocolValid=!0,this.isAutoEventsValid=!0}ngOnInit(){this.route.queryParams.subscribe(e=>{!e.deviceName||this.metaSvc.findDeviceByName(e.deviceName).subscribe(o=>{var c;this.device=o.device,this.deviceLabels=null===(c=this.device.labels)||void 0===c?void 0:c.join(","),this.setDefaultDeviceSvcSelected(this.device.serviceName),this.setDefaultDeviceProfileSelected(this.device.profileName)})})}onSingleProfileSelected(e){this.selectedProfile=e}onSingleDeviceSvcSelected(e){this.selectedSvc=e}setDefaultDeviceSvcSelected(e){this.metaSvc.findDevcieServiceByName(e).subscribe(t=>{this.selectedSvc=t.service})}setDefaultDeviceProfileSelected(e){this.metaSvc.findProfileByName(e).subscribe(t=>{this.selectedProfile=t.profile})}validateBeforeSave(){return""===this.device.name||!this.isAutoEventsValid||!this.isProtocolValid}save(){var e,t,o;this.device.labels=null===(e=this.deviceLabels)||void 0===e?void 0:e.split(","),this.device.serviceName=null===(t=this.selectedSvc)||void 0===t?void 0:t.name,this.device.profileName=null===(o=this.selectedProfile)||void 0===o?void 0:o.name,this.device.protocols=this.deviceProtocols.getDeviceProtocols(),this.metaSvc.updateDevice(this.device).subscribe(c=>{var s;this.errorSvc.handleErrorForV2API(c)||(this.msgSvc.success("update device",`name: ${null===(s=this.device)||void 0===s?void 0:s.name}`),this.router.navigate(["../device-list"],{relativeTo:this.route}))})}}return i.\u0275fac=function(e){return new(e||i)(_.Y36(A.F0),_.Y36(A.gz),_.Y36(p.D),_.Y36(V.e),_.Y36(__.T))},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-edit-device"]],viewQuery:function(e,t){if(1&e&&_.Gf(K,5),2&e){let o;_.iGM(o=_.CRH())&&(t.deviceProtocols=o.first)}},decls:1,vars:1,consts:function(){let E,e,t,o,c,s,T,f,S;return E="\u7F16\u8F91\u8BBE\u5907",e="\u4FDD\u5B58",t="\u8BBE\u5907\u57FA\u672C\u4FE1\u606F",o="\u8BBE\u5907\u540D\u5B57",c="\u8BBE\u5907\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A\uFF01",s="\u63CF\u8FF0",T="\u6807\u7B7E",f="\u7BA1\u7406\u72B6\u6001",S="\u64CD\u4F5C\u72B6\u6001",[["class","card",4,"ngIf"],[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-edit","text-danger","fa-lg"],[1,"mx-2"],E,[1,"text-primary"],["type","button",1,"btn","btn-success","btn-sm","float-right",3,"disabled","click"],[1,"fa","fa-save","mr-1"],e,[1,"card-body"],[1,"card","mb-3"],[1,"fa","fa-tags","fa-lg","text-danger","mr-1"],t,[1,"form-group","row"],[1,"col-md-2","col-form-label"],o,[1,"col-md-10"],["type","text","name","name","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"invalid-feedback"],c,s,["type","text","name","description",1,"form-control",3,"ngModel","ngModelChange"],T,["type","text","name","labels",1,"form-control",3,"ngModel","ngModelChange"],["for","adminState",1,"col-md-2","col-form-label"],f,["name","adminState",1,"custom-select",3,"ngModel","ngModelChange"],["value","UNLOCKED"],["value","LOCKED"],["for","operatingState",1,"col-md-2","col-form-label"],S,["type","text","name","operatingState","disabled","",1,"form-control",3,"value"],[1,"mb-3"],[3,"deviceSvcSelected","singleDeviceSvcSelectedEvent"],[3,"enableSelectAll","toolbars","singleProfileSelected","associatedDeviceColumn","singleProfileSelectedEvent"],[3,"mode","deviceProtocols","isValid","isValidChange"],[3,"deviceProfile","autoEvents","isValid","autoEventsChange","isValidChange"]]},template:function(e,t){1&e&&_.YNc(0,fe,59,20,"div",0),2&e&&_.Q6J("ngIf",t.device)},directives:[n.O5,a._Y,a.JL,a.F,a.Fj,a.Q7,a.JJ,a.On,a.EJ,a.YN,a.Kr,n_,t_.f,K,o_],styles:["input[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}.btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),i})(),ve=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-device-profile-center"]],decls:1,vars:0,template:function(e,t){1&e&&_._UZ(0,"router-outlet")},directives:[A.lC],styles:[""]}),i})(),Re=(()=>{class i{constructor(e,t,o,c,s){this.metaSvc=e,this.msgSvc=t,this.errSvc=o,this.router=c,this.route=s}ngOnInit(){this.renderYamlSource()}renderYamlSource(){let e=document.getElementById("editor");this.codeMirrorEditor=CodeMirror.fromTextArea(e,{mode:"yaml",theme:"gruvbox-dark",foldGutter:!0,smartIndent:!0,showCursorWhenSelecting:!0,lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],autofocus:!0,matchBrackets:!0,autoCloseBrackets:!0,styleActiveLine:!0,cursorHeight:.85,autocorrect:!0}),this.codeMirrorEditor.setSize("auto","600px"),this.codeMirrorEditor.on("drop",(t,o)=>{var c;this.yamlFile=null===(c=o.dataTransfer)||void 0===c?void 0:c.files[0]}),this.codeMirrorEditor.on("paste",(t,o)=>{})}submit(){this.profileYamlSource=this.codeMirrorEditor.getValue(),this.metaSvc.addProfileYamlByNameViaUIBackend(this.profileYamlSource).subscribe(e=>{this.errSvc.handleErrorForV2API(e)||(this.msgSvc.success("Add profile"),this.router.navigate(["../device-profile-list"],{relativeTo:this.route}))})}}return i.\u0275fac=function(e){return new(e||i)(_.Y36(p.D),_.Y36(V.e),_.Y36(__.T),_.Y36(A.F0),_.Y36(A.gz))},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-add-profile"]],decls:15,vars:0,consts:function(){let E,e,t;return E="\u6DFB\u52A0\u8BBE\u5907\u5143\u4FE1\u606F",e="\u62D6\u62FD\u529F\u80FD\u5DF2\u5F00\u542F",t="\u63D0\u4EA4",[[1,"card"],[1,"card-header"],[1,"text-danger","font-weight-bold","fa","fa-code","mr-2"],[1,"mr-3","font-weight-bold"],E,[1,"fa","fa-info-circle","text-success","font-weight-bold"],e,[1,"float-right"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save","mr-1"],t,[1,"card-body","p-0"],["id","editor","name","editor"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"span"),_._UZ(3,"span",2),_.TgZ(4,"span",3),_.SDv(5,4),_.qZA(),_.TgZ(6,"span",5),_.SDv(7,6),_.qZA(),_.qZA(),_.TgZ(8,"span",7),_.TgZ(9,"button",8),_.NdJ("click",function(){return t.submit()}),_._UZ(10,"i",9),_.TgZ(11,"span"),_.SDv(12,10),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(13,"div",11),_._UZ(14,"textarea",12),_.qZA(),_.qZA())},styles:[""]}),i})(),Ge=(()=>{class i{constructor(e,t,o,c,s){this.metaSvc=e,this.msgSvc=t,this.errSvc=o,this.router=c,this.route=s}ngOnInit(){this.renderYamlSource(),this.route.queryParams.subscribe(e=>{e.profileName&&(this.profileName=e.profileName,this.metaSvc.findProfileYamlByNameViaUIBackend(e.profileName).subscribe(t=>{this.codeMirrorEditor.setValue(t),this.codeMirrorEditor.refresh()}))})}update(){this.codeMirrorEditor.refresh(),this.metaSvc.updateProfileYamlContentViaUIBackend(this.codeMirrorEditor.getValue()).subscribe(e=>{this.errSvc.handleErrorForV2API(e)||(this.msgSvc.success("Update profile",`name: ${this.profileName}`),this.router.navigate(["../device-profile-list"],{relativeTo:this.route}))})}renderYamlSource(){let e=document.getElementById("editor-edit");this.codeMirrorEditor=CodeMirror.fromTextArea(e,{mode:"yaml",theme:"gruvbox-dark",foldGutter:!0,smartIndent:!0,showCursorWhenSelecting:!0,lineNumbers:!0,lineWrapping:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","CodeMirror-lint-markers"],autofocus:!0,matchBrackets:!0,autoCloseBrackets:!0,styleActiveLine:!0,cursorHeight:.85,autocorrect:!0}),this.codeMirrorEditor.setSize("auto","600px")}ngOnDestroy(){this.codeMirrorEditor=null}}return i.\u0275fac=function(e){return new(e||i)(_.Y36(p.D),_.Y36(V.e),_.Y36(__.T),_.Y36(A.F0),_.Y36(A.gz))},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-edit-profile"]],decls:13,vars:1,consts:function(){let E;return E="\u4FDD\u5B58",[[1,"card"],[1,"card-header"],[1,"text-danger","fa","fa-edit","mr-2"],[1,"float-right"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-save","mr-1"],E,[1,"card-body","p-0"],["id","editor-edit","name","editor"]]},template:function(e,t){1&e&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"span"),_._UZ(3,"span",2),_._uU(4),_.qZA(),_.TgZ(5,"span",3),_.TgZ(6,"button",4),_.NdJ("click",function(){return t.update()}),_.TgZ(7,"span"),_._UZ(8,"i",5),_.TgZ(9,"span"),_.SDv(10,6),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(11,"div",7),_._UZ(12,"textarea",8),_.qZA(),_.qZA()),2&e&&(_.xp6(4),_.hij("",t.profileName," "))},styles:[""]}),i})(),Ue=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-provision-watcher-center"]],decls:2,vars:0,template:function(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1,"provision-watcher-center works!"),_.qZA())},styles:[""]}),i})(),Ne=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-provision-watcher-list"]],decls:2,vars:0,template:function(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1,"provision-watcher-list works!"),_.qZA())},styles:[""]}),i})(),Pe=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-add-provision-watcher"]],decls:2,vars:0,template:function(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1,"add-provision-watcher works!"),_.qZA())},styles:[""]}),i})(),he=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=_.Xpm({type:i,selectors:[["app-edit-provision-watcher"]],decls:2,vars:0,template:function(e,t){1&e&&(_.TgZ(0,"p"),_._uU(1,"edit-provision-watcher works!"),_.qZA())},styles:[""]}),i})();var Ze=C(8253),Ve=C(1964),Le=C(4294),be=C(5894),Xe=C(7216);let E_=(()=>{class i{constructor(e,t){this.router=e,this.metadataSvc=t}canActivate(e,t){return this.checkAvailable(e,t)}canActivateChild(e,t){return this.canActivate(e,t)}checkAvailable(e,t){return this.metadataSvc.ping().pipe((0,Le.q)(1),(0,be.K)(o=>this.router.navigate(["/svc-unavailable"],{queryParams:{svcName:"metadata",routerPath:`/${t.url.split("/")[1]}`}})),(0,Xe.z)(()=>(0,Ve.of)(!0)))}}return i.\u0275fac=function(e){return new(e||i)(_.LFG(A.F0),_.LFG(p.D))},i.\u0275prov=_.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const $e=[{path:"",component:X,canActivate:[Ze.a,E_],canActivateChild:[E_],children:[{path:"",redirectTo:"device-service-list",pathMatch:"full"},{path:"device-service-list",component:P},{path:"device-center",component:l,children:[{path:"",redirectTo:"device-list",pathMatch:"full"},{path:"device-list",component:Y_},{path:"add-device",component:Me},{path:"edit-device",component:me}]},{path:"device-profile-center",component:ve,children:[{path:"",redirectTo:"device-profile-list",pathMatch:"full"},{path:"device-profile-list",component:t_.f},{path:"edit-profile",component:Ge},{path:"add-profile",component:Re}]},{path:"provision-watcher-center",component:Ue,children:[{path:"",redirectTo:"provision-watcher-list",pathMatch:"full"},{path:"provision-watcher-list",component:Ne},{path:"edit-provision-watcher",component:he},{path:"add-provision-watcher",component:Pe}]}]}];let Be=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=_.oAB({type:i}),i.\u0275inj=_.cJS({imports:[[A.Bz.forChild($e)],A.Bz]}),i})(),xe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=_.oAB({type:i}),i.\u0275inj=_.cJS({imports:[[n.ez,a.u5,Be,a.UX]]}),i})()},2822:(i_,b,C)=>{C.d(b,{f:()=>e_});var n=C(476),a=C(2437),A=C(7822),_=C(9502),X=C(8583),p=C(3092);function V(g,P){if(1&g){const l=n.EpF();n.TgZ(0,"div",50),n.TgZ(1,"div",51),n.TgZ(2,"button",52),n.NdJ("click",function(){return n.CHM(l),n.oxw().refresh()}),n.TgZ(3,"span"),n._UZ(4,"i",53),n.TgZ(5,"span"),n.SDv(6,54),n.qZA(),n.qZA(),n.qZA(),n.TgZ(7,"button",55),n.TgZ(8,"span"),n._UZ(9,"i",56),n.TgZ(10,"span"),n.SDv(11,57),n.qZA(),n.qZA(),n.qZA(),n.TgZ(12,"button",58),n.NdJ("click",function(){return n.CHM(l),n.oxw().edit()}),n.TgZ(13,"span"),n._UZ(14,"i",59),n.TgZ(15,"span"),n.SDv(16,60),n.qZA(),n.qZA(),n.qZA(),n.TgZ(17,"button",61),n.NdJ("click",function(){return n.CHM(l),n.oxw().deleteConfirm()}),n.TgZ(18,"span"),n._UZ(19,"i",62),n.TgZ(20,"span"),n.SDv(21,63),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&g){const l=n.oxw();n.xp6(12),n.Q6J("disabled",1!==l.multiProfilesSelected.length),n.xp6(5),n.Q6J("disabled",0===l.multiProfilesSelected.length)}}function I(g,P){if(1&g){const l=n.EpF();n.TgZ(0,"input",64),n.NdJ("click",function(D){return n.CHM(l),n.oxw().selectAll(D)}),n.qZA()}if(2&g){const l=n.oxw();n.Q6J("checked",l.isCheckedAll())}}function M(g,P){1&g&&(n.TgZ(0,"th",9),n.SDv(1,65),n.qZA())}const U=function(g){return{profileName:g}};function Z(g,P){if(1&g&&(n.TgZ(0,"td",69),n.TgZ(1,"a",70),n._UZ(2,"i",71),n.qZA(),n.qZA()),2&g){const l=n.oxw().$implicit;n.xp6(1),n.Q6J("queryParams",n.VKq(1,U,l.name))}}function x(g,P){if(1&g){const l=n.EpF();n.TgZ(0,"tr"),n.TgZ(1,"td"),n.TgZ(2,"input",66),n.NdJ("click",function(D){const B=n.CHM(l).$implicit;return n.oxw().selectOne(D,B.name)}),n.qZA(),n.qZA(),n.TgZ(3,"td",67),n._uU(4),n.qZA(),n.TgZ(5,"td",67),n._uU(6),n.qZA(),n.TgZ(7,"td"),n._uU(8),n.qZA(),n.YNc(9,Z,3,3,"td",68),n.TgZ(10,"td"),n._uU(11),n.qZA(),n.TgZ(12,"td"),n._uU(13),n.qZA(),n.TgZ(14,"td"),n._uU(15),n.qZA(),n.qZA()}if(2&g){const l=P.$implicit,r=n.oxw();n.ekj("table-active",r.isChecked(l.name)),n.xp6(2),n.s9C("value",l.name),n.Q6J("checked",r.isChecked(l.name)),n.xp6(2),n.Oqu(l.id),n.xp6(2),n.Oqu(l.name),n.xp6(2),n.Oqu(l.description),n.xp6(1),n.Q6J("ngIf",r.associatedDeviceColumn),n.xp6(2),n.Oqu(l.labels),n.xp6(2),n.Oqu(l.manufacturer),n.xp6(2),n.Oqu(l.model)}}let e_=(()=>{class g{constructor(l,r,D,h){this.metaSvc=l,this.msgSvc=r,this.route=D,this.router=h,this.associatedDeviceColumn=!0,this.toolbars=!0,this.enableSelectAll=!0,this.singleProfileSelectedEvent=new n.vpe,this.multipleProfileSelectedEvent=new n.vpe,this.profileList=[],this.multiProfilesSelected=[],this.pagination=1,this.pageLimit=5,this.pageOffset=(this.pagination-1)*this.pageLimit}ngOnInit(){this.route.queryParams.subscribe(l=>{l.profileName?this.metaSvc.findProfileByName(l.profileName).subscribe(r=>{this.profileList=[],this.profileList.push(r.profile)}):this.findAllDeviceProfilesPagination()})}findAllDeviceProfilesPagination(){this.metaSvc.allDeviceProfolesPagination(this.pageOffset,this.pageLimit).subscribe(l=>{this.profileList=l.profiles})}onSingleProfileSelectedEmitter(){this.singleProfileSelectedEvent.emit(this.singleProfileSelected)}onMultipleProfileSelectedEmitter(){this.multipleProfileSelectedEvent.emit(this.multiProfilesSelected)}refresh(){this.metaSvc.allDeviceProfolesPagination(0,this.pageLimit).subscribe(l=>{this.profileList=l.profiles,this.msgSvc.success("refresh"),this.pagination=1,this.resetCheckbox()})}onPageSelected(){this.resetPagination(),this.setPagination(),this.findAllDeviceProfilesPagination()}prePage(){this.setPagination(-1),this.metaSvc.allDeviceProfolesPagination(this.pageOffset,this.pageLimit).subscribe(l=>{this.profileList=l.profiles})}nextPage(){this.setPagination(1),this.metaSvc.allDeviceProfolesPagination(this.pageOffset,this.pageLimit).subscribe(l=>{this.profileList=l.profiles})}setPageLimit(l){this.pageLimit=l}setPagination(l){1===l?this.pagination+=1:-1===l&&(this.pagination-=1),this.pageOffset=(this.pagination-1)*this.pageLimit,this.resetCheckbox()}resetPagination(){this.pagination=1,this.resetCheckbox()}resetCheckbox(){}edit(){this.router.navigate(["../edit-profile"],{relativeTo:this.route,queryParams:{profileName:this.multiProfilesSelected[0]}})}deleteConfirm(){$("#deleteConfirmDialog").modal("show")}delete(){this.multiProfilesSelected.forEach(l=>{this.metaSvc.deleteProfileByName(l).subscribe(()=>{this.multiProfilesSelected=[],this.profileList.forEach((r,D)=>{r.name==l&&(this.profileList.splice(D,1),this.msgSvc.success("delete",`  Name: ${r.name}`))})})}),$("#deleteConfirmDialog").modal("hide")}isSingleProfileChecked(l){var r;return(null===(r=this.singleProfileSelected)||void 0===r?void 0:r.name)===l}selectSingleProfile(l,r){l.target.checked?this.profileList.forEach(h=>{h.name===r&&(this.singleProfileSelected=h)}):this.singleProfileSelected=void 0,this.onSingleProfileSelectedEmitter()}isCheckedAll(){let l=!0;return this.profileList&&0===this.profileList.length&&(l=!1),this.profileList.forEach(r=>{-1===this.multiProfilesSelected.indexOf(r.name)&&(l=!1)}),l}selectAll(l){this.profileList.forEach(l.target.checked?D=>{this.multiProfilesSelected.includes(D.name)||this.multiProfilesSelected.push(D.name)}:D=>{this.multiProfilesSelected.includes(D.name)&&this.multiProfilesSelected.splice(this.multiProfilesSelected.indexOf(D.name),1)}),this.onMultipleProfileSelectedEmitter()}isChecked(l){return this.enableSelectAll?this.multiProfilesSelected.includes(l):this.isSingleProfileChecked(l)}selectOne(l,r){this.enableSelectAll?(l.target.checked?this.multiProfilesSelected.push(r):this.multiProfilesSelected.splice(this.multiProfilesSelected.indexOf(r),1),this.onMultipleProfileSelectedEmitter()):this.selectSingleProfile(l,r)}}return g.\u0275fac=function(l){return new(l||g)(n.Y36(a.D),n.Y36(A.e),n.Y36(_.gz),n.Y36(_.F0))},g.\u0275cmp=n.Xpm({type:g,selectors:[["app-device-profile-list"]],inputs:{associatedDeviceColumn:"associatedDeviceColumn",toolbars:"toolbars",enableSelectAll:"enableSelectAll",multiProfilesSelected:"multiProfilesSelected",singleProfileSelected:"singleProfileSelected"},outputs:{singleProfileSelectedEvent:"singleProfileSelectedEvent",multipleProfileSelectedEvent:"multipleProfileSelectedEvent"},decls:67,vars:7,consts:function(){let P,l,r,D,h,B,q,H,F,y,Y,Q,W,w,k,J,z,j;return P="\u8BBE\u5907\u5143\u4FE1\u606F\u5217\u8868",l="\u540D\u5B57",r="\u63CF\u8FF0",D="\u6807\u7B7E",h="\u7EF4\u62A4\u8005",B="\u6A21\u5F0F",q="\u6BCF\u9875\u6761\u76EE",H="\u4E0A\u4E00\u9875",F="\u4E0B\u4E00\u9875",y="\u8B66\u544A",Y="\u6570\u636E\u5C06\u4F1A\u6C38\u4E45\u5220\u9664\uFF01\uFF01\uFF01\u786E\u5B9A\u8981\u6267\u884C\u5220\u9664\u64CD\u4F5C\u5417\uFF1F",Q="\u53D6\u6D88",W="\u786E\u8BA4",w="\u5237\u65B0",k="\u6DFB\u52A0",J="\u7F16\u8F91",z="\u5220\u9664",j="\u76F8\u5173\u8BBE\u5907",[[1,"card"],[1,"card-header","font-weight-bold"],[1,"fa","fa-list","text-danger","mr-2"],P,[1,"card-body","p-0"],["class","bg-light px-2 py-2",4,"ngIf"],[1,"table-responsive"],[1,"table","table-hover","text-truncate"],[1,"thead-light"],["scope","col"],["type","checkbox",3,"checked","click",4,"ngIf"],l,r,["scope","col",4,"ngIf"],D,h,B,[3,"table-active",4,"ngFor","ngForOf"],[1,"card-footer","text-muted","p-1"],["aria-label","navigation"],[1,"pagination","justify-content-end","m-0"],[1,"page-item","mr-2","mt-1"],[1,"align-middle"],q,[1,"page-item","mr-2"],["name","pageLimit","id","pageLimit",1,"custom-select",3,"ngModel","ngModelChange"],["value","5"],["value","10"],["value","20"],[1,"page-item","mr-1"],[1,"page-link","btn",3,"disabled","click"],[1,"fa","fa-angle-double-left","mr-1"],H,[1,"page-item"],F,[1,"fa","fa-angle-double-right","ml-1"],["id","deleteConfirmDialog","data-backdrop","static","data-keyboard","false","tabindex","-1","aria-labelledby","deleteConfirmDialogLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","deleteConfirmDialogLabel",1,"modal-title","text-danger"],[1,"fa","fa-warning","mr-1"],y,[1,"modal-body"],Y,[1,"modal-footer"],["type","button","data-dismiss","modal",1,"btn","btn-secondary"],Q,["type","button",1,"btn","btn-danger",3,"click"],W,[1,"bg-light","px-2","py-2"],["role","group",1,"btn-group","btn-group-sm"],[1,"btn","btn-primary",3,"click"],[1,"fa","fa-refresh","mr-1"],w,["type","button","routerLink","../add-profile",1,"btn","btn-info"],[1,"fa","fa-plus","mr-1"],k,["type","button","data-toggle","tooltip","data-placement","top","title","only one should be selected",1,"btn","btn-success",3,"disabled","click"],[1,"fa","fa-edit","mr-1"],J,["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"fa","fa-trash","mr-1"],z,["type","checkbox",3,"checked","click"],j,["type","checkbox",3,"value","checked","click"],[1,"user-select-all"],["class","text-center",4,"ngIf"],[1,"text-center"],["routerLink","../../device-center",1,"badge","badge-pill","badge-primary",3,"queryParams"],[1,"fa","fa-sitemap"]]},template:function(l,r){1&l&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n._UZ(2,"i",2),n.TgZ(3,"span"),n.SDv(4,3),n.qZA(),n.qZA(),n.TgZ(5,"div",4),n.YNc(6,V,22,2,"div",5),n.TgZ(7,"div",6),n.TgZ(8,"table",7),n.TgZ(9,"thead",8),n.TgZ(10,"tr"),n.TgZ(11,"th",9),n.YNc(12,I,1,1,"input",10),n.qZA(),n.TgZ(13,"th",9),n._uU(14,"ID"),n.qZA(),n.TgZ(15,"th",9),n.SDv(16,11),n.qZA(),n.TgZ(17,"th",9),n.SDv(18,12),n.qZA(),n.YNc(19,M,2,0,"th",13),n.TgZ(20,"th",9),n.SDv(21,14),n.qZA(),n.TgZ(22,"th",9),n.SDv(23,15),n.qZA(),n.TgZ(24,"th",9),n.SDv(25,16),n.qZA(),n.qZA(),n.qZA(),n.TgZ(26,"tbody"),n.YNc(27,x,16,11,"tr",17),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(28,"div",18),n.TgZ(29,"nav",19),n.TgZ(30,"ul",20),n.TgZ(31,"li",21),n.TgZ(32,"span",22),n.SDv(33,23),n.qZA(),n.qZA(),n.TgZ(34,"li",24),n.TgZ(35,"select",25),n.NdJ("ngModelChange",function(h){return r.pageLimit=h})("ngModelChange",function(){return r.onPageSelected()}),n.TgZ(36,"option",26),n._uU(37,"5"),n.qZA(),n.TgZ(38,"option",27),n._uU(39,"10"),n.qZA(),n.TgZ(40,"option",28),n._uU(41,"20"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(42,"li",29),n.TgZ(43,"button",30),n.NdJ("click",function(){return r.prePage()}),n._UZ(44,"i",31),n.TgZ(45,"span"),n.SDv(46,32),n.qZA(),n.qZA(),n.qZA(),n.TgZ(47,"li",33),n.TgZ(48,"button",30),n.NdJ("click",function(){return r.nextPage()}),n.TgZ(49,"span"),n.SDv(50,34),n.qZA(),n._UZ(51,"i",35),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(52,"div",36),n.TgZ(53,"div",37),n.TgZ(54,"div",38),n.TgZ(55,"div",39),n.TgZ(56,"h5",40),n._UZ(57,"i",41),n.TgZ(58,"span"),n.SDv(59,42),n.qZA(),n.qZA(),n.qZA(),n.TgZ(60,"div",43),n.SDv(61,44),n.qZA(),n.TgZ(62,"div",45),n.TgZ(63,"button",46),n.SDv(64,47),n.qZA(),n.TgZ(65,"button",48),n.NdJ("click",function(){return r.delete()}),n.SDv(66,49),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA()),2&l&&(n.xp6(6),n.Q6J("ngIf",r.toolbars),n.xp6(6),n.Q6J("ngIf",r.enableSelectAll),n.xp6(7),n.Q6J("ngIf",r.associatedDeviceColumn),n.xp6(8),n.Q6J("ngForOf",r.profileList),n.xp6(8),n.Q6J("ngModel",r.pageLimit),n.xp6(8),n.Q6J("disabled",1===r.pagination),n.xp6(5),n.Q6J("disabled",r.pageLimit>r.profileList.length))},directives:[X.O5,X.sg,p.EJ,p.JJ,p.On,p.YN,p.Kr,_.rH,_.yS],styles:[".btn[disabled][_ngcontent-%COMP%]:hover{cursor:not-allowed}"]}),g})()},7982:(i_,b,C)=>{C.d(b,{V:()=>X});var n=C(1841),a=C(5894),A=C(476),_=C(4889);let X=(()=>{class p{constructor(I,M){this.http=I,this.errorSvc=M,this.endpoint="/core-command",this.version="/api/v2",this.urlPrefix=`${this.endpoint}${this.version}`,this.endpointHealthUrl="/ping",this.versionUrl="/version",this.configUrl="/config",this.deviceCoreCommandListUrl=`${this.urlPrefix}/device/all`,this.commandsByDeviceIdUrl=`${this.urlPrefix}/device/`,this.commandsByDeviceNameUrl=`${this.urlPrefix}/device/name/`,this.issueCmdByDeviceNameAndCmdNameUrl=`${this.urlPrefix}/device/name/`,this.httpPostOrPutJSONOptions={headers:new n.WM({"Content-type":"application/json"})}}getConfig(){return this.http.get(`${this.urlPrefix}${this.configUrl}`).pipe((0,a.K)(M=>this.errorSvc.handleError(M)))}findCommnadsByDeviceId(I){return this.http.get(`${this.commandsByDeviceIdUrl}${I}`).pipe((0,a.K)(U=>this.errorSvc.handleError(U)))}allDeviceCoreCommandsPagination(I,M){return this.http.get(`${this.deviceCoreCommandListUrl}?offset=${I}&limit=${M}`).pipe((0,a.K)(Z=>this.errorSvc.handleError(Z)))}findDeviceAssociatedCommnadsByDeviceName(I){return this.http.get(`${this.commandsByDeviceNameUrl}${I}`).pipe((0,a.K)(U=>this.errorSvc.handleError(U)))}findAllDeviceCommnads(){return this.http.get(`${this.urlPrefix}/device`).pipe((0,a.K)(M=>this.errorSvc.handleError(M)))}issueGetBinaryCmd(I,M){return this.http.request("GET",`${this.commandsByDeviceIdUrl}${I}/command/${M}`,{responseType:"arraybuffer"}).pipe((0,a.K)(Z=>this.errorSvc.handleError(Z)))}issueGetCmd(I,M){return this.http.get(`${this.issueCmdByDeviceNameAndCmdNameUrl}${I}/${M}?ds-pushevent=yes&ds-returnevent=yes`).pipe((0,a.K)(Z=>this.errorSvc.handleError(Z)))}issueSetCmd(I,M,U){return this.http.put(`${this.issueCmdByDeviceNameAndCmdNameUrl}${I}/${M}`,JSON.stringify(U),this.httpPostOrPutJSONOptions).pipe((0,a.K)(x=>this.errorSvc.handleError(x)))}}return p.\u0275fac=function(I){return new(I||p)(A.LFG(n.eN),A.LFG(_.T))},p.\u0275prov=A.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()}}]);